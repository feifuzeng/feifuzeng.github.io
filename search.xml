<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Â∑•ÂÖ∑Á±ªüîß-FastjsonËøõÈò∂‰ΩøÁî®]]></title>
    <url>%2F2019%2F06%2F10%2F%E5%B7%A5%E5%85%B7%E7%B1%BB%F0%9F%94%A7-Fastjson%E9%AB%98%E7%BA%A7%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[fastjsonÁî®‰∫éÂ∞ÜJava BeanÂ∫èÂàóÂåñ‰∏∫JSONÂ≠óÁ¨¶‰∏≤Ôºå‰πüÂèØ‰ª•‰ªéJSONÂ≠óÁ¨¶‰∏≤ÂèçÂ∫èÂàóÂåñÂà∞JavaBean„ÄÇ‰∏ªË¶ÅÂ∞±‰ª•‰∏ãÂá†ÁÇπÂÅö‰∏™‰ªãÁªç SerializerFeatureÁâπÊÄßÁöÑ‰ΩøÁî® JSONField‰∏éJSONTypeÊ≥®Ëß£ÁöÑ‰ΩøÁî® SerializeFilter Ê≥õÂûãÂèçÂ∫èÂàóÂåñ fastjsonÂêÑÁßçÊ¶ÇÂøµ ÁÆÄÂçï‰ΩøÁî® ÈÄöËøámavenÂºïÂÖ•Áõ∏Â∫îÁöÑjsonÂåÖ 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.58&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; ÂÆö‰πâ‰∏Ä‰∏™ÈúÄË¶ÅËΩ¨Êç¢ÊâÄÂÆû‰ΩìÁ±ªUserÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819package com.ohaotian.feifz.style.study.utils.fastjson;/** * @author feifz * @version 1.0.0 * @Description Á†îÁ©∂fastjsonÁî®Âà∞ÁöÑÂØπË±° * @createTime 2019Âπ¥06Êúà10Êó• 16:36:00 */import com.alibaba.fastjson.annotation.JSONField;import lombok.Data;import java.util.Date;@Datapublic class User &#123; private Long id; private String name; @JSONField(format = "yyyy-MM-dd HH:mm:ss") private Date createTime;&#125; ÂÜô‰∏™ÁÆÄÂçïÁöÑÊµãËØïÁ±ªÁî®‰∫éÊµãËØïfastjsonÁöÑÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536package com.ohaotian.feifz.style.study.utils.fastjson;/** * @author feifz * @version 1.0.0 * @Description fastjsonÁÆÄÂçï‰ΩøÁî® * @createTime 2019Âπ¥06Êúà10Êó• 16:37:00 */import com.alibaba.fastjson.JSON;import java.util.Date;public class SimpleTest &#123; public static void main(String[] args) &#123; serialize(); deserialize(); &#125; public static void serialize() &#123; User user = new User(); user.setId(11L); user.setName("Ë•øÂÆâ"); user.setCreateTime(new Date()); String jsonString = JSON.toJSONString(user, true); System.out.println(jsonString); &#125; public static void deserialize() &#123; String jsonString = "&#123;\"createTime\":\"2018-08-17 14:38:38\",\"id\":11,\"name\":\"Ë•øÂÆâ\"&#125;"; User user = JSON.parseObject(jsonString, User.class); System.out.println(user.getName()); System.out.println(user.getCreateTime()); &#125;&#125; SerializerFeatureÁâπÊÄßÁöÑ‰ΩøÁî® fastjsonÈÄöËøáSerializerFeatureÂØπÁîüÊàêÁöÑjsonÊ†ºÂºèÁöÑÊï∞ÊçÆËøõË°å‰∏Ä‰∫õÂÆöÂà∂ÔºåÊØîÂ¶ÇÂèØ‰ª•ËæìÂÖ•ÁöÑÊ†ºÂºèÊõ¥Â•ΩÁúãÔºå‰ΩøÁî®ÂçïÂºïÂè∑ËÄåÈùûÂèåÂºïÂè∑Á≠â„ÄÇ‰æãÂ≠êÁ®ãÂ∫èÂ¶Ç‰∏ãÔºö123456789101112131415161718192021222324252627package com.ohaotian.feifz.style.study.utils.fastjson;import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.serializer.SerializerFeature;import java.util.Date;/** * @author feifz * @version 1.0.0 * @Description SerializerFeatureÁâπÊÄßÁöÑ‰ΩøÁî® * @createTime 2019Âπ¥06Êúà10Êó• 16:40:00 */public class SerializerFeatureTest &#123; public static void main(String[] args) &#123; User user = new User(); user.setId(11L); user.setCreateTime(new Date()); String jsonString = JSON.toJSONString(user, SerializerFeature.PrettyFormat, SerializerFeature.WriteNullStringAsEmpty, SerializerFeature.UseSingleQuotes); System.out.println(jsonString); &#125;&#125; ËæìÂá∫ÁöÑÁªìÊûúÂ¶Ç‰∏ãÔºö12345&#123; 'createTime':'2019-06-10 17:25:34', 'id':11, 'name':''&#125; SerializerFeatureÂ∏∏Áî®Â±ûÊÄß ÂêçÁß∞ Âê´‰πâ QuoteFieldNames ËæìÂá∫keyÊó∂ÊòØÂê¶‰ΩøÁî®ÂèåÂºïÂè∑,ÈªòËÆ§‰∏∫true UseSingleQuotes ‰ΩøÁî®ÂçïÂºïÂè∑ËÄå‰∏çÊòØÂèåÂºïÂè∑,ÈªòËÆ§‰∏∫false WriteMapNullValue ÊòØÂê¶ËæìÂá∫ÂÄº‰∏∫nullÁöÑÂ≠óÊÆµ,ÈªòËÆ§‰∏∫false WriteEnumUsingToString EnumËæìÂá∫name()ÊàñËÄÖoriginal,ÈªòËÆ§‰∏∫false UseISO8601DateFormat Date‰ΩøÁî®ISO8601Ê†ºÂºèËæìÂá∫ÔºåÈªòËÆ§‰∏∫false WriteNullListAsEmpty ListÂ≠óÊÆµÂ¶ÇÊûú‰∏∫null,ËæìÂá∫‰∏∫[],ËÄåÈùûnull WriteNullStringAsEmpty Â≠óÁ¨¶Á±ªÂûãÂ≠óÊÆµÂ¶ÇÊûú‰∏∫null,ËæìÂá∫‰∏∫‚Äù‚Äú,ËÄåÈùûnull WriteNullNumberAsZero Êï∞ÂÄºÂ≠óÊÆµÂ¶ÇÊûú‰∏∫null,ËæìÂá∫‰∏∫0,ËÄåÈùûnull WriteNullBooleanAsFalse BooleanÂ≠óÊÆµÂ¶ÇÊûú‰∏∫null,ËæìÂá∫‰∏∫false,ËÄåÈùûnull SkipTransientField Â¶ÇÊûúÊòØtrueÔºåÁ±ª‰∏≠ÁöÑGetÊñπÊ≥ïÂØπÂ∫îÁöÑFieldÊòØtransientÔºåÂ∫èÂàóÂåñÊó∂Â∞Ü‰ºöË¢´ÂøΩÁï•„ÄÇÈªòËÆ§‰∏∫true SortField ÊåâÂ≠óÊÆµÂêçÁß∞ÊéíÂ∫èÂêéËæìÂá∫„ÄÇÈªòËÆ§‰∏∫false WriteTabAsSpecial Êää\tÂÅöËΩ¨‰πâËæìÂá∫ÔºåÈªòËÆ§‰∏∫false‰∏çÊé®ËçêËÆæ‰∏∫true PrettyFormat ÁªìÊûúÊòØÂê¶Ê†ºÂºèÂåñ,ÈªòËÆ§‰∏∫false WriteClassName Â∫èÂàóÂåñÊó∂ÂÜôÂÖ•Á±ªÂûã‰ø°ÊÅØÔºåÈªòËÆ§‰∏∫false„ÄÇÂèçÂ∫èÂàóÂåñÊòØÈúÄÁî®Âà∞ DisableCircularReferenceDetect Ê∂àÈô§ÂØπÂêå‰∏ÄÂØπË±°Âæ™ÁéØÂºïÁî®ÁöÑÈóÆÈ¢òÔºåÈªòËÆ§‰∏∫false WriteSlashAsSpecial ÂØπÊñúÊù†‚Äô/‚ÄôËøõË°åËΩ¨‰πâ BrowserCompatible Â∞Ü‰∏≠ÊñáÈÉΩ‰ºöÂ∫èÂàóÂåñ‰∏∫\uXXXXÊ†ºÂºèÔºåÂ≠óËäÇÊï∞‰ºöÂ§ö‰∏Ä‰∫õÔºå‰ΩÜÊòØËÉΩÂÖºÂÆπIE 6ÔºåÈªòËÆ§‰∏∫false WriteDateUseDateFormat ÂÖ®Â±Ä‰øÆÊîπÊó•ÊúüÊ†ºÂºè,ÈªòËÆ§‰∏∫false„ÄÇ DisableCheckSpecialChar ‰∏Ä‰∏™ÂØπË±°ÁöÑÂ≠óÁ¨¶‰∏≤Â±ûÊÄß‰∏≠Â¶ÇÊûúÊúâÁâπÊÆäÂ≠óÁ¨¶Â¶ÇÂèåÂºïÂè∑ÔºåÂ∞Ü‰ºöÂú®ËΩ¨ÊàêjsonÊó∂Â∏¶ÊúâÂèçÊñúÊù†ËΩ¨ÁßªÁ¨¶„ÄÇÂ¶ÇÊûú‰∏çÈúÄË¶ÅËΩ¨‰πâÔºåÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™Â±ûÊÄß„ÄÇÈªòËÆ§‰∏∫false BeanToArray Â∞ÜÂØπË±°ËΩ¨‰∏∫arrayËæìÂá∫ JSONField‰∏éJSONTypeÊ≥®Ëß£ÁöÑ‰ΩøÁî® Ê≥®ÊÑèÂíå@JSONField‰∏çÂêåÁöÑÊòØ,@JSONTypeÊòØÈÖçÁΩÆÂú®Á±ª‰∏äÁöÑÔºåËÄå@JSONFieldÊòØÈÖçÁΩÆÂú®Â≠óÊÆµÂíåÊñπÊ≥ï‰∏äÁöÑ„ÄÇ JSONFieldÊ≥®Ëß£ÁöÑ‰ΩøÁî® fastjsonÊèê‰æõ‰∫ÜJSONFieldÂØπÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñËøõË°åÂÆöÂà∂ÔºåÊØîÂ¶ÇÂèØ‰ª•ÊåáÂÆöÂ≠óÊÆµÁöÑÂêçÁß∞ÔºåÂ∫èÂàóÂåñÁöÑÈ°∫Â∫è„ÄÇJSONFieldÁî®‰∫éÂ±ûÊÄßÔºåÊñπÊ≥ïÊñπÊ≥ïÂèÇÊï∞‰∏ä„ÄÇJSONFieldÁöÑÊ∫êÁ†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637383940package com.alibaba.fastjson.annotation;import java.lang.annotation.ElementType;import java.lang.annotation.Retention;import java.lang.annotation.RetentionPolicy;import java.lang.annotation.Target;import com.alibaba.fastjson.parser.Feature;import com.alibaba.fastjson.serializer.SerializerFeature;@Retention(RetentionPolicy.RUNTIME)@Target(&#123; ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER &#125;)public @interface JSONField &#123;// ÈÖçÁΩÆÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÁöÑÈ°∫Â∫è int ordinal() default 0;// ÊåáÂÆöÂ≠óÊÆµÁöÑÂêçÁß∞ String name() default "";// ÊåáÂÆöÂ≠óÊÆµÁöÑÊ†ºÂºèÔºåÂØπÊó•ÊúüÊ†ºÂºèÊúâÁî® String format() default ""; // ÊòØÂê¶Â∫èÂàóÂåñ boolean serialize() default true;// ÊòØÂê¶ÂèçÂ∫èÂàóÂåñ boolean deserialize() default true;//Â≠óÊÆµÁ∫ßÂà´ÁöÑSerializerFeature SerializerFeature[] serialzeFeatures() default &#123;&#125;;// Feature[] parseFeatures() default &#123;&#125;; //ÁªôÂ±ûÊÄßÊâì‰∏äÊ†áÁ≠æÔºå Áõ∏ÂΩì‰∫éÁªôÂ±ûÊÄßËøõË°å‰∫ÜÂàÜÁªÑ String label() default ""; boolean jsonDirect() default false; //Âà∂ÂÆöÂ±ûÊÄßÁöÑÂ∫èÂàóÂåñÁ±ª Class&lt;?&gt; serializeUsing() default Void.class; //Âà∂ÂÆöÂ±ûÊÄßÁöÑÂèçÂ∫èÂàóÂåñÁ±ª Class&lt;?&gt; deserializeUsing() default Void.class; String[] alternateNames() default &#123;&#125;; boolean unwrapped() default false;&#125; Â±ûÊÄßnameÈÄöËøáÂú®Ê≥®Ëß£@JSONFieldÊåáÂÆöÂ±ûÊÄßnameÂèØ‰ª•ÊåáÂÆöËØ•Â±ûÊÄßÂú®Â∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠ËæìÂá∫ÁöÑkey„ÄÇÂèØ‰ΩúÁî®‰∫éField‰∏äÔºå‰πüÂèØ‰ΩúÁî®‰∫ésetterÂíåsetterÊñπÊ≥ï‰∏ä„ÄÇ‰∏Ä„ÄÅ‰ΩúÁî®Field ÔºàÁõ∏ÂΩì‰∫éget setÁöÑÊÄªÂíåÔºâ@JSONField‰ΩúÁî®Âú®FieldÊó∂ÔºåÂÖ∂name‰∏ç‰ªÖÂÆö‰πâ‰∫ÜËæìÂÖ•keyÁöÑÂêçÁß∞ÔºåÂêåÊó∂‰πüÂÆö‰πâ‰∫ÜËæìÂá∫ÁöÑÂêçÁß∞„ÄÇ‰∫å„ÄÅ‰ΩúÁî®Âú®setterÂíågetterÊñπÊ≥ï‰∏äÈ°æÂêçÊÄù‰πâÔºåÂΩì‰ΩúÁî®Âú®setterÊñπÊ≥ï‰∏äÊó∂ÔºåÂ∞±Áõ∏ÂΩì‰∫éÊ†πÊçÆnameÂà∞json‰∏≠ÂØªÊâæÂØπÂ∫îÁöÑÂÄºÔºåÂπ∂Ë∞ÉÁî®ËØ•setterÂØπË±°ËµãÂÄº„ÄÇÂΩì‰ΩúÁî®Âú®getter‰∏äÊó∂ÔºåÂú®beanËΩ¨Êç¢‰∏∫jsonÊó∂ÔºåÂÖ∂keyÂÄº‰∏∫nameÂÆö‰πâÁöÑÂÄº„ÄÇÁ§∫‰æãÂ¶Ç‰∏ãÔºö123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869package com.ohaotian.feifz.style.study.utils.fastjson;/** * @author feifz * @version 1.0.0 * @Description JSONFieldÊ≥®Ëß£ nameÂ±ûÊÄßÁî®Ê≥ï * @createTime 2019Âπ¥06Êúà11Êó• 14:00:00 */import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.annotation.JSONField;public class JsonFieldNameDemo &#123; @JSONField(name = "jsonName") private String name; private String age; private String email; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; @JSONField(name = "jsonAge") public String getAge() &#123; return age; &#125; @JSONField(name = "jsonAge") public void setAge(String age) &#123; this.age = age; &#125; public String getEmail() &#123; return email; &#125; @JSONField(name = "jsonEmail") public void setEmail(String email) &#123; this.email = email; &#125; @Override public String toString() &#123; return "JsonFieldNameDemo [name=" + name + ", age=" + age + ", email=" + email + "]"; &#125; public static void main(String[] args) &#123; JsonFieldNameDemo jsonFieldNameDemo = new JsonFieldNameDemo(); jsonFieldNameDemo.setAge("21Â≤Å"); jsonFieldNameDemo.setEmail("111@11.com"); jsonFieldNameDemo.setName("hhh"); System.out.println(JSON.toJSONString(jsonFieldNameDemo)); //ËæìÂá∫‰∫ÜÔºö&#123;"jsonName":"hhh","jsonAge":"21Â≤Å","email":"111@11.com"&#125; String json = "&#123;\"email\":\"111@11.com\",\"jsonAge\":\"21Â≤Å\",\"jsonName\":\"hhh\"&#125;"; JsonFieldNameDemo jsonTest = JSON.parseObject(json, JsonFieldNameDemo.class); System.out.println(jsonTest.toString()); &#125;&#125; ËæìÂá∫ÁªìÊûúÂ¶Ç‰∏ãÔºö12&#123;"email":"111@11.com","jsonAge":"21Â≤Å","jsonName":"hhh"&#125;JsonFieldNameDemo [name=hhh, age=21Â≤Å, email=null] serializeÔºådeserializeserializeÔºöÊòØÂê¶Â∫èÂàóÂåñÔºåÈªòËÆ§ÂÄºÈÉΩ‰∏∫trueÔºåÊåáÂÆö‰∏∫falseÊó∂Â∫èÂàóÂåñËøáÁ®ã‰∏≠‰∏çÂ∫èÂàóÂåñËØ•Â≠óÊÆµ„ÄÇdeserializeÔºöÊòØÂê¶ÂèçÂ∫èÂàóÂåñÔºåÈªòËÆ§ÂÄºÈÉΩ‰∏∫trueÔºåÊåáÂÆö‰∏∫falseÊó∂ÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠‰∏çÂèçÂ∫èÂàóÂåñËØ•Â≠óÊÆµÁ§∫‰æã‰ª£Á†ÅÂ¶Ç‰∏ãÔºö12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667package com.ohaotian.feifz.style.study.utils.fastjson;import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.annotation.JSONField;/** * @author feifz * @version 1.0.0 * @Description @JSONField nameÂ±ûÊÄßÁ§∫‰æã * @createTime 2019Âπ¥06Êúà11Êó• 14:09:00 */public class JsonFieldNameDemo &#123; private String name; @JSONField(deserialize = false) private String age; @JSONField(serialize = false) private String email; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public String getAge() &#123; return age; &#125; public void setAge(String age) &#123; this.age = age; &#125; public String getEmail() &#123; return email; &#125; public void setEmail(String email) &#123; this.email = email; &#125; @Override public String toString() &#123; return "JsonFieldNameDemo&#123;" + "name='" + name + '\'' + ", age='" + age + '\'' + ", email='" + email + '\'' + '&#125;'; &#125; public static void main(String[] args) &#123; JsonFieldNameDemo jsonFieldNameTest1 = new JsonFieldNameDemo(); jsonFieldNameTest1.setAge("18"); jsonFieldNameTest1.setEmail("123@163.com"); jsonFieldNameTest1.setName("Bob"); System.out.println(JSON.toJSONString(jsonFieldNameTest1)); String json = "&#123;\"age\":\"18\",\"email\":\"123@163.com\",\"name\":\"Bob\"&#125;"; JsonFieldNameDemo jsonFieldNameTest2 = JSON.parseObject(json, JsonFieldNameDemo.class); System.out.println(jsonFieldNameTest2.toString()); &#125;&#125; ËæìÂá∫ÁªìÊûúÂ¶Ç‰∏ãÔºö12&#123;"age":"18","name":"Bob"&#125;JsonFieldNameDemo&#123;name='Bob', age='null', email='123@163.com'&#125; serializeUsingÔºådeserializeUsingÂÖ∂‰∏≠serializeUsing‰∏édeserializeUsingÂèØ‰ª•Áî®‰∫éÂØπÂ≠óÊÆµÁöÑÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñËøõË°åÂÆöÂà∂Âåñ„ÄÇÊØîÂ¶ÇÊàë‰ª¨Âú®UserÂÆû‰Ωì‰∏äÂä†‰∏ä‰∏™sexÂ±ûÊÄßÔºåÁ±ªÂûã‰∏∫boolean„ÄÇ‰∏ãÈù¢ÂàÜÂà´ÂÆö‰πâ‰∫ÜÂ∫èÂàóÂåñÁ±ª‰∏éÂèçÂ∫èÂàóÂåñÁ±ª„ÄÇÂ∫èÂàóÂåñÁ±ª‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233package com.ohaotian.feifz.style.study.utils.fastjson;/** * @author feifz * @version 1.0.0 * @Description TODO * @createTime 2019Âπ¥06Êúà11Êó• 10:23:00 */import com.alibaba.fastjson.serializer.JSONSerializer;import com.alibaba.fastjson.serializer.ObjectSerializer;import java.io.IOException;import java.lang.reflect.Type;public class SexSerializer implements ObjectSerializer &#123; @Override public void write(JSONSerializer serializer, Object object, Object fieldName, Type fieldType, int features) throws IOException &#123; Boolean value = (Boolean) object; String text = "Â•≥"; if (value != null &amp;&amp; value == true) &#123; text = "Áî∑"; &#125; serializer.write(text); &#125;&#125; ÂèçÂ∫èÂàóÂåñÁ±ª‰ª£Á†ÅÂ¶Ç‰∏ãÔºö12345678910111213141516171819202122232425262728293031323334353637package com.ohaotian.feifz.style.study.utils.fastjson;/** * @author feifz * @version 1.0.0 * @Description TODO * @createTime 2019Âπ¥06Êúà11Êó• 10:24:00 */import com.alibaba.fastjson.parser.DefaultJSONParser;import com.alibaba.fastjson.parser.JSONToken;import com.alibaba.fastjson.parser.deserializer.ObjectDeserializer;import java.lang.reflect.Type;public class SexDeserialize implements ObjectDeserializer &#123; @Override public &lt;T&gt; T deserialze(DefaultJSONParser parser, Type type, Object fieldName) &#123; String sex = parser.parseObject(String.class); if ("Áî∑".equals(sex)) &#123; return (T) Boolean.TRUE; &#125; else &#123; return (T) Boolean.FALSE; &#125; &#125; @Override public int getFastMatchToken() &#123; return JSONToken.UNDEFINED; &#125;&#125; Âú®ÂÆö‰πâbeanÂØπË±°Êó∂Âú®Â≠óÊÆµsex‰∏äÂä†‰∏äÊ≥®Ëß£Â¶Ç‰∏ãÔºö12345678910111213141516171819202122232425262728package com.ohaotian.feifz.style.study.utils.fastjson;/** * @author feifz * @version 1.0.0 * @Description Á†îÁ©∂fastjsonÁî®Âà∞ÁöÑÂØπË±° * @createTime 2019Âπ¥06Êúà10Êó• 16:36:00 */import com.alibaba.fastjson.annotation.JSONField;import lombok.Data;import java.util.Date;@Datapublic class User &#123; private Long id; private String name; @JSONField(format = "yyyy-MM-dd HH:mm:ss") private Date createTime; @JSONField(serializeUsing = SexSerializer.class, deserializeUsing = SexDeserialize.class) private Boolean sex;&#125; ËøôÊ†∑Âú®ÊâßË°å‰∏ãÈù¢‰ª£Á†Å‰πãÂêéÂ∞±‰ºöÂèëÁé∞ÂØπsexÂ≠óÊÆµÁöÑÂÄºÂÆöÂà∂Âåñ‰∫Ü1234567891011121314151617181920212223242526272829303132333435363738package com.ohaotian.feifz.style.study.utils.fastjson;/** * @author feifz * @version 1.0.0 * @Description fastjsonÁÆÄÂçï‰ΩøÁî® * @createTime 2019Âπ¥06Êúà10Êó• 16:37:00 */import com.alibaba.fastjson.JSON;import java.util.Date;public class SimpleTest &#123; public static void main(String[] args) &#123; serialize(); deserialize(); &#125; public static void serialize() &#123; User user = new User(); user.setId(11L); user.setName("Ë•øÂÆâ"); user.setSex(false); user.setCreateTime(new Date()); String jsonString = JSON.toJSONString(user, true); System.out.println(jsonString); &#125; public static void deserialize() &#123; String jsonString = "&#123;\"createTime\":\"2018-08-17 14:38:38\",\"id\":11,\"name\":\"Ë•øÂÆâ\",\"sex\":\"Áî∑\"&#125;"; User user = JSON.parseObject(jsonString, User.class); System.out.println(user.getSex()); System.out.println(user.getName()); System.out.println(user.getCreateTime()); &#125;&#125; ËæìÂá∫ÁöÑÁªìÊûúÂ¶Ç‰∏ãÔºö123456789&#123; "createTime":"2019-06-11 11:20:08", "id":11, "name":"Ë•øÂÆâ", "sex":"Â•≥"&#125;trueË•øÂÆâFri Aug 17 14:38:38 CST 2018 JSONTypeÊ≥®Ëß£ÁöÑ‰ΩøÁî® fastjosnÊèê‰æõ‰∫ÜJSONTypeÁî®‰∫éÁ±ªÁ∫ßÂà´ÁöÑÂÆöÂà∂Âåñ, JSONTypeÁöÑÊ∫êÁ†ÅÂ¶Ç‰∏ãÔºö Ê∫êÁ†Å1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950package com.alibaba.fastjson.annotation;import java.lang.annotation.ElementType;import java.lang.annotation.Retention;import java.lang.annotation.RetentionPolicy;import java.lang.annotation.Target;import com.alibaba.fastjson.PropertyNamingStrategy;import com.alibaba.fastjson.parser.Feature;import com.alibaba.fastjson.serializer.SerializeFilter;import com.alibaba.fastjson.serializer.SerializerFeature;@Retention(RetentionPolicy.RUNTIME)//ÈúÄË¶ÅÊ†áÊ≥®Âú®Á±ª‰∏ä@Target(&#123; ElementType.TYPE &#125;)public @interface JSONType &#123; boolean asm() default true;//ËøôÈáåÂèØ‰ª•ÂÆö‰πâËæìÂá∫jsonÁöÑÂ≠óÊÆµÈ°∫Â∫è String[] orders() default &#123;&#125;;//ÂåÖÂê´ÁöÑÂ≠óÊÆµ String[] includes() default &#123;&#125;;//‰∏çÂåÖÂê´ÁöÑÂ≠óÊÆµ String[] ignores() default &#123;&#125;;//Á±ªÁ∫ßÂà´ÁöÑÂ∫èÂàóÂåñÁâπÊÄßÂÆö‰πâ SerializerFeature[] serialzeFeatures() default &#123;&#125;; Feature[] parseFeatures() default &#123;&#125;; //ÊåâÂ≠óÊØçÈ°∫Â∫èËøõË°åËæìÂá∫ boolean alphabetic() default true; Class&lt;?&gt; mappingTo() default Void.class; Class&lt;?&gt; builder() default Void.class; String typeName() default ""; String typeKey() default ""; Class&lt;?&gt;[] seeAlso() default&#123;&#125;; //Â∫èÂàóÂåñÁ±ª Class&lt;?&gt; serializer() default Void.class; //ÂèçÂ∫èÂàóÂåñÁ±ª Class&lt;?&gt; deserializer() default Void.class; boolean serializeEnumAsJavaBean() default false; PropertyNamingStrategy naming() default PropertyNamingStrategy.CamelCase; Class&lt;? extends SerializeFilter&gt;[] serialzeFilters() default &#123;&#125;;&#125; Â±ûÊÄß includesÂ∫èÂàóÂåñÊó∂ÔºåÂè™Â∫èÂàóÂåñËøô‰∫õÂ≠óÊÆµ‰ΩøÁî®Á§∫‰æãÔºö@JSONType(includes = {‚Äúname‚Äù,‚Äùage‚Äù}) ignoresÂ∫èÂàóÂåñÊó∂ÔºåÂøΩÁï•Ëøô‰∫õÂ≠óÊÆµ‰ΩøÁî®Á§∫‰æãÔºö@JSONType(ignores = {‚Äúemail‚Äù}) ordersÂ∫èÂàóÂåñÊó∂ÔºåÊåâÁÖßÊåáÂÆöÁöÑÈ°∫Â∫èËæìÂá∫ÁªìÊûú‰ΩøÁî®Á§∫‰æãÔºö@JSONType(orders = {‚Äúname‚Äù,‚Äùage‚Äù}) ‰ΩøÁî®Á§∫‰æãÔºö1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768package com.ohaotian.feifz.style.study.utils.fastjson;import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.annotation.JSONType;/** * @author feifz * @version 1.0.0 * @Description @JSONType Ê≥®Ëß£‰ΩøÁî®Á§∫‰æã * @createTime 2019Âπ¥06Êúà11Êó• 14:41:00 */@JSONType(includes = &#123;"name","age"&#125;,ignores = &#123;"email"&#125;,orders = &#123;"name","age"&#125;)public class JsonTypeDemo &#123; private String name; private String age; private String email; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public String getAge() &#123; return age; &#125; public void setAge(String age) &#123; this.age = age; &#125; public String getEmail() &#123; return email; &#125; public void setEmail(String email) &#123; this.email = email; &#125; public JsonTypeDemo(String name, String age, String email) &#123; this.name = name; this.age = age; this.email = email; &#125; @Override public String toString() &#123; return "JsonTypeDemo&#123;" + "name='" + name + '\'' + ", age='" + age + '\'' + ", email='" + email + '\'' + '&#125;'; &#125; public static void main(String[] args) &#123; JsonTypeDemo demo = new JsonTypeDemo("Mary","17","123@163.com"); System.out.println(JSON.toJSONString(demo)); String json = "&#123;\"age\":\"17\",\"email\":\"123@163.com\",\"name\":\"Mary\"&#125;"; JsonTypeDemo jsonTypeDemo = JSON.parseObject(json,JsonTypeDemo.class); System.out.println(jsonTypeDemo.toString()); &#125;&#125; ËæìÂá∫ÁªìÊûúÂ¶Ç‰∏ãÔºö12&#123;"name":"Mary","age":"17"&#125;JsonTypeDemo&#123;name='Mary', age='17', email='123@163.com'&#125; SerializeFilterÊ≥õÂûãÂèçÂ∫èÂàóÂåñ12345678910111213141516171819202122232425262728293031323334353637383940414243444546```# fastjsonÂêÑÁßçÊ¶ÇÂøµ* JSONÔºöÊú¨Ë∫´ÊòØAbstractÔºåÊèê‰æõ‰∫Ü‰∏ÄÁ≥ªÁªüÁöÑÂ∑•ÂÖ∑ÊñπÊ≥ïÊñπ‰æøÁî®Êà∑‰ΩøÁî®ÁöÑAPI„ÄÇ## Â∫èÂàóÂåñÁõ∏ÂÖ≥ÁöÑÊ¶ÇÂøµ* SerializeConfigÔºöÂÜÖÈÉ®ÊòØ‰∏™mapÂÆπÂô®‰∏ªË¶ÅÂäüËÉΩÊòØÈÖçÁΩÆÂπ∂ËÆ∞ÂΩïÊØèÁßçJavaÁ±ªÂûãÂØπÂ∫îÁöÑÂ∫èÂàóÂåñÁ±ª„ÄÇ* SerializeWriter ÁªßÊâøËá™JavaÁöÑWriterÔºåÂÖ∂ÂÆûÂ∞±ÊòØ‰∏™ËΩ¨‰∏∫FastJSONËÄåÁîüÁöÑStringBuilderÔºåÂÆåÊàêÈ´òÊÄßËÉΩÁöÑÂ≠óÁ¨¶‰∏≤ÊãºÊé•„ÄÇ* SerializeFilter: Áî®‰∫éÂØπÂØπË±°ÁöÑÂ∫èÂàóÂåñÂÆûÁé∞ÂêÑÁßçÂÆöÂà∂ÂåñÁöÑÈúÄÊ±Ç„ÄÇ* SerializerFeatureÔºöÂØπ‰∫éÂØπËæìÂá∫ÁöÑjsonÂÅöÂêÑÁßçÊ†ºÂºèÂåñÁöÑÈúÄÊ±Ç„ÄÇ* JSONSerializerÔºöÁõ∏ÂΩì‰∫é‰∏Ä‰∏™Â∫èÂàóÂåñÁªÑÂêàÂô®ÔºåÈõÜÊàê‰∫Ü*SerializeConfigÔºå SerializeWriter Ôºå SerializeFilter‰∏éSerializerFeature„ÄÇÂ∫èÂàóÂåñÁöÑÂÖ•Âè£‰ª£Á†ÅÂ¶Ç‰∏ãÔºå‰∏äÈù¢ÊèêÂà∞ÁöÑÂêÑÁßçÊ¶ÇÂøµÈÉΩÂåÖÂê´‰∫ÜÔºö``` java/** * @since 1.2.9 * @return */ public static String toJSONString(Object object, // SerializeConfig config, // SerializeFilter[] filters, // String dateFormat, // int defaultFeatures, // SerializerFeature... features) &#123; SerializeWriter out = new SerializeWriter(null, defaultFeatures, features); try &#123; JSONSerializer serializer = new JSONSerializer(out, config); if (dateFormat != null &amp;&amp; dateFormat.length() != 0) &#123; serializer.setDateFormat(dateFormat); serializer.config(SerializerFeature.WriteDateUseDateFormat, true); &#125; if (filters != null) &#123; for (SerializeFilter filter : filters) &#123; serializer.addFilter(filter); &#125; &#125; serializer.write(object); return out.toString(); &#125; finally &#123; out.close(); &#125; &#125; ÂèçÂ∫èÂàóÂåñÁõ∏ÂÖ≥ÁöÑÊ¶ÇÂøµParserConfigÔºöÂÜÖÈÉ®ÈÄöËøá‰∏Ä‰∏™map‰øùÂ≠òÂêÑÁßçObjectDeserializer„ÄÇJSONLexer : ‰∏éSerializeWriterÁõ∏ÂØπÂ∫îÔºåÁî®‰∫éËß£ÊûêjsonÂ≠óÁ¨¶‰∏≤„ÄÇJSONTokenÔºöÂÆö‰πâ‰∫Ü‰∏ÄÁ≥ªÁªüÁöÑÁâπÊÆäÂ≠óÁ¨¶ÔºåËøô‰∫õÁß∞‰∏∫token„ÄÇParseProcess ÔºöÂÆöÂà∂ÂèçÂ∫èÂàóÂåñÔºåÁ±ª‰ºº‰∫éSerializeFilter„ÄÇFeatureÔºöÁî®‰∫éÂÆöÂà∂ÂêÑÁßçÂèçÂ∫èÂàóÂåñÁöÑÁâπÊÄß„ÄÇDefaultJSONParserÔºöÁõ∏ÂΩì‰∫éÂèçÂ∫èÂàóÂåñÁªÑÂêàÂô®ÔºåÈõÜÊàê‰∫ÜParserConfigÔºåFeatureÔºå JSONLexer ‰∏éParseProcess„ÄÇÂèçÂ∫èÂàóÂåñÁöÑÂÖ•Âè£‰ª£Á†ÅÂ¶Ç‰∏ãÔºå‰∏äÈù¢ÁöÑÊ¶ÇÂøµÂü∫Êú¨ÈÉΩÂåÖÂê´‰∫ÜÔºö12345678910111213141516171819202122232425262728293031323334353637@SuppressWarnings("unchecked") public static &lt;T&gt; T parseObject(String input, Type clazz, ParserConfig config, ParseProcess processor, int featureValues, Feature... features) &#123; if (input == null) &#123; return null; &#125; if (features != null) &#123; for (Feature feature : features) &#123; featureValues |= feature.mask; &#125; &#125; DefaultJSONParser parser = new DefaultJSONParser(input, config, featureValues); if (processor != null) &#123; if (processor instanceof ExtraTypeProvider) &#123; parser.getExtraTypeProviders().add((ExtraTypeProvider) processor); &#125; if (processor instanceof ExtraProcessor) &#123; parser.getExtraProcessors().add((ExtraProcessor) processor); &#125; if (processor instanceof FieldTypeResolver) &#123; parser.setFieldTypeResolver((FieldTypeResolver) processor); &#125; &#125; T value = (T) parser.parseObject(clazz, null); parser.handleResovleTask(value); parser.close(); return (T) value; &#125; ÂèÇËÄÉ https://www.jianshu.com/p/eaeaa5dce258]]></content>
      <categories>
        <category>Â∑•ÂÖ∑</category>
      </categories>
      <tags>
        <tag>fastjson</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Â∑•ÂÖ∑Á±ªüîß-FastjsonÂÖ•Èó®‰ΩøÁî®]]></title>
    <url>%2F2019%2F06%2F10%2F%E5%B7%A5%E5%85%B7%E7%B1%BB%F0%9F%94%A7-Fastjson%2F</url>
    <content type="text"><![CDATA[ÁÆÄ‰ªã‰ªÄ‰πàÊòØFastjson?fastjsonÊòØÈòøÈáåÂ∑¥Â∑¥ÁöÑÂºÄÊ∫êJSONËß£ÊûêÂ∫ìÔºåÂÆÉÂèØ‰ª•Ëß£ÊûêJSONÊ†ºÂºèÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊîØÊåÅÂ∞ÜJava BeanÂ∫èÂàóÂåñ‰∏∫JSONÂ≠óÁ¨¶‰∏≤Ôºå‰πüÂèØ‰ª•‰ªéJSONÂ≠óÁ¨¶‰∏≤ÂèçÂ∫èÂàóÂåñÂà∞JavaBean„ÄÇFastjsonÊòØ‰∏Ä‰∏™JavaËØ≠Ë®ÄÁºñÂÜôÁöÑÈ´òÊÄßËÉΩÂäüËÉΩÂÆåÂñÑÁöÑJSONÂ∫ì„ÄÇÂÆÉÈááÁî®‰∏ÄÁßç‚ÄúÂÅáÂÆöÊúâÂ∫èÂø´ÈÄüÂåπÈÖç‚ÄùÁöÑÁÆóÊ≥ïÔºåÊääJSON ParseÁöÑÊÄßËÉΩÊèêÂçáÂà∞ÊûÅËá¥ÔºåÊòØÁõÆÂâçJavaËØ≠Ë®Ä‰∏≠ÊúÄÂø´ÁöÑJSONÂ∫ì„ÄÇFastjsonÊé•Âè£ÁÆÄÂçïÊòìÁî®ÔºåÂ∑≤ÁªèË¢´ÂπøÊ≥õ‰ΩøÁî®Âú®ÁºìÂ≠òÂ∫èÂàóÂåñ„ÄÅÂçèËÆÆ‰∫§‰∫í„ÄÅWebËæìÂá∫„ÄÅAndroidÂÆ¢Êà∑Á´ØÁ≠âÂ§öÁßçÂ∫îÁî®Âú∫ÊôØ„ÄÇ‰∏ªË¶ÅÁâπÁÇπÔºöÂø´ÈÄüFAST (ÊØîÂÖ∂ÂÆÉ‰ªª‰ΩïÂü∫‰∫éJavaÁöÑËß£ÊûêÂô®ÂíåÁîüÊàêÂô®Êõ¥Âø´ÔºåÂåÖÊã¨jacksonÔºâÂº∫Â§ßÔºàÊîØÊåÅÊôÆÈÄöJDKÁ±ªÂåÖÊã¨‰ªªÊÑèJava Bean Class„ÄÅCollection„ÄÅMap„ÄÅDateÊàñenumÔºâÈõ∂‰æùËµñÔºàÊ≤°Êúâ‰æùËµñÂÖ∂ÂÆÉ‰ªª‰ΩïÁ±ªÂ∫ìÈô§‰∫ÜJDKÔºâÂºÄÊ∫êÔºå‰ΩøÁî®Apache License 2.0ÂçèËÆÆÂºÄÊ∫ê„ÄÇÊ∫êÁ†ÅÔºöhttps://github.com/alibaba/fastjsonwikiÔºöhttps://github.com/alibaba/fastjson/wiki/Quick-Start-CN Fastjson‰ΩøÁî®Âú∫ÊôØfastjsonÂ∑≤ÁªèË¢´ÂπøÊ≥õ‰ΩøÁî®Âú®ÂêÑÁßçÂú∫ÊôØÔºåÂåÖÊã¨cacheÂ≠òÂÇ®„ÄÅRPCÈÄöËÆØ„ÄÅMQÈÄöËÆØ„ÄÅÁΩëÁªúÂçèËÆÆÈÄöËÆØ„ÄÅAndroidÂÆ¢Êà∑Á´Ø„ÄÅAjaxÊúçÂä°Âô®Â§ÑÁêÜÁ®ãÂ∫èÁ≠âÁ≠â„ÄÇ FastjsonÁöÑ‰ºòÁÇπ ÈÄüÂ∫¶Âø´fastjsonÁõ∏ÂØπÂÖ∂‰ªñJSONÂ∫ìÁöÑÁâπÁÇπÊòØÂø´Ôºå‰ªé2011Âπ¥fastjsonÂèëÂ∏É1.1.xÁâàÊú¨‰πãÂêéÔºåÂÖ∂ÊÄßËÉΩ‰ªéÊú™Ë¢´ÂÖ∂‰ªñJavaÂÆûÁé∞ÁöÑJSONÂ∫ìË∂ÖË∂ä„ÄÇ ‰ΩøÁî®ÂπøÊ≥õfastjsonÂú®ÈòøÈáåÂ∑¥Â∑¥Â§ßËßÑÊ®°‰ΩøÁî®ÔºåÂú®Êï∞‰∏áÂè∞ÊúçÂä°Âô®‰∏äÈÉ®ÁΩ≤ÔºåfastjsonÂú®‰∏öÁïåË¢´ÂπøÊ≥õÊé•Âèó„ÄÇÂú®2012Âπ¥Ë¢´ÂºÄÊ∫ê‰∏≠ÂõΩËØÑÈÄâ‰∏∫ÊúÄÂèóÊ¨¢ËøéÁöÑÂõΩ‰∫ßÂºÄÊ∫êËΩØ‰ª∂‰πã‰∏Ä„ÄÇ ÊµãËØïÂÆåÂ§áfastjsonÊúâÈùûÂ∏∏Â§öÁöÑtestcaseÔºåÂú®1.2.11ÁâàÊú¨‰∏≠ÔºåtestcaseË∂ÖËøá3321‰∏™„ÄÇÊØèÊ¨°ÂèëÂ∏ÉÈÉΩ‰ºöËøõË°åÂõûÂΩíÊµãËØïÔºå‰øùËØÅË¥®ÈáèÁ®≥ÂÆö„ÄÇ ‰ΩøÁî®ÁÆÄÂçïfastjsonÁöÑAPIÂçÅÂàÜÁÆÄÊ¥Å„ÄÇ 12String text = JSON.toJSONString(obj); //Â∫èÂàóÂåñModel vo = JSON.parseObject("&#123;...&#125;", Mpode.class); //ÂèçÂ∫èÂàóÂåñ ÂäüËÉΩÂÆåÂ§áÊîØÊåÅÊ≥õÂûãÔºåÊîØÊåÅÊµÅÂ§ÑÁêÜË∂ÖÂ§ßÊñáÊú¨ÔºåÊîØÊåÅÊûö‰∏æÔºåÊîØÊåÅÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÊâ©Â±ï„ÄÇ ‰∏ãËΩΩÂíå‰ΩøÁî®‰∏ãËΩΩ‰Ω†ÂèØ‰ª•Âú®maven‰∏≠Â§Æ‰ªìÂ∫ì‰∏≠Áõ¥Êé•‰∏ãËΩΩÔºö1http://repo1.maven.org/maven2/com/alibaba/fastjson/ ÊàñËÄÖÈÖçÁΩÆmaven‰æùËµñ12345&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;x.x.x&lt;/version&gt;&lt;/dependency&gt; ÂÖ∂‰∏≠x.x.xÊòØÁâàÊú¨Âè∑ÔºåË∑üËøõÈúÄË¶Å‰ΩøÁî®ÁâπÂÆöÁâàÊú¨ÔºåÂª∫ËÆÆ‰ΩøÁî®ÊúÄÊñ∞ÁâàÊú¨,ÁõÆÂâçÊúÄÊñ∞ÁâàÊú¨‰∏∫1.2.58 ÁÆÄÂçï‰ΩøÁî® JSONËøô‰∏™Á±ªÊòØfastjson APIÁöÑÂÖ•Âè£Ôºå‰∏ªË¶ÅÁöÑÂäüËÉΩÈÉΩÈÄöËøáËøô‰∏™Á±ªÊèê‰æõ„ÄÇÂ∫èÂàóÂåñAPI 123456789101112131415package com.alibaba.fastjson;public abstract class JSON &#123; // Â∞ÜJavaÂØπË±°Â∫èÂàóÂåñ‰∏∫JSONÂ≠óÁ¨¶‰∏≤ÔºåÊîØÊåÅÂêÑÁßçÂêÑÁßçJavaÂü∫Êú¨Á±ªÂûãÂíåJavaBean public static String toJSONString(Object object, SerializerFeature... features); // Â∞ÜJavaÂØπË±°Â∫èÂàóÂåñ‰∏∫JSONÂ≠óÁ¨¶‰∏≤ÔºåËøîÂõûJSONÂ≠óÁ¨¶‰∏≤ÁöÑutf-8 bytes public static byte[] toJSONBytes(Object object, SerializerFeature... features); // Â∞ÜJavaÂØπË±°Â∫èÂàóÂåñ‰∏∫JSONÂ≠óÁ¨¶‰∏≤ÔºåÂÜôÂÖ•Âà∞Writer‰∏≠ public static void writeJSONString(Writer writer, Object object, SerializerFeature... features); // Â∞ÜJavaÂØπË±°Â∫èÂàóÂåñ‰∏∫JSONÂ≠óÁ¨¶‰∏≤ÔºåÊåâUTF-8ÁºñÁ†ÅÂÜôÂÖ•Âà∞OutputStream‰∏≠ public static final int writeJSONString(OutputStream os, // Object object, // SerializerFeature... features);&#125; JSONÂ≠óÁ¨¶‰∏≤ÂèçÂ∫èÂàóÂåñAPI 1234567891011121314151617package com.alibaba.fastjson;public abstract class JSON &#123; // Â∞ÜJSONÂ≠óÁ¨¶‰∏≤ÂèçÂ∫èÂàóÂåñ‰∏∫JavaBean public static &lt;T&gt; T parseObject(String jsonStr, Class&lt;T&gt; clazz, Feature... features); // Â∞ÜJSONÂ≠óÁ¨¶‰∏≤ÂèçÂ∫èÂàóÂåñ‰∏∫JavaBean public static &lt;T&gt; T parseObject(byte[] jsonBytes, // UTF-8Ê†ºÂºèÁöÑJSONÂ≠óÁ¨¶‰∏≤ Class&lt;T&gt; clazz, Feature... features); // Â∞ÜJSONÂ≠óÁ¨¶‰∏≤ÂèçÂ∫èÂàóÂåñ‰∏∫Ê≥õÂûãÁ±ªÂûãÁöÑJavaBean public static &lt;T&gt; T parseObject(String text, TypeReference&lt;T&gt; type, Feature... features); // Â∞ÜJSONÂ≠óÁ¨¶‰∏≤ÂèçÂ∫èÂàó‰∏∫JSONObject public static JSONObject parseObject(String text);&#125; ÁÆÄÂçïÁ§∫‰æãparse Tree12import com.alibaba.fastjson.*;JSONObject jsonObj = JSON.parseObject(jsonStr); parse POJO12import com.alibaba.fastjson.JSON;Model model = JSON.parseObject(jsonStr, Model.class); parse POJO Generic123import com.alibaba.fastjson.JSON;Type type = new TypeReference&lt;List&lt;Model&gt;&gt;() &#123;&#125;.getType(); List&lt;Model&gt; list = JSON.parseObject(jsonStr, type); convert POJO to json string123import com.alibaba.fastjson.JSON;Model model = ...; String jsonStr = JSON.toJSONString(model); convert POJO to json bytes123import com.alibaba.fastjson.JSON;Model model = ...; byte[] jsonBytes = JSON.toJSONBytes(model); write POJO as json string to OutputStream1234import com.alibaba.fastjson.JSON;Model model = ...; OutputStream os;JSON.writeJSONString(os, model); write POJO as json string to Writer1234import com.alibaba.fastjson.JSON;Model model = ...; Writer writer = ...;JSON.writeJSONString(writer, model); È´òÁ∫ß‰ΩøÁî®Fastjson ÂÆöÂà∂Â∫èÂàóÂåñ ÁÆÄ‰ªã fastjsonÊîØÊåÅÂ§öÁßçÊñπÂºèÂÆöÂà∂Â∫èÂàóÂåñ„ÄÇÈÄöËøá@JSONFieldÂÆöÂà∂Â∫èÂàóÂåñÈÄöËøá@JSONTypeÂÆöÂà∂Â∫èÂàóÂåñÈÄöËøáSerializeFilterÂÆöÂà∂Â∫èÂàóÂåñÈÄöËøáParseProcessÂÆöÂà∂ÂèçÂ∫èÂàóÂåñ ‰ΩøÁî®@JSONFieldÈÖçÁΩÆ ÂèØ‰ª•Êää@JSONFieldÈÖçÁΩÆÂú®Â≠óÊÆµÊàñËÄÖgetter/setterÊñπÊ≥ï‰∏ä„ÄÇ‰æãÂ¶ÇÔºö1234public class VO &#123; @JSONField(name="ID") private int id; &#125; ÊàñËÄÖ123456789public class VO &#123; private int id; @JSONField(name="ID") public int getId() &#123; return id;&#125; @JSONField(name="ID") public void setId(int value) &#123;this.id = id;&#125;&#125; ‰ΩøÁî®@JSONTypeÈÖçÁΩÆÂíåJSONFieldÁ±ª‰ººÔºå‰ΩÜJSONTypeÈÖçÁΩÆÂú®Á±ª‰∏äÔºåËÄå‰∏çÊòØfieldÊàñËÄÖgetter/setterÊñπÊ≥ï‰∏ä„ÄÇ ÈÄöËøáSerializeFilterÂÆöÂà∂Â∫èÂàóÂåñÈÄöËøáSerializeFilterÂèØ‰ª•‰ΩøÁî®Êâ©Â±ïÁºñÁ®ãÁöÑÊñπÂºèÂÆûÁé∞ÂÆöÂà∂Â∫èÂàóÂåñ„ÄÇfastjsonÊèê‰æõ‰∫ÜÂ§öÁßçSerializeFilterÔºö PropertyPreFilter Ê†πÊçÆPropertyNameÂà§Êñ≠ÊòØÂê¶Â∫èÂàóÂåñ PropertyFilter Ê†πÊçÆPropertyNameÂíåPropertyValueÊù•Âà§Êñ≠ÊòØÂê¶Â∫èÂàóÂåñ NameFilter ‰øÆÊîπKeyÔºåÂ¶ÇÊûúÈúÄË¶Å‰øÆÊîπKey,processËøîÂõûÂÄºÂàôÂèØ ValueFilter ‰øÆÊîπValue BeforeFilter Â∫èÂàóÂåñÊó∂Âú®ÊúÄÂâçÊ∑ªÂä†ÂÜÖÂÆπ*AfterFilter Â∫èÂàóÂåñÊó∂Âú®ÊúÄÂêéÊ∑ªÂä†ÂÜÖÂÆπ‰ª•‰∏äÁöÑSerializeFilterÂú®JSON.toJSONString‰∏≠ÂèØ‰ª•‰ΩøÁî®„ÄÇ12SerializeFilter filter = ...; // ÂèØ‰ª•ÊòØ‰∏äÈù¢5‰∏™SerializeFilterÁöÑ‰ªªÊÑè‰∏ÄÁßç„ÄÇJSON.toJSONString(obj, filter); ÈÄöËøáParseProcessÂÆöÂà∂ÂèçÂ∫èÂàóÂåñ Fastjson ÂÆû‰æãFastjson ÂØπË±°ÊàñÊï∞ÁªÑËΩ¨JSONFastjsonÈòøÈáåÂ∑¥Â∑¥Â∑•Á®ãÂ∏àÂºÄÊ∫êÁöÑ‰∏Ä‰∏™ json Â∫ìÔºöFastjsonÔºåËøô‰∏™Â∫ìÂú®Ëß£ÊûêÈÄüÂ∫¶ÂíåÊòìÁî®ÊÄß‰∏äÊù•ËØ¥ÈÉΩÂæà‰∏çÈîô„ÄÇÂú®Êó•ÂøóËß£ÊûêÔºåÂâçÂêéÁ´ØÊï∞ÊçÆ‰º†Ëæì‰∫§‰∫í‰∏≠ÔºåÁªèÂ∏∏‰ºöÈÅáÂà∞String‰∏émap„ÄÅjson„ÄÅxmlÁ≠âÊ†ºÂºèÁõ∏‰∫íËΩ¨Êç¢‰∏éËß£ÊûêÁöÑÂú∫ÊôØÔºåÂÖ∂‰∏≠jsonÂü∫Êú¨Êàê‰∏∫‰∫ÜË∑®ËØ≠Ë®Ä„ÄÅË∑®ÂâçÂêéÁ´ØÁöÑ‰∫ãÂÆû‰∏äÁöÑÊ†áÂáÜÊï∞ÊçÆ‰∫§‰∫íÊ†ºÂºè„ÄÇÂ∫îËØ•Êù•ËØ¥ÂêÑ‰∏™ËØ≠Ë®Ä‰∏≠Ëß£ÊûêjsonÁöÑÂ∫ìÈÉΩ‰∏ÄÂ§ßÁâáÔºàÂÖ∑‰Ωì json Ê†ºÂºè‰∏é‰∏âÊñπÂ∫ìÁöÑ‰ªãÁªçËØ∑ËßÅÔºöhttp://www.json.org/json-zh.html ÔºâÔºåÊØîÂ¶ÇpythonÈÉΩÈõÜÊàêÂú®‰∫ÜÂÜÖÁΩÆÂ∫ì‰∏≠ÔºåÊàê‰∏∫Ê†áÂáÜAPIÔºå‰ªäÂ§©Êàë‰ª¨Ë¶ÅËÅäÁöÑÊòØjava‰∏≠Â¶Ç‰ΩïÊñπ‰æøÁöÑ‰ΩøÁî®jsonÊ†ºÂºè„ÄÇ‰∏ãÈù¢‰∏Ä‰∏™Á§∫‰æãÊòØÂ¶Ç‰Ωï‰ΩøÁî®Fastjson ÊääÂØπË±°ÊàñÊï∞ÁªÑËΩ¨JSON1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859package com.ohaotian.feifz.style.study.utils;/** * @author feifz * @version 1.0.0 * @Description alibaba fastjsonÂ∑•ÂÖ∑Á±ª * @createTime 2019Âπ¥06Êúà10Êó• 11:45:00 */import com.alibaba.fastjson.JSON;import lombok.Data;import java.util.ArrayList;import java.util.List;class FastJsonTest &#123; public static void main(String[] args) &#123; // ÊûÑÂª∫Áî®Êà∑geust User guestUser = new User(); guestUser.setName("guest"); guestUser.setAge(28); // ÊûÑÂª∫Áî®Êà∑root User rootUser = new User(); rootUser.setName("root"); guestUser.setAge(35); // ÊûÑÂª∫Áî®Êà∑ÁªÑÂØπË±° UserGroup group = new UserGroup(); group.setName("admin"); group.getUsers().add(guestUser); group.getUsers().add(rootUser); // Áî®Êà∑ÁªÑÂØπË±°ËΩ¨JSON‰∏≤ String jsonString = JSON.toJSONString(group); System.out.println("jsonString:" + jsonString); // JSON‰∏≤ËΩ¨Áî®Êà∑ÁªÑÂØπË±° UserGroup group2 = JSON.parseObject(jsonString, UserGroup.class); System.out.println("group2:" + group2); // ÊûÑÂª∫Áî®Êà∑ÂØπË±°Êï∞ÁªÑ User[] users = new User[2]; users[0] = guestUser; users[1] = rootUser; // Áî®Êà∑ÂØπË±°Êï∞ÁªÑËΩ¨JSON‰∏≤ String jsonString2 = JSON.toJSONString(users); System.out.println("jsonString2:" + jsonString2); // JSON‰∏≤ËΩ¨Áî®Êà∑ÂØπË±°ÂàóË°® List&lt;User&gt; users2 = JSON.parseArray(jsonString2, User.class); System.out.println("users2:" + users2); &#125;&#125;@Dataclass User &#123; private String name; private int age;&#125;@Dataclass UserGroup &#123; private String name; private List&lt;User&gt; users = new ArrayList&lt;&gt;();&#125; ËæìÂá∫ÁªìÊûúÔºö1234jsonString:&#123;"name":"admin","users":[&#123;"age":35,"name":"guest"&#125;,&#123;"age":0,"name":"root"&#125;]&#125; group2:UserGroup [name=admin, users=[User [name=guest, age=35], User [name=root, age=0]]] jsonString2:[&#123;"age":35,"name":"guest"&#125;,&#123;"age":0,"name":"root"&#125;] users2:[User [name=guest, age=35], User [name=root, age=0]] fastjsonÈÄöËøáÂêÑÊñπÈù¢ÊµãËØïÈÉΩÂæàÂ•ΩÔºåÂäüËÉΩÊÄßËÉΩÈÉΩÊòØNo.1ÔºåÂñúÊ¨¢ÔºåÂÆÉÁöÑÊ∫ê‰ª£Á†ÅË¥®ÈáèÂæàÈ´òÔºå‰ΩúËÄÖ‰πüÁÖûË¥πËã¶ÂøÉÔºåÂ∞ÜÊÄßËÉΩÂÅöÂà∞‰∫ÜÊúÄÂ•ΩÔºåÂÖ®Èù¢Ë∂ÖË∂äÂÖ∂‰ªñÁöÑjsonÁ±ªÂ∫ì„ÄÇÈÄöËøáfastjsonÊàë‰ª¨ÂèØ‰ª•Âø´ÈÄüËøõË°åÂºÄÂèë„ÄÇ Fastjson Obejct/Map/JSON/String ‰∫íËΩ¨fastjson‰∏ªË¶ÅÁöÑ‰ΩøÁî®ÂÖ•Âè£Fastjson APIÂÖ•Âè£Á±ªÊòØcom.alibaba.fastjson.JSONÔºåÂ∏∏Áî®ÁöÑÂ∫èÂàóÂåñÊìç‰ΩúÈÉΩÂèØ‰ª•Âú®JSONÁ±ª‰∏äÁöÑÈùôÊÄÅÊñπÊ≥ïÁõ¥Êé•ÂÆåÊàê„ÄÇ12345678public static final Object parse(String text); // ÊääJSONÊñáÊú¨parse‰∏∫JSONObjectÊàñËÄÖJSONArray public static final JSONObject parseObject(String text)Ôºõ // ÊääJSONÊñáÊú¨parseÊàêJSONObject public static final &lt;T&gt; T parseObject(String text, Class&lt;T&gt; clazz); // ÊääJSONÊñáÊú¨parse‰∏∫JavaBean public static final JSONArray parseArray(String text); // ÊääJSONÊñáÊú¨parseÊàêJSONArray public static final &lt;T&gt; List&lt;T&gt; parseArray(String text, Class&lt;T&gt; clazz); //ÊääJSONÊñáÊú¨parseÊàêJavaBeanÈõÜÂêà public static final String toJSONString(Object object); // Â∞ÜJavaBeanÂ∫èÂàóÂåñ‰∏∫JSONÊñáÊú¨ public static final String toJSONString(Object object, boolean prettyFormat); // Â∞ÜJavaBeanÂ∫èÂàóÂåñ‰∏∫Â∏¶Ê†ºÂºèÁöÑJSONÊñáÊú¨ public static final Object toJSON(Object javaObject); Â∞ÜJavaBeanËΩ¨Êç¢‰∏∫JSONObjectÊàñËÄÖJSONArray„ÄÇ ÊúâÂÖ≥Á±ªÂ∫ìÁöÑ‰∏Ä‰∫õËØ¥Êòé1234SerializeWriterÔºöÁõ∏ÂΩì‰∫éStringBufferJSONArrayÔºöÁõ∏ÂΩì‰∫éList&lt;Object&gt;JSONObjectÔºöÁõ∏ÂΩì‰∫éMap&lt;String, Object&gt;JSONÂèçÂ∫èÂàóÂåñÊ≤°ÊúâÁúüÊ≠£Êï∞ÁªÑÔºåÊú¨Ë¥®Á±ªÂûãÈÉΩÊòØList&lt;Object&gt; Á§∫‰æã‰ª£Á†Å123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134package com.ohaotian.feifz.style.study.utils;/** * @author feifz * @version 1.0.0 * @Description fastjson È´òÁ∫ßÂ∫îÁî® * @createTime 2019Âπ¥06Êúà10Êó• 15:43:00 */import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.JSONArray;import com.alibaba.fastjson.serializer.SerializeConfig;import com.alibaba.fastjson.serializer.SimpleDateFormatSerializer;import lombok.Data;import java.util.ArrayList;import java.util.Date;import java.util.HashMap;import java.util.List;import java.util.Map;import java.util.Random;/** * @author feifz * @version 1.0.0 * @Description alibaba fastjsonÈ´òÁ∫ßÂ∫îÁî® * @createTime 2019Âπ¥06Êúà10Êó• 11:45:00 */public class FastjsonTest &#123; private static SerializeConfig mapping = new SerializeConfig(); static &#123; mapping.put(Date.class, new SimpleDateFormatSerializer("yyyy-MM-dd HH:mm:ss")); &#125; public static void main(String[] args) &#123; Date date = new Date(); String text = JSON.toJSONString(date, mapping); System.out.println(text); &#125; public static void json2List() &#123; /**List -&gt; JSON array*/ List&lt;Bar&gt; barList = new ArrayList&lt;Bar&gt;(); barList.add(new Bar()); barList.add(new Bar()); barList.add(new Bar()); String json = JSON.toJSONString(barList); System.out.println(json); json = JSON.toJSONString(barList, true); System.out.println(json); /**JSON array -&gt; List*/ List&lt;Bar&gt; barList1 = JSON.parseArray(json, Bar.class); for (Bar bar : barList1) &#123; System.out.println(bar.toString()); &#125; &#125; public static void json2Map() &#123; //Map -&gt; JSON Map&lt;String, Bar&gt; map = new HashMap&lt;String, Bar&gt;(); map.put("a", new Bar()); map.put("b", new Bar()); map.put("c", new Bar()); String json = JSON.toJSONString(map, true); System.out.println(json); //JSON -&gt; Map Map&lt;String, Bar&gt; map1 = (Map&lt;String, Bar&gt;) JSON.parse(json); for (String key : map1.keySet()) &#123; System.out.println(key + ":" + map1.get(key)); &#125; &#125; public static void array2JSON() &#123; String[] arr_String = &#123;"a", "b", "c"&#125;; String json_arr_String = JSON.toJSONString(arr_String, true); System.out.println(json_arr_String); JSONArray jsonArray = JSON.parseArray(json_arr_String); for (Object o : jsonArray) &#123; System.out.println(o); &#125; System.out.println(jsonArray); &#125; public static void array2JSON2() &#123; Bar[] arr_Bar = &#123;new Bar(), new Bar(), new Bar()&#125;; String json_arr_Bar = JSON.toJSONString(arr_Bar, true); System.out.println(json_arr_Bar); JSONArray jsonArray = JSON.parseArray(json_arr_Bar); for (Object o : jsonArray) &#123; System.out.println(o); &#125; System.out.println(jsonArray); &#125; public static void map2JSON() &#123; Map map = new HashMap(); map.put("a", "aaa"); map.put("b", "bbb"); map.put("c", "ccc"); String json = JSON.toJSONString(map); System.out.println(json); Map map1 = JSON.parseObject(json); for (Object o : map.entrySet()) &#123; Map.Entry&lt;String, String&gt; entry = (Map.Entry&lt;String, String&gt;) o; System.out.println(entry.getKey() + "---&gt;" + entry.getValue()); &#125; &#125;&#125;@Dataclass Bar &#123; public static SerializeConfig mapping = new SerializeConfig(); private String barName; private int barAge; private Date barDate = new Date(); static &#123; mapping.put(Date.class, new SimpleDateFormatSerializer("yyyy-MM-dd")); &#125; &#123; Random r = new Random(); barName = "sss_" + String.valueOf(r.nextFloat()); barAge = r.nextInt(); &#125; public static void main(String[] args) &#123; String x1 = JSON.toJSONString(new Bar(), true); System.out.println(x1); String x2 = JSON.toJSONString(new Bar(), mapping); System.out.println(x2); &#125;&#125; Fastjson API Fastjson JSONField Fastjson JSONPath Fastjson toJSONString Fastjson writeJSONString Fastjson parseObject Fastjson Api Compare Fastjson API Stream Fastjson API ParseProcess Fastjson API SerializeFilter Fastjson Â∏∏ËßÅÈóÆÈ¢òÂèÇËÄÉ https://www.w3cschool.cn/fastjson https://www.jianshu.com/p/eaeaa5dce258]]></content>
      <categories>
        <category>Â∑•ÂÖ∑</category>
      </categories>
      <tags>
        <tag>fastjson</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HttpËØ∑Ê±Ç-okhttp3]]></title>
    <url>%2F2019%2F06%2F06%2FHttp%E8%AF%B7%E6%B1%82-okhttp3%2F</url>
    <content type="text"><![CDATA[ÁÆÄ‰ªã HTTPÊòØÁé∞‰ª£Â∫îÁî®Â∏∏Áî®ÁöÑ‰∏ÄÁßç‰∫§Êç¢Êï∞ÊçÆÂíåÂ™í‰ΩìÁöÑÁΩëÁªúÊñπÂºèÔºåÈ´òÊïàÂú∞‰ΩøÁî®HTTPËÉΩËÆ©ËµÑÊ∫êÂä†ËΩΩÊõ¥Âø´ÔºåËäÇÁúÅÂ∏¶ÂÆΩ„ÄÇOkHttpÊòØ‰∏Ä‰∏™È´òÊïàÁöÑHTTPÂÆ¢Êà∑Á´ØÔºåÂÆÉÊúâ‰ª•‰∏ãÈªòËÆ§ÁâπÊÄßÔºö ÊîØÊåÅHTTP/2ÔºåÂÖÅËÆ∏ÊâÄÊúâÂêå‰∏Ä‰∏™‰∏ªÊú∫Âú∞ÂùÄÁöÑËØ∑Ê±ÇÂÖ±‰∫´Âêå‰∏Ä‰∏™socketËøûÊé• ËøûÊé•Ê±†ÂáèÂ∞ëËØ∑Ê±ÇÂª∂Êó∂ ÈÄèÊòéÁöÑGZIPÂéãÁº©ÂáèÂ∞ëÂìçÂ∫îÊï∞ÊçÆÁöÑÂ§ßÂ∞è ÁºìÂ≠òÂìçÂ∫îÂÜÖÂÆπÔºåÈÅøÂÖç‰∏Ä‰∫õÂÆåÂÖ®ÈáçÂ§çÁöÑËØ∑Ê±Ç Ê∫êÁ†ÅÔºöhttps://github.com/square/okhttpËØ¥ÊòéÔºöOkHttpÊîØÊåÅAndroid 2.3Âèä‰ª•‰∏äÁâàÊú¨AndroidÂπ≥Âè∞,ÂØπ‰∫éJava, JDK1.7Âèä‰ª•‰∏ä„ÄÇ ÂΩìÁΩëÁªúÂá∫Áé∞ÈóÆÈ¢òÁöÑÊó∂ÂÄôOkHttp‰æùÁÑ∂ÂùöÂÆàËá™Â∑±ÁöÑËÅåË¥£ÔºåÂÆÉ‰ºöËá™Âä®ÊÅ¢Â§ç‰∏ÄËà¨ÁöÑËøûÊé•ÈóÆÈ¢òÔºåÂ¶ÇÊûú‰Ω†ÁöÑÊúçÂä°ÊúâÂ§ö‰∏™IPÂú∞ÂùÄÔºåÂΩìÁ¨¨‰∏Ä‰∏™IPËØ∑Ê±ÇÂ§±Ë¥•Êó∂ÔºåOkHttp‰ºö‰∫§ÊõøÂ∞ùËØï‰Ω†ÈÖçÁΩÆÁöÑÂÖ∂‰ªñIPÔºåOkHttp‰ΩøÁî®Áé∞‰ª£TLSÊäÄÊúØ(SNI, ALPN)ÂàùÂßãÂåñÊñ∞ÁöÑËøûÊé•ÔºåÂΩìÊè°ÊâãÂ§±Ë¥•Êó∂‰ºöÂõûÈÄÄÂà∞TLS 1.0„ÄÇ ÁÆÄÂçï‰ΩøÁî®ÂºïÂÖ•maven‰æùËµñ12345&lt;dependency&gt; &lt;groupId&gt;com.squareup.okhttp3&lt;/groupId&gt; &lt;artifactId&gt;okhttp&lt;/artifactId&gt; &lt;version&gt;4.0.0-RC1&lt;/version&gt;&lt;/dependency&gt; ËØ∑Ê±ÇÊñπÊ≥ïÂêåÊ≠•ËØ∑Ê±Ç Â∞±ÊòØÊâßË°åËØ∑Ê±ÇÁöÑÊìç‰ΩúÊòØÈòªÂ°ûÂºèÔºåÁõ¥Âà∞ HTTP ÂìçÂ∫îËøîÂõû„ÄÇÂÆÉÂØπÂ∫î OKHTTP ‰∏≠ÁöÑ execute ÊñπÊ≥ï„ÄÇ GETËØ∑Ê±Ç1234567891011121314151617181920/** * ÂêåÊ≠•getÊñπÂºèËØ∑Ê±Ç * * @param url * @return * @throws IOException */public static String doGet(String url) throws IOException &#123; OkHttpClient client = new OkHttpClient(); Request request = new Request.Builder() .url(url) .build(); try (Response response = client.newCall(request).execute()) &#123; if (response.isSuccessful()) &#123; return response.body().string(); &#125; else &#123; throw new IOException("Unexpected code " + response); &#125; &#125;&#125; POSTËØ∑Ê±ÇJsonÊèê‰∫§ÂèÇÊï∞123456789101112131415161718192021222324/** * ÂêåÊ≠•postÊñπÂºèËØ∑Ê±Ç-jsonÊèê‰∫§ÂèÇÊï∞ * * @param url * @param json * @return * @throws IOException */ public static String doPost(String url, final String json) throws IOException &#123; OkHttpClient client = new OkHttpClient(); RequestBody body = RequestBody.create(JSON, json); Request request = new Request.Builder() .url(url) .post(body) .build(); try (Response response = client.newCall(request).execute()) &#123; if (response.isSuccessful()) &#123; return response.body().string(); &#125; else &#123; throw new IOException("Unexpected code " + response); &#125; &#125; &#125; formË°®ÂçïÊèê‰∫§ÂèÇÊï∞12345678910111213141516171819202122232425262728/** * ÂêåÊ≠•postÊñπÂºèËØ∑Ê±Ç-formË°®ÂçïÊèê‰∫§ÂèÇÊï∞ * * @param url * @param paramsMap * @return * @throws IOException */public static String doPost(String url, Map&lt;String, String&gt; paramsMap) throws IOException &#123; OkHttpClient client = new OkHttpClient(); FormBody.Builder builder = new FormBody.Builder(); for (String key : paramsMap.keySet()) &#123; builder.add(key, paramsMap.get(key)); &#125; RequestBody formBody = builder.build(); Request request = new Request.Builder() .url(url) .post(formBody) .build(); try (Response response = client.newCall(request).execute()) &#123; if (response.isSuccessful()) &#123; return response.body().string(); &#125; else &#123; throw new IOException("Unexpected code " + response); &#125; &#125;&#125; ÂºÇÊ≠•ËØ∑Ê±Ç Â∞±ÊòØÁ±ª‰ºº‰∫éÈùûÈòªÂ°ûÂºèÁöÑËØ∑Ê±ÇÔºåÂÆÉÁöÑÊâßË°åÁªìÊûú‰∏ÄËà¨ÈÉΩÊòØÈÄöËøáÊé•Âè£ÂõûË∞ÉÁöÑÊñπÂºèÂëäÁü•Ë∞ÉÁî®ËÄÖ„ÄÇÂÆÉÂØπÂ∫î OKHTTP ‰∏≠ÁöÑ enqueue ÊñπÊ≥ï„ÄÇ ËøôÊòØÂºÇÊ≠•ËØ∑Ê±ÇÔºåÊâÄ‰ª•Ë∞ÉÁî®enqueueÂàôÊó†ÈúÄÂÜçÂºÄÂêØÂ≠êÁ∫øÁ®ãÔºåenqueueÊñπÊ≥ï‰ºöËá™Âä®Â∞ÜÁΩëÁªúËØ∑Ê±ÇÈÉ®ÂàÜÊîæÂÖ•Â≠êÁ∫øÁ®ã‰∏≠ÊâßË°å„ÄÇenqueueÂõûË∞ÉÊñπÊ≥ïonResponse‰∏éonFailureÈÉΩÊâßË°åÂú®Â≠êÁ∫øÁ®ã‰∏≠„ÄÇÊ≥®ÊÑè‰∫ãÈ°πÔºö ÂõûË∞ÉÊé•Âè£ÁöÑonFailureÊñπÊ≥ïÂíåonResponseÊâßË°åÂú®Â≠êÁ∫øÁ®ã„ÄÇ Response.codeÊòØhttpÂìçÂ∫îË°å‰∏≠ÁöÑcodeÔºåÂ¶ÇÊûúËÆøÈóÆÊàêÂäüÂàôËøîÂõû200.Ëøô‰∏™‰∏çÊòØÊúçÂä°Âô®ËÆæÁΩÆÁöÑÔºåËÄåÊòØhttpÂçèËÆÆ‰∏≠Ëá™Â∏¶ÁöÑ„ÄÇres‰∏≠ÁöÑcodeÊâçÊòØÊúçÂä°Âô®ËÆæÁΩÆÁöÑ„ÄÇÊ≥®ÊÑè‰∫åËÄÖÁöÑÂå∫Âà´„ÄÇ response.body().string()Êú¨Ë¥®ÊòØËæìÂÖ•ÊµÅÁöÑËØªÊìç‰ΩúÔºåÊâÄ‰ª•ÂÆÉËøòÊòØÁΩëÁªúËØ∑Ê±ÇÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÊâÄ‰ª•ËøôË°å‰ª£Á†ÅÂøÖÈ°ªÊîæÂú®Â≠êÁ∫øÁ®ã„ÄÇ response.body().string()Âè™ËÉΩË∞ÉÁî®‰∏ÄÊ¨°ÔºåÂú®Á¨¨‰∏ÄÊ¨°Êó∂ÊúâËøîÂõûÂÄºÔºåÁ¨¨‰∫åÊ¨°ÂÜçË∞ÉÁî®Êó∂Â∞Ü‰ºöËøîÂõûnull„ÄÇÂéüÂõ†ÊòØÔºöresponse.body().string()ÁöÑÊú¨Ë¥®ÊòØËæìÂÖ•ÊµÅÁöÑËØªÊìç‰ΩúÔºåÂøÖÈ°ªÊúâÊúçÂä°Âô®ÁöÑËæìÂá∫ÊµÅÁöÑÂÜôÊìç‰ΩúÊó∂ÂÆ¢Êà∑Á´ØÁöÑËØªÊìç‰ΩúÊâçËÉΩÂæóÂà∞Êï∞ÊçÆ„ÄÇËÄåÊúçÂä°Âô®ÁöÑÂÜôÊìç‰ΩúÂè™ÊâßË°å‰∏ÄÊ¨°ÔºåÊâÄ‰ª•ÂÆ¢Êà∑Á´ØÁöÑËØªÊìç‰Ωú‰πüÂè™ËÉΩÊâßË°å‰∏ÄÊ¨°ÔºåÁ¨¨‰∫åÊ¨°Â∞ÜËøîÂõûnull„ÄÇ ÂÜçÊ¨°Âº∫Ë∞ÉÔºåresponse.body().string()ÊñπÊ≥ïÂøÖÈ°ªÊîæÂú®Â≠êÁ∫øÁ®ã‰∏≠„ÄÇÂΩìÊâßË°åËøôË°å‰ª£Á†ÅÂæóÂà∞ÁªìÊûúÂêéÔºåÂÜçË∑≥ËΩ¨Âà∞UIÁ∫øÁ®ã‰øÆÊîπUI„ÄÇ ÂºÇÊ≠•ËØ∑Ê±ÇËá™ÂÆö‰πâÂõûË∞ÉÂáΩÊï∞123456789101112131415161718/** * okhttp ÂºÇÊ≠•Ë∞ÉÁî®ÂõûË∞ÉÂáΩÊï∞ */ static class OkHttpCallback implements Callback &#123; @Override public void onFailure(@NotNull Call call, @NotNull IOException e) &#123; log.error(e); &#125; @Override public void onResponse(@NotNull Call call, @NotNull Response response) throws IOException &#123; if (response.isSuccessful()) &#123; log.info("Successful data acquisition . . . "); log.info("response.code()==" + response.code()); log.info("response.body().string()==" + response.body().string()); &#125; &#125; &#125; GETËØ∑Ê±Ç12345678910111213141516/** * ÂºÇÊ≠•getÊñπÂºèËØ∑Ê±Ç * * @param url * @return * @throws IOException */public static void doSyncGet(String url) &#123; OkHttpClient okHttpClient = new OkHttpClient(); final Request request = new Request.Builder() .url(url) .get() .build(); Call call = okHttpClient.newCall(request); call.enqueue(new OkHttpCallback());&#125; POSTËØ∑Ê±ÇJsonÊèê‰∫§ÂèÇÊï∞123456789101112131415161718/** * ÂºÇÊ≠•postÊñπÂºèËØ∑Ê±Ç-jsonÊèê‰∫§ÂèÇÊï∞ * * @param url * @param json * @return * @throws IOException */public static void doSyncPost(String url, final String json) &#123; OkHttpClient client = new OkHttpClient(); RequestBody body = RequestBody.create(JSON, json); Request request = new Request.Builder() .url(url) .post(body) .build(); client.newCall(request).enqueue(new OkHttpCallback());&#125; formË°®ÂçïÊèê‰∫§ÂèÇÊï∞12345678910111213141516171819202122/** * ÂºÇÊ≠•postÊñπÂºèËØ∑Ê±Ç-formË°®ÂçïÊèê‰∫§ÂèÇÊï∞ * * @param url * @param paramsMap * @return * @throws IOException */ public static void doSyncPost(String url, Map&lt;String, String&gt; paramsMap) &#123; OkHttpClient client = new OkHttpClient(); FormBody.Builder builder = new FormBody.Builder(); for (String key : paramsMap.keySet()) &#123; builder.add(key, paramsMap.get(key)); &#125; RequestBody formBody = builder.build(); Request request = new Request.Builder() .url(url) .post(formBody) .build(); client.newCall(request).enqueue(new OkHttpCallback()); &#125; ÂèÇËÄÉ https://www.jianshu.com/p/da4a806e599b https://blog.csdn.net/m0_38143863/article/details/80220247 Á§∫‰æã‰ª£Á†Å123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183package com.ohaotian.feifz.style.study.utils;import lombok.extern.log4j.Log4j2;import okhttp3.Call;import okhttp3.Callback;import okhttp3.FormBody;import okhttp3.MediaType;import okhttp3.OkHttpClient;import okhttp3.Request;import okhttp3.RequestBody;import okhttp3.Response;import org.jetbrains.annotations.NotNull;import java.io.IOException;import java.util.Map;/** * @author feifz * @version 1.0.0 * @Description httpÂ∑•ÂÖ∑Á±ªÔºåÂü∫‰∫éokhttp3 * @createTime 2019Âπ¥06Êúà06Êó• 09:30:00 */@Log4j2public class HttpUtil &#123; public static final MediaType JSON = MediaType.get("application/json; charset=utf-8"); /** * ÂêåÊ≠•getÊñπÂºèËØ∑Ê±Ç * * @param url * @return * @throws IOException */ public static String doGet(String url) throws IOException &#123; OkHttpClient client = new OkHttpClient(); Request request = new Request.Builder() .url(url) .build(); try (Response response = client.newCall(request).execute()) &#123; if (response.isSuccessful()) &#123; return response.body().string(); &#125; else &#123; throw new IOException("Unexpected code " + response); &#125; &#125; &#125; /** * ÂºÇÊ≠•getÊñπÂºèËØ∑Ê±Ç * * @param url * @return * @throws IOException */ public static void doSyncGet(String url) &#123; OkHttpClient okHttpClient = new OkHttpClient(); final Request request = new Request.Builder() .url(url) .get() .build(); Call call = okHttpClient.newCall(request); call.enqueue(new OkHttpCallback()); &#125; /** * ÂêåÊ≠•postÊñπÂºèËØ∑Ê±Ç-jsonÊèê‰∫§ÂèÇÊï∞ * * @param url * @param json * @return * @throws IOException */ public static String doPost(String url, final String json) throws IOException &#123; OkHttpClient client = new OkHttpClient(); RequestBody body = RequestBody.create(JSON, json); Request request = new Request.Builder() .url(url) .post(body) .build(); try (Response response = client.newCall(request).execute()) &#123; if (response.isSuccessful()) &#123; return response.body().string(); &#125; else &#123; throw new IOException("Unexpected code " + response); &#125; &#125; &#125; /** * ÂºÇÊ≠•postÊñπÂºèËØ∑Ê±Ç-jsonÊèê‰∫§ÂèÇÊï∞ * * @param url * @param json * @return * @throws IOException */ public static void doSyncPost(String url, final String json) &#123; OkHttpClient client = new OkHttpClient(); RequestBody body = RequestBody.create(JSON, json); Request request = new Request.Builder() .url(url) .post(body) .build(); client.newCall(request).enqueue(new OkHttpCallback()); &#125; /** * ÂêåÊ≠•postÊñπÂºèËØ∑Ê±Ç-formË°®ÂçïÊèê‰∫§ÂèÇÊï∞ * * @param url * @param paramsMap * @return * @throws IOException */ public static String doPost(String url, Map&lt;String, String&gt; paramsMap) throws IOException &#123; OkHttpClient client = new OkHttpClient(); FormBody.Builder builder = new FormBody.Builder(); for (String key : paramsMap.keySet()) &#123; builder.add(key, paramsMap.get(key)); &#125; RequestBody formBody = builder.build(); Request request = new Request.Builder() .url(url) .post(formBody) .build(); try (Response response = client.newCall(request).execute()) &#123; if (response.isSuccessful()) &#123; return response.body().string(); &#125; else &#123; throw new IOException("Unexpected code " + response); &#125; &#125; &#125; /** * ÂºÇÊ≠•postÊñπÂºèËØ∑Ê±Ç-formË°®ÂçïÊèê‰∫§ÂèÇÊï∞ * * @param url * @param paramsMap * @return * @throws IOException */ public static void doSyncPost(String url, Map&lt;String, String&gt; paramsMap) &#123; OkHttpClient client = new OkHttpClient(); FormBody.Builder builder = new FormBody.Builder(); for (String key : paramsMap.keySet()) &#123; builder.add(key, paramsMap.get(key)); &#125; RequestBody formBody = builder.build(); Request request = new Request.Builder() .url(url) .post(formBody) .build(); client.newCall(request).enqueue(new OkHttpCallback()); &#125; /** * okhttp ÂºÇÊ≠•Ë∞ÉÁî®ÂõûË∞ÉÂáΩÊï∞ */ static class OkHttpCallback implements Callback &#123; @Override public void onFailure(@NotNull Call call, @NotNull IOException e) &#123; log.error(e); &#125; @Override public void onResponse(@NotNull Call call, @NotNull Response response) throws IOException &#123; if (response.isSuccessful()) &#123; log.info("Successful data acquisition . . . "); log.info("response.code()==" + response.code()); log.info("response.body().string()==" + response.body().string()); &#125; &#125; &#125;&#125;]]></content>
      <categories>
        <category>Â∑•ÂÖ∑</category>
      </categories>
      <tags>
        <tag>http</tag>
        <tag>okhttp3</tag>
        <tag>ÂºÄÊ∫êÈ°πÁõÆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KafkaÁîü‰∫ßËÄÖÂèëÈÄÅÊ∂àÊÅØÁöÑ‰∏âÁßçÊñπÂºè]]></title>
    <url>%2F2019%2F05%2F31%2FKafka%E7%94%9F%E4%BA%A7%E8%80%85%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[‰ªãÁªçKafkaÊòØ‰∏ÄÁßçÂàÜÂ∏ÉÂºèÁöÑÂü∫‰∫éÂèëÂ∏É/ËÆ¢ÈòÖÁöÑÊ∂àÊÅØÁ≥ªÁªüÔºåÂÆÉÁöÑÈ´òÂêûÂêêÈáè„ÄÅÁÅµÊ¥ªÁöÑoffsetÊòØÂÖ∂ÂÆÉÊ∂àÊÅØÁ≥ªÁªüÊâÄÊ≤°ÊúâÁöÑ„ÄÇ ‰∏âÁßçÊñπÂºèKafkaÂèëÈÄÅÊ∂àÊÅØ‰∏ªË¶ÅÊúâ‰∏âÁßçÊñπÂºèÔºö ÂèëÈÄÅÂπ∂ÂøòËÆ∞ ÂêåÊ≠•ÂèëÈÄÅ ÂºÇÊ≠•ÂèëÈÄÅ+ÂõûË∞ÉÂáΩÊï∞ ÂèëÈÄÅÂπ∂ÂøòËÆ∞ÂèëÈÄÅÂπ∂ÂøòËÆ∞(‰∏çÂÖ≥ÂøÉÊ∂àÊÅØÊòØÂê¶Ê≠£Â∏∏Âà∞ËææÔºåÂØπËøîÂõûÁªìÊûú‰∏çÂÅö‰ªª‰ΩïÂà§Êñ≠Â§ÑÁêÜ)ÂèëÈÄÅÂπ∂ÂøòËÆ∞ÁöÑÊñπÂºèÊú¨Ë¥®‰∏ä‰πüÊòØ‰∏ÄÁßçÂºÇÊ≠•ÁöÑÊñπÂºèÔºåÂè™ÊòØÂÆÉ‰∏ç‰ºöËé∑ÂèñÊ∂àÊÅØÂèëÈÄÅÁöÑËøîÂõûÁªìÊûúÔºåËøôÁßçÊñπÂºèÁöÑÂêûÂêêÈáèÊòØÊúÄÈ´òÁöÑÔºå‰ΩÜÊòØÊó†Ê≥ï‰øùËØÅÊ∂àÊÅØÁöÑÂèØÈù†ÊÄß. 123456789101112131415161718public static void wayOne() &#123; String brokeList = "127.0.0.1:9092"; String topic = "testTopic"; String key = "testKey"; Producer&lt;String, String&gt; producer = initProducer(brokeList); long before = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂâç--&gt;"+before); for(int i=1 ;i&lt;10000;i++)&#123; producer.send(new ProducerRecord&lt;&gt;(topic, 0,key, String.valueOf(i))); &#125; producer.flush(); producer.close(); long after = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂêé--&gt;"+after); long temp = after-before; System.out.println("Êó∂Èó¥Èó¥Èöî--&gt;"+temp); &#125; ÂêåÊ≠•ÂèëÈÄÅÂêåÊ≠•ÂèëÈÄÅ(ÈÄöËøágetÊñπÊ≥ïÁ≠âÂæÖKafkaÁöÑÂìçÂ∫îÔºåÂà§Êñ≠Ê∂àÊÅØÊòØÂê¶ÂèëÈÄÅÊàêÂäü)‰ª•ÂêåÊ≠•ÁöÑÊñπÂºèÂèëÈÄÅÊ∂àÊÅØÊó∂Ôºå‰∏ÄÊù°‰∏ÄÊù°ÁöÑÂèëÈÄÅÔºåÂØπÊØèÊù°Ê∂àÊÅØËøîÂõûÁöÑÁªìÊûúÂà§Êñ≠Ôºå ÂèØ‰ª•ÊòéÁ°ÆÂú∞Áü•ÈÅìÊØèÊù°Ê∂àÊÅØÁöÑÂèëÈÄÅÊÉÖÂÜµÔºå‰ΩÜÊòØÁî±‰∫éÂêåÊ≠•ÁöÑÊñπÂºè‰ºöÈòªÂ°ûÔºåÂè™ÊúâÂΩìÊ∂àÊÅØÈÄöËøágetËøîÂõûfutureÂØπË±°Êó∂ÔºåÊâç‰ºöÁªßÁª≠‰∏ã‰∏ÄÊù°Ê∂àÊÅØÁöÑÂèëÈÄÅÔºö 1234567891011121314151617181920212223public static void wayTwo() &#123; String brokeList = "39.96.117.232:9092"; String topic = "testTopic"; String key = "testKey"; Producer&lt;String, String&gt; producer = initProducer(brokeList); long before = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂâç--&gt;"+before); for(int i=1 ;i&lt;10000;i++)&#123; Future&lt;RecordMetadata&gt; recordMetadataFuture = producer.send(new ProducerRecord&lt;&gt;(topic,key, String.valueOf(i))); try &#123; RecordMetadata record = recordMetadataFuture.get(10, TimeUnit.MICROSECONDS); System.out.println(record.toString()); &#125;catch (Exception e)&#123; System.out.println(e); &#125; &#125; long after = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂêé--&gt;"+after); long temp = after-before; System.out.println("Êó∂Èó¥Èó¥Èöî--&gt;"+temp); &#125; ÂºÇÊ≠•ÂèëÈÄÅ+ÂõûË∞ÉÂáΩÊï∞ÂºÇÊ≠•ÂèëÈÄÅ+ÂõûË∞ÉÂáΩÊï∞(Ê∂àÊÅØ‰ª•ÂºÇÊ≠•ÁöÑÊñπÂºèÂèëÈÄÅÔºåÈÄöËøáÂõûË∞ÉÂáΩÊï∞ËøîÂõûÊ∂àÊÅØÂèëÈÄÅÊàêÂäü/Â§±Ë¥•)Âú®Ë∞ÉÁî®sendÊñπÊ≥ïÂèëÈÄÅÊ∂àÊÅØÁöÑÂêåÊó∂ÔºåÊåáÂÆö‰∏Ä‰∏™ÂõûË∞ÉÂáΩÊï∞ÔºåÊúçÂä°Âô®Âú®ËøîÂõûÂìçÂ∫îÊó∂‰ºöË∞ÉÁî®ËØ•ÂõûË∞ÉÂáΩÊï∞ÔºåÈÄöËøáÂõûË∞ÉÂáΩÊï∞ËÉΩÂ§üÂØπÂºÇÂ∏∏ÊÉÖÂÜµËøõË°åÂ§ÑÁêÜÔºåÂΩìË∞ÉÁî®‰∫ÜÂõûË∞ÉÂáΩÊï∞Êó∂ÔºåÂè™ÊúâÂõûË∞ÉÂáΩÊï∞ÊâßË°åÂÆåÊØïÁîü‰∫ßËÄÖÊâç‰ºöÁªìÊùüÔºåÂê¶Âàô‰∏ÄÁõ¥‰ºöÈòªÂ°û„ÄÇ 123456789101112131415161718192021222324public static void wayThree() &#123; String brokeList = "39.96.117.232:9092"; String topic = "testTopic"; String key = "testKey"; Producer&lt;String, String&gt; producer = initProducer(brokeList); long before = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂâç--&gt;"+before); for(int i=1 ;i&lt;10000;i++)&#123; producer.send(new ProducerRecord&lt;&gt;(topic, key, String.valueOf(i)), new Callback() &#123; @Override public void onCompletion(RecordMetadata recordMetadata, Exception e) &#123; if(e==null)&#123; System.out.println("## ÂèëÈÄÅÊ∂àÊÅØÊàêÂäü-&gt;"); &#125;else &#123; System.out.println("## ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•-&gt;&#123;&#125;"+e.getMessage()); &#125; &#125; &#125;); &#125; long after = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂêé--&gt;"+after); long temp = after-before; System.out.println("Êó∂Èó¥Èó¥Èöî--&gt;"+temp); &#125; Á§∫‰æã‰ª£Á†Å Âü∫‰∫éjavaÂÆûÁé∞(ÂæÖÂÆåÂñÑ) ‰æùËµñjarÂåÖÔºö 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt; &lt;artifactId&gt;kafka_2.12&lt;/artifactId&gt; &lt;version&gt;2.2.0&lt;/version&gt;&lt;/dependency&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129package com.ohaotian.feifz.mq.kafka;import org.apache.kafka.clients.producer.Callback;import org.apache.kafka.clients.producer.KafkaProducer;import org.apache.kafka.clients.producer.Producer;import org.apache.kafka.clients.producer.ProducerRecord;import org.apache.kafka.clients.producer.RecordMetadata;import java.util.Properties;import java.util.concurrent.Future;import java.util.concurrent.TimeUnit;/** * @Author: feifz * @Date: 2019-05-31 15:34 * @Version: 1.0 * @Description: kafka ÂèëÈÄÅÊ∂àÊÅØ‰∏âÁßçÊñπÂºèÂèëÈÄÅÊ∂àÊÅØÁ§∫‰æã‰ª£Á†Å * @Refer https://www.cnblogs.com/FG123/p/10091478.html */public class KafkaSendMsgDemo &#123; public static void main(String[] args) &#123; /** ‰∏âÁßçÊñπÂºèËôΩÁÑ∂Âú®Êó∂Èó¥‰∏äÊúâÊâÄÂ∑ÆÂà´Ôºå‰ΩÜÂπ∂‰∏çÊòØËØ¥Êó∂Èó¥Ë∂äÂø´ÁöÑË∂äÂ•ΩÔºåÂÖ∑‰ΩìË¶ÅÁúã‰∏öÂä°ÁöÑÂ∫îÁî®Âú∫ÊôØÔºö Âú∫ÊôØ1ÔºöÂ¶ÇÊûú‰∏öÂä°Ë¶ÅÊ±ÇÊ∂àÊÅØÂøÖÈ°ªÊòØÊåâÈ°∫Â∫èÂèëÈÄÅÁöÑÔºåÈÇ£‰πàÂèØ‰ª•‰ΩøÁî®ÂêåÊ≠•ÁöÑÊñπÂºèÔºåÂπ∂‰∏îÂè™ËÉΩÂú®‰∏Ä‰∏™partation‰∏äÊàñÊåáÂÆöÂêå‰∏Ä‰∏™keyÔºåÁªìÂêàÂèÇÊï∞ËÆæÁΩÆretriesÁöÑÂÄºËÆ©ÂèëÈÄÅÂ§±Ë¥•Êó∂ÈáçËØïÔºåËÆæÁΩÆmax_in_flight_requests_per_connection=1ÔºåÂèØ‰ª•ÊéßÂà∂Áîü‰∫ßËÄÖÂú®Êî∂Âà∞ÊúçÂä°Âô®ÊôåÂ∫î‰πãÂâçÂè™ËÉΩÂèëÈÄÅ1‰∏™Ê∂àÊÅØÔºå‰ªéËÄåÊéßÂà∂Ê∂àÊÅØÈ°∫Â∫èÂèëÈÄÅÔºõ Âú∫ÊôØ2ÔºöÂ¶ÇÊûú‰∏öÂä°Âè™ÂÖ≥ÂøÉÊ∂àÊÅØÁöÑÂêûÂêêÈáèÔºåÂÆπËÆ∏Â∞ëÈáèÊ∂àÊÅØÂèëÈÄÅÂ§±Ë¥•Ôºå‰πü‰∏çÂÖ≥Ê≥®Ê∂àÊÅØÁöÑÂèëÈÄÅÈ°∫Â∫èÔºåÈÇ£‰πàÂèØ‰ª•‰ΩøÁî®ÂèëÈÄÅÂπ∂ÂøòËÆ∞ÁöÑÊñπÂºèÔºåÂπ∂ÈÖçÂêàÂèÇÊï∞acks=0ÔºåËøôÊ†∑Áîü‰∫ßËÄÖ‰∏çÈúÄË¶ÅÁ≠âÂæÖÊúçÂä°Âô®ÁöÑÂìçÂ∫îÔºå‰ª•ÁΩëÁªúËÉΩÊîØÊåÅÁöÑÊúÄÂ§ßÈÄüÂ∫¶ÂèëÈÄÅÊ∂àÊÅØÔºõ Âú∫ÊôØ3ÔºöÂ¶ÇÊûú‰∏öÂä°ÈúÄË¶ÅÁü•ÈÅìÊ∂àÊÅØÂèëÈÄÅÊòØÂê¶ÊàêÂäüÔºåÂπ∂‰∏îÂØπÊ∂àÊÅØÁöÑÈ°∫Â∫è‰∏çÂÖ≥ÂøÉÔºåÈÇ£‰πàÂèØ‰ª•Áî®ÂºÇÊ≠•+ÂõûË∞ÉÁöÑÊñπÂºèÊù•ÂèëÈÄÅÊ∂àÊÅØÔºåÈÖçÂêàÂèÇÊï∞retries=0ÔºåÂπ∂Â∞ÜÂèëÈÄÅÂ§±Ë¥•ÁöÑÊ∂àÊÅØËÆ∞ÂΩïÂà∞Êó•ÂøóÊñá‰ª∂‰∏≠Ôºõ * */ wayThree(); &#125; /** * ÂèëÈÄÅÂπ∂ÂøòËÆ∞(‰∏çÂÖ≥ÂøÉÊ∂àÊÅØÊòØÂê¶Ê≠£Â∏∏Âà∞ËææÔºåÂØπËøîÂõûÁªìÊûú‰∏çÂÅö‰ªª‰ΩïÂà§Êñ≠Â§ÑÁêÜ) */ public static void wayOne() &#123; String brokeList = "127.0.0.1:9092"; String topic = "testTopic"; String key = "testKey"; Producer&lt;String, String&gt; producer = initProducer(brokeList); long before = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂâç--&gt;"+before); for(int i=1 ;i&lt;10000;i++)&#123; producer.send(new ProducerRecord&lt;&gt;(topic, 0,key, String.valueOf(i))); &#125; producer.flush(); producer.close(); long after = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂêé--&gt;"+after); long temp = after-before; System.out.println("Êó∂Èó¥Èó¥Èöî--&gt;"+temp); &#125; /** * ÂêåÊ≠•ÂèëÈÄÅ-(ÈÄöËøágetÊñπÊ≥ïÁ≠âÂæÖKafkaÁöÑÂìçÂ∫îÔºåÂà§Êñ≠Ê∂àÊÅØÊòØÂê¶ÂèëÈÄÅÊàêÂäü) */ public static void wayTwo() &#123; String brokeList = "39.96.117.232:9092"; String topic = "testTopic"; String key = "testKey"; Producer&lt;String, String&gt; producer = initProducer(brokeList); long before = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂâç--&gt;"+before); for(int i=1 ;i&lt;10000;i++)&#123; Future&lt;RecordMetadata&gt; recordMetadataFuture = producer.send(new ProducerRecord&lt;&gt;(topic,key, String.valueOf(i))); try &#123; RecordMetadata record = recordMetadataFuture.get(10, TimeUnit.MICROSECONDS); System.out.println(record.toString()); &#125;catch (Exception e)&#123; System.out.println(e); &#125; &#125; long after = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂêé--&gt;"+after); long temp = after-before; System.out.println("Êó∂Èó¥Èó¥Èöî--&gt;"+temp); &#125; /** * ÂºÇÊ≠•ÂèëÈÄÅ+ÂõûË∞ÉÂáΩÊï∞(Ê∂àÊÅØ‰ª•ÂºÇÊ≠•ÁöÑÊñπÂºèÂèëÈÄÅÔºåÈÄöËøáÂõûË∞ÉÂáΩÊï∞ËøîÂõûÊ∂àÊÅØÂèëÈÄÅÊàêÂäü/Â§±Ë¥•) */ public static void wayThree() &#123; String brokeList = "39.96.117.232:9092"; String topic = "testTopic"; String key = "testKey"; Producer&lt;String, String&gt; producer = initProducer(brokeList); long before = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂâç--&gt;"+before); for(int i=1 ;i&lt;10000;i++)&#123; producer.send(new ProducerRecord&lt;&gt;(topic, key, String.valueOf(i)), new Callback() &#123; @Override public void onCompletion(RecordMetadata recordMetadata, Exception e) &#123; if(e==null)&#123; System.out.println("## ÂèëÈÄÅÊ∂àÊÅØÊàêÂäü-&gt;"); &#125;else &#123; System.out.println("## ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•-&gt;&#123;&#125;"+e.getMessage()); &#125; &#125; &#125;); &#125; long after = System.currentTimeMillis(); System.out.println("ÂèëÈÄÅÂêé--&gt;"+after); long temp = after-before; System.out.println("Êó∂Èó¥Èó¥Èöî--&gt;"+temp); &#125; /** * ÂàùÂßãÂåñproducer * @param brokeList * @return */ private static Producer&lt;String, String&gt; initProducer(String brokeList) &#123; Properties props = new Properties(); props.put("bootstrap.servers", brokeList); props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer"); props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer"); props.put("retries", 0); Producer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props); return producer; &#125;&#125;]]></content>
      <categories>
        <category>ÁªÑ‰ª∂</category>
      </categories>
      <tags>
        <tag>Kafka</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KafkaÂÆâË£Ö‰∏éÂÖ•Èó®]]></title>
    <url>%2F2019%2F05%2F31%2FKafka%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[‰ªãÁªçKafka ÊòØ‰∏ÄÁßçÈ´òÂêûÂêêÈáèÁöÑÂàÜÂ∏ÉÂºèÂèëÂ∏ÉËÆ¢ÈòÖÊ∂àÊÅØÁ≥ªÁªüÔºåÊúâÂ¶Ç‰∏ãÁâπÊÄßÔºö ÈÄöËøáO(1)ÁöÑÁ£ÅÁõòÊï∞ÊçÆÁªìÊûÑÊèê‰æõÊ∂àÊÅØÁöÑÊåÅ‰πÖÂåñÔºåËøôÁßçÁªìÊûÑÂØπ‰∫éÂç≥‰ΩøÊï∞‰ª•TBÁöÑÊ∂àÊÅØÂ≠òÂÇ®‰πüËÉΩÂ§ü‰øùÊåÅÈïøÊó∂Èó¥ÁöÑÁ®≥ÂÆöÊÄßËÉΩ„ÄÇ È´òÂêûÂêêÈáè ÔºöÂç≥‰ΩøÊòØÈùûÂ∏∏ÊôÆÈÄöÁöÑÁ°¨‰ª∂Kafka‰πüÂèØ‰ª•ÊîØÊåÅÊØèÁßíÊï∞Áôæ‰∏áÁöÑÊ∂àÊÅØ„ÄÇ ÊîØÊåÅÈÄöËøáKafkaÊúçÂä°Âô®ÂíåÊ∂àË¥πÊú∫ÈõÜÁæ§Êù•ÂàÜÂå∫Ê∂àÊÅØ„ÄÇ ÊîØÊåÅHadoopÂπ∂Ë°åÊï∞ÊçÆÂä†ËΩΩ„ÄÇ KafkaÈÄöËøáÂÆòÁΩëÂèëÂ∏É‰∫ÜÊúÄÊñ∞ÁâàÊú¨2.0.0 ÂÆâË£Ö Âü∫‰∫éLinuxÂíåmacosÊìç‰ΩúÁ≥ªÁªü ÂèÇËÄÉ http://kafka.apache.org/quickstart http://orchome.com/6 Step 1: ‰∏ãËΩΩ‰ª£Á†Å ‰∏ãËΩΩ2.2.0ÁâàÊú¨Âπ∂Ëß£ÂéãÁº© 12$ tar -xzf kafka_2.12-2.2.0.tgz$ cd kafka_2.12-2.2.0 Step 2: ÂêØÂä®ÊúçÂä° ËøêË°åkafkaÈúÄË¶Å‰ΩøÁî®ZookeeperÔºåÊâÄ‰ª•‰Ω†ÈúÄË¶ÅÂÖàÂêØÂä®ZookeeperÔºåÂ¶ÇÊûú‰Ω†Ê≤°ÊúâZookeeperÔºå‰Ω†ÂèØ‰ª•‰ΩøÁî®kafkaËá™Â∏¶ÊâìÂåÖÂíåÈÖçÁΩÆÂ•ΩÁöÑZookeeper„ÄÇ1$ bin/zookeeper-server-start.sh config/zookeeper.properties Áé∞Âú®ÂêØÂä®kafkaÊúçÂä°1$ nohup bin/kafka-server-start.sh config/server.properties &amp; ÂÖ•Èó® ‰∏ªË¶Å‰ªãÁªçÂèëÈÄÅKafkaÊ∂àÊÅØÔºåÊ∂àË¥πkafkaÊ∂àÊÅØÁ≠âÁÆÄÂçïÁ§∫‰æã‰ª£Á†ÅÔºå‰ª•Âèä‰ΩøÁî®ËøáÁ®ã‰∏≠ÈÅáÂà∞ÁöÑÈóÆÈ¢òÂíåËß£ÂÜ≥ÊñπÊ°à ÂèëÈÄÅkafkaÊ∂àÊÅØÁ§∫‰æã‰ª£Á†Å123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960package com.ohaotian.datatransmission.core.writer.kafka;import com.alibaba.fastjson.JSONObject;import lombok.extern.log4j.Log4j2;import org.apache.kafka.clients.producer.Callback;import org.apache.kafka.clients.producer.KafkaProducer;import org.apache.kafka.clients.producer.Producer;import org.apache.kafka.clients.producer.ProducerRecord;import org.apache.kafka.clients.producer.RecordMetadata;import java.util.Properties;/** * @Author: feifz * @Date: 2019-05-31 14:58 * @Version: 1.0 * @Description: kafka ÂèëÈÄÅÊ∂àÊÅØÁ§∫‰æã */@Log4j2public class KafkaProducerDemo &#123; public static void main(String[] args) &#123; String brokeList = "127.0.0.1:9092"; String topic = "testTopic"; String key = "testKey"; String message = "this is a test kafka message!"; Producer&lt;String, String&gt; producer = initProducer(brokeList); producer.send(new ProducerRecord&lt;&gt;(topic, key, JSONObject.toJSONString(message)), new Callback() &#123; @Override public void onCompletion(RecordMetadata recordMetadata, Exception e) &#123; if (e == null) &#123; log.info("## ÂèëÈÄÅÊ∂àÊÅØÊàêÂäü-&gt;&#123;&#125;", JSONObject.toJSONString(message)); &#125; else &#123; log.error("## ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•-&gt;&#123;&#125;", e.getMessage()); &#125; &#125; &#125;); producer.close(); &#125; /** * ÂàùÂßãÂåñproducer * @param brokeList * @return */ private static Producer&lt;String, String&gt; initProducer(String brokeList) &#123; Properties props = new Properties(); props.put("bootstrap.servers", brokeList); props.put("acks", "all"); props.put("retries", 0); props.put("batch.size", 16384); props.put("linger.ms", 1); props.put("buffer.memory", 33554432L); props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer"); props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer"); Producer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props); return producer; &#125;&#125; ÁõëÊéß ÂèÇËÄÉÔºöhttps://www.orchome.com/55 Kafka ManagerÁÆÄ‰ªã‰∏∫‰∫ÜÁÆÄÂåñÂºÄÂèëËÄÖÂíåÊúçÂä°Â∑•Á®ãÂ∏àÁª¥Êä§KafkaÈõÜÁæ§ÁöÑÂ∑•‰ΩúÔºåÊûÑÂª∫‰∫Ü‰∏Ä‰∏™Âè´ÂÅöKafkaÁÆ°ÁêÜÂô®ÁöÑÂü∫‰∫éWebÂ∑•ÂÖ∑ÔºåÂè´ÂÅö Kafka Manager„ÄÇËøô‰∏™ÁÆ°ÁêÜÂ∑•ÂÖ∑ÂèØ‰ª•ÂæàÂÆπÊòìÂú∞ÂèëÁé∞ÂàÜÂ∏ÉÂú®ÈõÜÁæ§‰∏≠ÁöÑÂì™‰∫õtopicÂàÜÂ∏É‰∏çÂùáÂåÄÔºåÊàñËÄÖÊòØÂàÜÂå∫Âú®Êï¥‰∏™ÈõÜÁæ§ÂàÜÂ∏É‰∏çÂùáÂåÄÁöÑÁöÑÊÉÖÂÜµ„ÄÇÂÆÉÊîØÊåÅÁÆ°ÁêÜÂ§ö‰∏™ÈõÜÁæ§„ÄÅÈÄâÊã©ÂâØÊú¨„ÄÅÂâØÊú¨ÈáçÊñ∞ÂàÜÈÖç‰ª•ÂèäÂàõÂª∫Topic„ÄÇÂêåÊó∂ÔºåËøô‰∏™ÁÆ°ÁêÜÂ∑•ÂÖ∑‰πüÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Â•ΩÁöÑÂèØ‰ª•Âø´ÈÄüÊµèËßàËøô‰∏™ÈõÜÁæ§ÁöÑÂ∑•ÂÖ∑„ÄÇ ËØ•ËΩØ‰ª∂ÊòØÁî®ScalaËØ≠Ë®ÄÁºñÂÜôÁöÑ„ÄÇÁõÆÂâç(2015Âπ¥02Êúà03Êó•)ÈõÖËôéÂ∑≤ÁªèÂºÄÊ∫ê‰∫ÜKafka ManagerÂ∑•ÂÖ∑„ÄÇËøôÊ¨æKafkaÈõÜÁæ§ÁÆ°ÁêÜÂ∑•ÂÖ∑‰∏ªË¶ÅÊîØÊåÅ‰ª•‰∏ãÂá†‰∏™ÂäüËÉΩÔºö ÁÆ°ÁêÜÂá†‰∏™‰∏çÂêåÁöÑÈõÜÁæ§ÔºõÂæàÂÆπÊòìÂú∞Ê£ÄÊü•ÈõÜÁæ§ÁöÑÁä∂ÊÄÅ(topics, brokers, ÂâØÊú¨ÁöÑÂàÜÂ∏É, ÂàÜÂå∫ÁöÑÂàÜÂ∏É)ÔºõÈÄâÊã©ÂâØÊú¨Ôºõ‰∫ßÁîüÂàÜÂå∫ÂàÜÈÖç(Generate partition assignments)Âü∫‰∫éÈõÜÁæ§ÁöÑÂΩìÂâçÁä∂ÊÄÅÔºõÈáçÊñ∞ÂàÜÈÖçÂàÜÂå∫„ÄÇ ÂÆâË£ÖË¶ÅÊ±ÇKafka 0.8.. or 0.9.. or 0.10.. or 0.11..Java 8+sbt 0.13.x ÈÖçÁΩÆÁ≥ªÁªüËá≥Â∞ëÈúÄË¶ÅÈÖçÁΩÆzookeeperÈõÜÁæ§ÁöÑÂú∞ÂùÄÔºåÂèØ‰ª•Âú®kafka-managerÂÆâË£ÖÂåÖÁöÑconfÁõÆÂΩï‰∏ãÈù¢ÁöÑapplication.confÊñá‰ª∂‰∏≠ËøõË°åÈÖçÁΩÆ„ÄÇ‰æãÂ¶ÇÔºö1kafka-manager.zkhosts="my.zookeeper.host.com:2181" ‰Ω†ÂèØ‰ª•ÊåáÂÆöÂ§ö‰∏™zookeeperÂú∞ÂùÄÔºåÁî®ÈÄóÂè∑ÂàÜÈöîÔºö1kafka-manager.zkhosts="my.zookeeper.host.com:2181,other.zookeeper.host.com:2181" Âè¶Â§ñ, Â¶ÇÊûú‰Ω†‰∏çÊÉ≥Á°¨ÁºñÁ†ÅÔºåÂèØ‰ª•‰ΩøÁî®ÁéØÂ¢ÉÂèòÈáèZK_HOSTS„ÄÇ1kafka-ZK_HOSTS="my.zookeeper.host.com:2181" ‰Ω†ÂèØ‰ª•ÂêØÁî®/Á¶ÅÊ≠¢‰ª•‰∏ãÁöÑÂäüËÉΩÔºåÈÄöËøá‰øÆÊîπapplication.config:1application.features=["KMClusterManagerFeature","KMTopicManagerFeature","KMPreferredReplicaElectionFeature","KMReassignPartitionsFeature"] KMClusterManagerFeature - ÂÖÅËÆ∏‰ªéKafka ManagerÊ∑ªÂä†ÔºåÊõ¥Êñ∞ÔºåÂà†Èô§ÈõÜÁæ§„ÄÇKMTopicManagerFeature - ÂÖÅËÆ∏‰ªéKafkaÈõÜÁæ§‰∏≠Â¢ûÂä†ÔºåÊõ¥Êñ∞ÔºåÂà†Èô§topicKMPreferredReplicaElectionFeature - ÂÖÅËÆ∏‰∏∫KafkaÈõÜÁæ§ËøêË°åÈ¶ñÈÄâÂâØÊú¨KMReassignPartitionsFeature - ÂÖÅËÆ∏ÁîüÊàêÂàÜÂå∫ÂàÜÈÖçÂíåÈáçÊñ∞ÂàÜÈÖçÂàÜÂå∫ËÄÉËôë‰∏∫ÂêØÁî®‰∫ÜjmxÁöÑÂ§ßÁæ§ÈõÜËÆæÁΩÆËøô‰∫õÂèÇÊï∞Ôºö kafka-manager.broker-view-thread-pool-size=&lt; 3 * number_of_brokers&gt; kafka-manager.broker-view-max-queue-size=&lt; 3 * total # of partitions across all topics&gt; kafka-manager.broker-view-update-seconds=&lt; kafka-manager.broker-view-max-queue-size / (10 * number_of_brokers) &gt;‰∏ãÈù¢ÊòØ‰∏Ä‰∏™ÂåÖÂê´10‰∏™brokerÔºå100‰∏™topicÁöÑkafkaÈõÜÁæ§Á§∫‰æãÔºåÊØè‰∏™topicÊúâ10‰∏™ÂàÜÂå∫ÔºåÁõ∏ÂΩì‰∫é1000‰∏™ÊÄªÂàÜÂå∫ÔºåÂπ∂ÂêØÁî®JMXÔºö kafka-manager.broker-view-thread-pool-size=30 kafka-manager.broker-view-max-queue-size=3000 kafka-manager.broker-view-update-seconds=30ÊéßÂà∂Ê∂àË¥πËÄÖÂÅèoffsetÁºìÂ≠òÁöÑÁ∫øÁ®ãÊ±†ÂíåÈòüÂàóÔºö kafka-manager.offset-cache-thread-pool-size=&lt; default is # of processors&gt; kafka-manager.offset-cache-max-queue-size=&lt; default is 1000&gt; kafka-manager.kafka-admin-client-thread-pool-size=&lt; default is # of processors&gt; kafka-manager.kafka-admin-client-max-queue-size=&lt; default is 1000&gt;ÊÇ®Â∫îËØ•Âú®ÂêØÁî®‰∫ÜÊ∂àË¥πËÄÖËΩÆËØ¢ÁöÑÊÉÖÂÜµ‰∏ã‰∏∫Â§ßÈáè#Ê∂àË¥πËÄÖÂ¢ûÂä†‰ª•‰∏äÂÜÖÂÆπ„ÄÇËôΩÁÑ∂ÂÆÉ‰∏ªË¶ÅÂΩ±ÂìçÂü∫‰∫éZKÁöÑÊ∂àË¥πËÄÖËΩÆËØ¢„ÄÇ KafkaÁÆ°ÁêÜÁöÑÊ∂àË¥πËÄÖoffsetÁé∞Âú®Áî±‚Äú__consumer_offsets‚Äùtopic‰∏≠ÁöÑKafkaManagedOffsetCacheÊ∂àË¥π„ÄÇËØ∑Ê≥®ÊÑèÔºåËøôÂ∞öÊú™ÁªèËøáË∑üË∏™Â§ßÈáèoffsetÁöÑÊµãËØï„ÄÇÊØè‰∏™ÈõÜÁæ§ÈÉΩÊúâ‰∏Ä‰∏™ÂçïÁã¨ÁöÑÁ∫øÁ®ãÊ∂àË¥πËøô‰∏™topicÔºåÊâÄ‰ª•ÂÆÉÂèØËÉΩÊó†Ê≥ïË∑ü‰∏äË¢´Êé®ÈÄÅÂà∞topicÁöÑÂ§ßÈáèoffset„ÄÇ ÈÉ®ÁΩ≤‰∏ãÈù¢ÁöÑÂëΩ‰ª§ÂàõÂª∫‰∏Ä‰∏™ÂèØÈÉ®ÁΩ≤Â∫îÁî®ÁöÑzipÊñá‰ª∂„ÄÇ1sbt clean dist Â¶ÇÊûú‰Ω†‰∏çÊÉ≥ÊãâÊ∫êÁ†ÅÔºåÂú®ÁºñËØëÔºåÊàëÂ∑≤ÁªèÁºñËØëÂ•ΩÔºåÊîæÂú®ÁôæÂ∫¶‰∫ëÁõò‰∏ä‰∫Ü„ÄÇ ÈìæÊé•:https://pan.baidu.com/s/1AWQihB3CkF0g2Ao7lizTWw ÂØÜÁ†Å:82eq ÂêØÂä®ÊúçÂä°Ëß£ÂéãÂàöÂàöÁöÑzipÊñá‰ª∂,ÁÑ∂ÂêéÂêØÂä®ÂÆÉ:1$ bin/kafka-manager ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÁ´ØÂè£‰∏∫9000„ÄÇÂèØË¶ÜÁõñÔºå‰æãÂ¶ÇÔºö1$ bin/kafka-manager -Dconfig.file=/path/to/application.conf -Dhttp.port=8080 ÂÜçÂ¶ÇÊûújava‰∏çÂú®‰Ω†ÁöÑË∑ØÂæÑ‰∏≠ÔºåÊàñ‰Ω†ÈúÄË¶ÅÈíàÂØπ‰∏çÂêåÁöÑÁâàÊú¨ÔºåÂ¢ûÂä†-java-homeÈÄâÈ°πÔºö1$ bin/kafka-manager -java-home /usr/local/oracle-java-8 Áî®ÂÆâÂÖ®ÂêØÂä®ÊúçÂä°‰∏∫SASLÊ∑ªÂä†JAASÈÖçÁΩÆÔºåÊ∑ªÂä†ÈÖçÁΩÆÊñá‰ª∂‰ΩçÁΩÆÔºö1$ bin/kafka-manager -Djava.security.auth.login.config=/path/to/my-jaas.conf Ê≥®ÊÑèÔºöÁ°Æ‰øùËøêË°åkafka managerÁöÑÁî®Êà∑ÊúâËØªÂèñjaasÈÖçÁΩÆÊñá‰ª∂ÁöÑÊùÉÈôê„ÄÇ ÊâìÂåÖÂ¶ÇÊûú‰Ω†ÊÉ≥ÂàõÂª∫‰∏Ä‰∏™DebianÊàñËÄÖRPMÂåÖÔºå‰Ω†ÂèØ‰ª•‰ΩøÁî®‰∏ãÈù¢ÂëΩ‰ª§ÊâìÂåÖÔºö12sbt debian:packageBinsbt rpm:packageBin Â∏∏ËßÅÈóÆÈ¢ò1. Â¶Ç‰ΩïÂÆûÁé∞ÊâπÈáèÂèëÈÄÅKafkaÊ∂àÊÅØÔºüÁîü‰∫ßËÄÖÂèëÈÄÅÂ§ö‰∏™Ê∂àÊÅØÂà∞Âêå‰∏Ä‰∏™ÂàÜÂå∫ÁöÑÊó∂ÂÄôÔºå‰∏∫‰∫ÜÂáèÂ∞ëÁΩëÁªúÂ∏¶Êù•ÁöÑÁ≥ªËÉΩÂºÄÈîÄÔºåkafka‰ºöÂØπÊ∂àÊÅØËøõË°åÊâπÈáèÂèëÈÄÅ„ÄÇbatch.sizeÈÄöËøáËøô‰∏™ÂèÇÊï∞Êù•ËÆæÁΩÆÊâπÈáèÊèê‰∫§ÁöÑÊï∞ÊçÆÂ§ßÂ∞èÔºåÈªòËÆ§ÊòØ16k,ÂΩìÁßØÂéãÁöÑÊ∂àÊÅØËææÂà∞Ëøô‰∏™ÂÄºÁöÑÊó∂ÂÄôÂ∞±‰ºöÁªü‰∏ÄÂèëÈÄÅÔºàÂèëÂæÄÂêå‰∏ÄÂàÜÂå∫ÁöÑÊ∂àÊÅØÔºâlinger.msËøô‰∏™ËÆæÁΩÆÊòØ‰∏∫ÂèëÈÄÅËÆæÁΩÆ‰∏ÄÂÆöÊòØÂª∂ËøüÊù•Êî∂ÈõÜÊõ¥Â§öÁöÑÊ∂àÊÅØÔºåÈªòËÆ§Â§ßÂ∞èÊòØ0msÔºàÂ∞±ÊòØÊúâÊ∂àÊÅØÂ∞±Á´ãÂç≥ÂèëÈÄÅÔºâÂΩìËøô‰∏§‰∏™ÂèÇÊï∞ÂêåÊó∂ËÆæÁΩÆÁöÑÊó∂ÂÄôÔºåÂè™Ë¶Å‰∏§‰∏™Êù°‰ª∂‰∏≠Êª°Ë∂≥‰∏Ä‰∏™Â∞±‰ºöÂèëÈÄÅ„ÄÇÊØîÂ¶ÇËØ¥batch.sizeËÆæÁΩÆ16kbÔºålinger.msËÆæÁΩÆ50msÔºåÈÇ£‰πàÂΩìÊ∂àÊÅØÁßØÂéãËææÂà∞16kbÂ∞±‰ºöÂèëÈÄÅÔºåÂ¶ÇÊûúÊ≤°ÊúâÂà∞Ëææ16kbÔºåÈÇ£‰πàÂú®Á¨¨‰∏Ä‰∏™Ê∂àÊÅØÂà∞Êù•‰πãÂêéÁöÑ50ms‰πãÂêéÊ∂àÊÅØÂ∞Ü‰ºöÂèëÈÄÅ„ÄÇ 2. KafkaÂ¶Ç‰Ωï‰øùËØÅÊ∂àÊÅØÁöÑÂèØÈù†ÊÄß‰º†ËæìÔºüËøôÂùóÊØîËæÉÂ∏∏ËßÅÁöÑ‰∏Ä‰∏™Âú∫ÊôØÔºåÂ∞±ÊòØKafkaÊüê‰∏™brokerÂÆïÊú∫ÔºåÁÑ∂ÂêéÈáçÊñ∞ÈÄâ‰∏æpartition ÁöÑleader„ÄÇÂ§ßÂÆ∂ÊÉ≥ÊÉ≥ÔºåË¶ÅÊòØÊ≠§Êó∂ÂÖ∂‰ªñÁöÑfollowerÂàöÂ•ΩËøòÊúâ‰∫õÊï∞ÊçÆÊ≤°ÊúâÂêåÊ≠•ÔºåÁªìÊûúÊ≠§Êó∂leader ÊåÇ‰∫ÜÔºåÁÑ∂ÂêéÈÄâ‰∏æÊüê‰∏™followerÊàêleader‰πãÂêéÔºå‰∏çÂ∞±Â∞ë‰∫Ü‰∏Ä‰∫õÊï∞ÊçÆÔºüËøôÂ∞±‰∏¢‰∫Ü‰∏Ä‰∫õÊï∞ÊçÆÂïä„ÄÇÁîü‰∫ßÁéØÂ¢É‰πüÈÅáÂà∞ËøáÔºåÊàë‰ª¨‰πüÊòØÔºå‰πãÂâç Kafka ÁöÑ leader Êú∫Âô®ÂÆïÊú∫‰∫ÜÔºåÂ∞ÜfollowerÂàáÊç¢‰∏∫ leader ‰πãÂêéÔºåÂ∞±‰ºöÂèëÁé∞ËØ¥Ëøô‰∏™Êï∞ÊçÆÂ∞±‰∏¢‰∫Ü„ÄÇÊâÄ‰ª•Ê≠§Êó∂‰∏ÄËà¨ÊòØË¶ÅÊ±ÇËµ∑Á†ÅËÆæÁΩÆÂ¶Ç‰∏ã 4 ‰∏™ÂèÇÊï∞ÔºöÁªôtopicËÆæÁΩÆreplication.factorÂèÇÊï∞ÔºöËøô‰∏™ÂÄºÂøÖÈ°ªÂ§ß‰∫é1ÔºåË¶ÅÊ±ÇÊØè‰∏™ partitionÂøÖÈ°ªÊúâËá≥Â∞ë2‰∏™ÂâØÊú¨„ÄÇÂú®KafkaÊúçÂä°Á´ØËÆæÁΩÆ min.insync.replicas ÂèÇÊï∞ÔºöËøô‰∏™ÂÄºÂøÖÈ°ªÂ§ß‰∫é 1ÔºåËøô‰∏™ÊòØË¶ÅÊ±Ç‰∏Ä‰∏™leaderËá≥Â∞ëÊÑüÁü•Âà∞ÊúâËá≥Â∞ë‰∏Ä‰∏™followerËøòË∑üËá™Â∑±‰øùÊåÅËÅîÁ≥ªÔºåÊ≤°ÊéâÈòüÔºåËøôÊ†∑ÊâçËÉΩÁ°Æ‰øùleaderÊåÇ‰∫ÜËøòÊúâ‰∏Ä‰∏™followerÂêß„ÄÇÂú®producerÁ´ØËÆæÁΩÆ acks=allÔºöËøô‰∏™ÊòØË¶ÅÊ±ÇÊØèÊù°Êï∞ÊçÆÔºåÂøÖÈ°ªÊòØÂÜôÂÖ•ÊâÄÊúâreplica ‰πãÂêéÔºåÊâçËÉΩËÆ§‰∏∫ÊòØÂÜôÊàêÂäü‰∫Ü„ÄÇÂú® producer Á´ØËÆæÁΩÆ retries=MAXÔºàÂæàÂ§ßÂæàÂ§ßÂæàÂ§ßÁöÑ‰∏Ä‰∏™ÂÄºÔºåÊó†ÈôêÊ¨°ÈáçËØïÁöÑÊÑèÊÄùÔºâÔºöËøô‰∏™ÊòØË¶ÅÊ±Ç‰∏ÄÊó¶ÂÜôÂÖ•Â§±Ë¥•ÔºåÂ∞±Êó†ÈôêÈáçËØïÔºåÂç°Âú®ËøôÈáå‰∫Ü„ÄÇÊàë‰ª¨Áîü‰∫ßÁéØÂ¢ÉÂ∞±ÊòØÊåâÁÖß‰∏äËø∞Ë¶ÅÊ±ÇÈÖçÁΩÆÁöÑÔºåËøôÊ†∑ÈÖçÁΩÆ‰πãÂêéÔºåËá≥Â∞ëÂú®Kafka brokerÁ´ØÂ∞±ÂèØ‰ª•‰øùËØÅÂú®leaderÊâÄÂú®brokerÂèëÁîüÊïÖÈöúÔºåËøõË°åleaderÂàáÊç¢Êó∂ÔºåÊï∞ÊçÆ‰∏ç‰ºö‰∏¢Â§±„ÄÇÁîü‰∫ßËÄÖ‰ºö‰∏ç‰ºöÂºÑ‰∏¢Êï∞ÊçÆÔºüÂ¶ÇÊûúÊåâÁÖß‰∏äËø∞ÁöÑÊÄùË∑ØËÆæÁΩÆ‰∫Üacks=allÔºå‰∏ÄÂÆö‰∏ç‰ºö‰∏¢ÔºåË¶ÅÊ±ÇÊòØÔºå‰Ω†ÁöÑleaderÊé•Êî∂Âà∞Ê∂àÊÅØÔºåÊâÄÊúâÁöÑfollowerÈÉΩÂêåÊ≠•Âà∞‰∫ÜÊ∂àÊÅØ‰πãÂêéÔºåÊâçËÆ§‰∏∫Êú¨Ê¨°ÂÜôÊàêÂäü‰∫Ü„ÄÇÂ¶ÇÊûúÊ≤°Êª°Ë∂≥Ëøô‰∏™Êù°‰ª∂ÔºåÁîü‰∫ßËÄÖ‰ºöËá™Âä®‰∏çÊñ≠ÁöÑÈáçËØïÔºåÈáçËØïÊó†ÈôêÊ¨°„ÄÇ]]></content>
      <categories>
        <category>ÁªÑ‰ª∂</category>
      </categories>
      <tags>
        <tag>Kafka</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ElasticSearchÂÆâË£Ö‰∏éÂÖ•Èó®]]></title>
    <url>%2F2019%2F05%2F31%2FElasticSearch%E5%AE%89%E8%A3%85%E4%B8%8E%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[‰ªãÁªç ElasticSearchÊòØ‰∏Ä‰∏™Âü∫‰∫éLuceneÁöÑÊêúÁ¥¢ÊúçÂä°Âô®„ÄÇÂÆÉÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÂ§öÁî®Êà∑ËÉΩÂäõÁöÑÂÖ®ÊñáÊêúÁ¥¢ÂºïÊìéÔºåÂü∫‰∫éRESTful webÊé•Âè£„ÄÇElasticsearchÊòØÁî®JavaÂºÄÂèëÁöÑÔºåÂπ∂‰Ωú‰∏∫ApacheËÆ∏ÂèØÊù°Ê¨æ‰∏ãÁöÑÂºÄÊîæÊ∫êÁ†ÅÂèëÂ∏ÉÔºåÊòØÂΩìÂâçÊµÅË°åÁöÑ‰ºÅ‰∏öÁ∫ßÊêúÁ¥¢ÂºïÊìé„ÄÇËÆæËÆ°Áî®‰∫é‰∫ëËÆ°ÁÆó‰∏≠ÔºåËÉΩÂ§üËææÂà∞ÂÆûÊó∂ÊêúÁ¥¢ÔºåÁ®≥ÂÆöÔºåÂèØÈù†ÔºåÂø´ÈÄüÔºåÂÆâË£Ö‰ΩøÁî®Êñπ‰æø„ÄÇ ÂÆâË£ÖElasticSearchÂÆâË£Ö ËøõÂÖ•ÂÆòÁΩë‰∏ãËΩΩÈ°µÈÄâÊã©ÊÉ≥Ë¶ÅÂÆâË£ÖÁöÑÁâàÊú¨‰∏ãËΩΩÔºöhttps://www.elastic.co/downloads/past-releases Ëß£ÂéãÁº©Ëá≥Êú¨Âú∞ÊüêÂú∞ÂùÄ cd bin ÊâßË°åÂëΩ‰ª§:./elasticsearch ÂêØÂä®ÊàêÂäü ElasticSearch-headÊèí‰ª∂ÂÆâË£Ö ÔºàÂèÇËÄÉÔºöhttps://blog.csdn.net/mingleizhen/article/details/76084874Ôºâ ‰æùËµñÁéØÂ¢ÉÔºönodeÂíånpm git clone https://github.com/mobz/elasticsearch-head.git npm install npm run start ‰øÆÊîπElasticSearchÈÖçÁΩÆ Âú®elasticsearch.ymlÊ∑ªÂä†Â¶Ç‰∏ãÈÖçÁΩÆ http.cors.enabled: true http.cors.allow-origin: ‚Äú* ÈáçÂêØES È°µÈù¢ËÆøÈóÆÔºöhttp://localhost:9100/ ÂêØÂä®ÂÆåÊàê È™åËØÅ ËÆøÈóÆÔºöhttp://localhost:9100/]]></content>
      <categories>
        <category>ÁªÑ‰ª∂</category>
      </categories>
      <tags>
        <tag>Elastic S e a r ch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaÂπ∂Âèë-Á∫øÁ®ãÊ±†ÁöÑ‰ΩøÁî®]]></title>
    <url>%2F2019%2F05%2F29%2FJava%E5%B9%B6%E5%8F%91-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[ËØ¥Êòé ÂèÇËÄÉÔºöhttps://www.cnblogs.com/dolphin0520/p/3932921.html Â¶ÇÊûúÂπ∂ÂèëÁöÑÁ∫øÁ®ãÊï∞ÈáèÂæàÂ§öÔºåÂπ∂‰∏îÊØè‰∏™Á∫øÁ®ãÈÉΩÊòØÊâßË°å‰∏Ä‰∏™Êó∂Èó¥ÂæàÁü≠ÁöÑ‰ªªÂä°Â∞±ÁªìÊùü‰∫ÜÔºåÂõ†‰∏∫È¢ëÁπÅÂàõÂª∫Á∫øÁ®ãÂíåÈîÄÊØÅÁ∫øÁ®ãÈúÄË¶ÅÊó∂Èó¥ÔºåËøôÊ†∑È¢ëÁπÅÂàõÂª∫Á∫øÁ®ãÂ∞±‰ºöÂ§ßÂ§ßÈôç‰ΩéÁ≥ªÁªüÁöÑÊïàÁéá„ÄÇ ÈÇ£‰πàÊúâÊ≤°Êúâ‰∏ÄÁßçÂäûÊ≥ï‰ΩøÂæóÁ∫øÁ®ãÂèØ‰ª•Â§çÁî®ÔºåÂ∞±ÊòØÊâßË°åÂÆå‰∏Ä‰∏™‰ªªÂä°ÔºåÂπ∂‰∏çË¢´ÈîÄÊØÅÔºåËÄåÊòØÂèØ‰ª•ÁªßÁª≠ÊâßË°åÂÖ∂‰ªñÁöÑ‰ªªÂä°Ôºü Âú®Java‰∏≠ÂèØ‰ª•ÈÄöËøáÁ∫øÁ®ãÊ±†Êù•ËææÂà∞ËøôÊ†∑ÁöÑÊïàÊûú„ÄÇ‰ªäÂ§©Êàë‰ª¨Â∞±Êù•ËØ¶ÁªÜËÆ≤Ëß£‰∏Ä‰∏ãJavaÁöÑÁ∫øÁ®ãÊ±†ÔºåÈ¶ñÂÖàÊàë‰ª¨‰ªéÊúÄÊ†∏ÂøÉÁöÑThreadPoolExecutorÁ±ª‰∏≠ÁöÑÊñπÊ≥ïËÆ≤Ëµ∑ÔºåÁÑ∂ÂêéÂÜçËÆ≤Ëø∞ÂÆÉÁöÑÂÆûÁé∞ÂéüÁêÜÔºåÊé•ÁùÄÁªôÂá∫‰∫ÜÂÆÉÁöÑ‰ΩøÁî®Á§∫‰æãÔºåÊúÄÂêéËÆ®ËÆ∫‰∫Ü‰∏Ä‰∏ãÂ¶Ç‰ΩïÂêàÁêÜÈÖçÁΩÆÁ∫øÁ®ãÊ±†ÁöÑÂ§ßÂ∞è„ÄÇ Java‰∏≠ÁöÑThreadPoolExecutorÁ±ª java.uitl.concurrent.ThreadPoolExecutorÁ±ªÊòØÁ∫øÁ®ãÊ±†‰∏≠ÊúÄÊ†∏ÂøÉÁöÑ‰∏Ä‰∏™Á±ªÔºåÂõ†Ê≠§Â¶ÇÊûúË¶ÅÈÄèÂΩªÂú∞‰∫ÜËß£Java‰∏≠ÁöÑÁ∫øÁ®ãÊ±†ÔºåÂøÖÈ°ªÂÖà‰∫ÜËß£Ëøô‰∏™Á±ª„ÄÇ‰∏ãÈù¢Êàë‰ª¨Êù•Áúã‰∏Ä‰∏ãThreadPoolExecutorÁ±ªÁöÑÂÖ∑‰ΩìÂÆûÁé∞Ê∫êÁ†Å„ÄÇ Âú®ThreadPoolExecutorÁ±ª‰∏≠Êèê‰æõ‰∫ÜÂõõ‰∏™ÊûÑÈÄ†ÊñπÊ≥ïÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152// Public constructors and methods public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue) &#123; this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, Executors.defaultThreadFactory(), defaultHandler); &#125; public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory) &#123; this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, threadFactory, defaultHandler); &#125; public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, RejectedExecutionHandler handler) &#123; this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, Executors.defaultThreadFactory(), handler); &#125; public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler) &#123; if (corePoolSize &lt; 0 || maximumPoolSize &lt;= 0 || maximumPoolSize &lt; corePoolSize || keepAliveTime &lt; 0) throw new IllegalArgumentException(); if (workQueue == null || threadFactory == null || handler == null) throw new NullPointerException(); this.acc = System.getSecurityManager() == null ? null : AccessController.getContext(); this.corePoolSize = corePoolSize; this.maximumPoolSize = maximumPoolSize; this.workQueue = workQueue; this.keepAliveTime = unit.toNanos(keepAliveTime); this.threadFactory = threadFactory; this.handler = handler; &#125; ‰ªé‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂèØ‰ª•ÂæóÁü•ÔºåThreadPoolExecutorÁªßÊâø‰∫ÜAbstractExecutorServiceÁ±ªÔºåÂπ∂Êèê‰æõ‰∫ÜÂõõ‰∏™ÊûÑÈÄ†Âô®Ôºå‰∫ãÂÆû‰∏äÔºåÈÄöËøáËßÇÂØüÊØè‰∏™ÊûÑÈÄ†Âô®ÁöÑÊ∫êÁ†ÅÂÖ∑‰ΩìÂÆûÁé∞ÔºåÂèëÁé∞ÂâçÈù¢‰∏â‰∏™ÊûÑÈÄ†Âô®ÈÉΩÊòØË∞ÉÁî®ÁöÑÁ¨¨Âõõ‰∏™ÊûÑÈÄ†Âô®ËøõË°åÁöÑÂàùÂßãÂåñÂ∑•‰Ωú„ÄÇ ‰∏ãÈù¢Ëß£Èáä‰∏ã‰∏Ä‰∏ãÊûÑÈÄ†Âô®‰∏≠ÂêÑ‰∏™ÂèÇÊï∞ÁöÑÂê´‰πâÔºö corePoolSizeÔºöÊ†∏ÂøÉÊ±†ÁöÑÂ§ßÂ∞èÔºåËøô‰∏™ÂèÇÊï∞Ë∑üÂêéÈù¢ËÆ≤Ëø∞ÁöÑÁ∫øÁ®ãÊ±†ÁöÑÂÆûÁé∞ÂéüÁêÜÊúâÈùûÂ∏∏Â§ßÁöÑÂÖ≥Á≥ª„ÄÇÂú®ÂàõÂª∫‰∫ÜÁ∫øÁ®ãÊ±†ÂêéÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÁ∫øÁ®ãÊ±†‰∏≠Âπ∂Ê≤°Êúâ‰ªª‰ΩïÁ∫øÁ®ãÔºåËÄåÊòØÁ≠âÂæÖÊúâ‰ªªÂä°Âà∞Êù•ÊâçÂàõÂª∫Á∫øÁ®ãÂéªÊâßË°å‰ªªÂä°ÔºåÈô§ÈùûË∞ÉÁî®‰∫ÜprestartAllCoreThreads()ÊàñËÄÖprestartCoreThread()ÊñπÊ≥ïÔºå‰ªéËøô2‰∏™ÊñπÊ≥ïÁöÑÂêçÂ≠óÂ∞±ÂèØ‰ª•ÁúãÂá∫ÔºåÊòØÈ¢ÑÂàõÂª∫Á∫øÁ®ãÁöÑÊÑèÊÄùÔºåÂç≥Âú®Ê≤°Êúâ‰ªªÂä°Âà∞Êù•‰πãÂâçÂ∞±ÂàõÂª∫corePoolSize‰∏™Á∫øÁ®ãÊàñËÄÖ‰∏Ä‰∏™Á∫øÁ®ã„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂú®ÂàõÂª∫‰∫ÜÁ∫øÁ®ãÊ±†ÂêéÔºåÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞‰∏∫0ÔºåÂΩìÊúâ‰ªªÂä°Êù•‰πãÂêéÔºåÂ∞±‰ºöÂàõÂª∫‰∏Ä‰∏™Á∫øÁ®ãÂéªÊâßË°å‰ªªÂä°ÔºåÂΩìÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÁõÆËææÂà∞corePoolSizeÂêéÔºåÂ∞±‰ºöÊääÂà∞ËææÁöÑ‰ªªÂä°ÊîæÂà∞ÁºìÂ≠òÈòüÂàóÂΩì‰∏≠Ôºõ maximumPoolSizeÔºöÁ∫øÁ®ãÊ±†ÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÔºåËøô‰∏™ÂèÇÊï∞‰πüÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÈáçË¶ÅÁöÑÂèÇÊï∞ÔºåÂÆÉË°®Á§∫Âú®Á∫øÁ®ãÊ±†‰∏≠ÊúÄÂ§öËÉΩÂàõÂª∫Â§öÂ∞ë‰∏™Á∫øÁ®ãÔºõ keepAliveTimeÔºöË°®Á§∫Á∫øÁ®ãÊ≤°Êúâ‰ªªÂä°ÊâßË°åÊó∂ÊúÄÂ§ö‰øùÊåÅÂ§ö‰πÖÊó∂Èó¥‰ºöÁªàÊ≠¢„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂè™ÊúâÂΩìÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞Â§ß‰∫écorePoolSizeÊó∂ÔºåkeepAliveTimeÊâç‰ºöËµ∑‰ΩúÁî®ÔºåÁõ¥Âà∞Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞‰∏çÂ§ß‰∫écorePoolSizeÔºåÂç≥ÂΩìÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞Â§ß‰∫écorePoolSizeÊó∂ÔºåÂ¶ÇÊûú‰∏Ä‰∏™Á∫øÁ®ãÁ©∫Èó≤ÁöÑÊó∂Èó¥ËææÂà∞keepAliveTimeÔºåÂàô‰ºöÁªàÊ≠¢ÔºåÁõ¥Âà∞Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞‰∏çË∂ÖËøácorePoolSize„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúË∞ÉÁî®‰∫ÜallowCoreThreadTimeOut(boolean)ÊñπÊ≥ïÔºåÂú®Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞‰∏çÂ§ß‰∫écorePoolSizeÊó∂ÔºåkeepAliveTimeÂèÇÊï∞‰πü‰ºöËµ∑‰ΩúÁî®ÔºåÁõ¥Âà∞Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞‰∏∫0Ôºõ unitÔºöÂèÇÊï∞keepAliveTimeÁöÑÊó∂Èó¥Âçï‰ΩçÔºåÊúâ7ÁßçÂèñÂÄºÔºåÂú®TimeUnitÁ±ª‰∏≠Êúâ7ÁßçÈùôÊÄÅÂ±ûÊÄßÔºö 1234567TimeUnit.DAYS; //Â§©TimeUnit.HOURS; //Â∞èÊó∂TimeUnit.MINUTES; //ÂàÜÈíüTimeUnit.SECONDS; //ÁßíTimeUnit.MILLISECONDS; //ÊØ´ÁßíTimeUnit.MICROSECONDS; //ÂæÆÂ¶ôTimeUnit.NANOSECONDS; //Á∫≥Áßí workQueueÔºö‰∏Ä‰∏™ÈòªÂ°ûÈòüÂàóÔºåÁî®Êù•Â≠òÂÇ®Á≠âÂæÖÊâßË°åÁöÑ‰ªªÂä°ÔºåËøô‰∏™ÂèÇÊï∞ÁöÑÈÄâÊã©‰πüÂæàÈáçË¶ÅÔºå‰ºöÂØπÁ∫øÁ®ãÊ±†ÁöÑËøêË°åËøáÁ®ã‰∫ßÁîüÈáçÂ§ßÂΩ±ÂìçÔºå‰∏ÄËà¨Êù•ËØ¥ÔºåËøôÈáåÁöÑÈòªÂ°ûÈòüÂàóÊúâ‰ª•‰∏ãÂá†ÁßçÈÄâÊã©Ôºö ArrayBlockingQueueÂíåPriorityBlockingQueue‰ΩøÁî®ËæÉÂ∞ëÔºå‰∏ÄËà¨‰ΩøÁî®LinkedBlockingQueueÂíåSynchronous„ÄÇÁ∫øÁ®ãÊ±†ÁöÑÊéíÈòüÁ≠ñÁï•‰∏éBlockingQueueÊúâÂÖ≥„ÄÇ 1234ArrayBlockingQueue;LinkedBlockingQueue;SynchronousQueue;PriorityBlockingQueue threadFactoryÔºöÁ∫øÁ®ãÂ∑•ÂéÇÔºå‰∏ªË¶ÅÁî®Êù•ÂàõÂª∫Á∫øÁ®ãÔºõ handlerÔºöË°®Á§∫ÂΩìÊãíÁªùÂ§ÑÁêÜ‰ªªÂä°Êó∂ÁöÑÁ≠ñÁï•ÔºåÊúâ‰ª•‰∏ãÂõõÁßçÂèñÂÄºÔºö 1234ThreadPoolExecutor.AbortPolicy:‰∏¢ÂºÉ‰ªªÂä°Âπ∂ÊäõÂá∫RejectedExecutionExceptionÂºÇÂ∏∏„ÄÇ ThreadPoolExecutor.DiscardPolicyÔºö‰πüÊòØ‰∏¢ÂºÉ‰ªªÂä°Ôºå‰ΩÜÊòØ‰∏çÊäõÂá∫ÂºÇÂ∏∏„ÄÇ ThreadPoolExecutor.DiscardOldestPolicyÔºö‰∏¢ÂºÉÈòüÂàóÊúÄÂâçÈù¢ÁöÑ‰ªªÂä°ÔºåÁÑ∂ÂêéÈáçÊñ∞Â∞ùËØïÊâßË°å‰ªªÂä°ÔºàÈáçÂ§çÊ≠§ËøáÁ®ãÔºâThreadPoolExecutor.CallerRunsPolicyÔºöÁî±Ë∞ÉÁî®Á∫øÁ®ãÂ§ÑÁêÜËØ•‰ªªÂä° ÂÖ∑‰ΩìÂèÇÊï∞ÁöÑÈÖçÁΩÆ‰∏éÁ∫øÁ®ãÊ±†ÁöÑÂÖ≥Á≥ªÂ∞ÜÂú®‰∏ã‰∏ÄËäÇËÆ≤Ëø∞„ÄÇ ‰ªé‰∏äÈù¢ÁªôÂá∫ÁöÑThreadPoolExecutorÁ±ªÁöÑ‰ª£Á†ÅÂèØ‰ª•Áü•ÈÅìÔºåThreadPoolExecutorÁªßÊâø‰∫ÜAbstractExecutorServiceÔºåÊàë‰ª¨Êù•Áúã‰∏Ä‰∏ãAbstractExecutorServiceÁöÑÂÆûÁé∞Ôºö 123456789101112131415161718192021222324252627public abstract class AbstractExecutorService implements ExecutorService &#123; protected &lt;T&gt; RunnableFuture&lt;T&gt; newTaskFor(Runnable runnable, T value) &#123; &#125;; protected &lt;T&gt; RunnableFuture&lt;T&gt; newTaskFor(Callable&lt;T&gt; callable) &#123; &#125;; public Future&lt;?&gt; submit(Runnable task) &#123;&#125;; public &lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result) &#123; &#125;; public &lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task) &#123; &#125;; private &lt;T&gt; T doInvokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, boolean timed, long nanos) throws InterruptedException, ExecutionException, TimeoutException &#123; &#125;; public &lt;T&gt; T invokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks) throws InterruptedException, ExecutionException &#123; &#125;; public &lt;T&gt; T invokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit) throws InterruptedException, ExecutionException, TimeoutException &#123; &#125;; public &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks) throws InterruptedException &#123; &#125;; public &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit) throws InterruptedException &#123; &#125;;&#125; AbstractExecutorServiceÊòØ‰∏Ä‰∏™ÊäΩË±°Á±ªÔºåÂÆÉÂÆûÁé∞‰∫ÜExecutorServiceÊé•Âè£„ÄÇ Êàë‰ª¨Êé•ÁùÄÁúãExecutorServiceÊé•Âè£ÁöÑÂÆûÁé∞Ôºö 12345678910111213141516171819202122public interface ExecutorService extends Executor &#123; void shutdown(); boolean isShutdown(); boolean isTerminated(); boolean awaitTermination(long timeout, TimeUnit unit) throws InterruptedException; &lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task); &lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result); Future&lt;?&gt; submit(Runnable task); &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks) throws InterruptedException; &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit) throws InterruptedException; &lt;T&gt; T invokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks) throws InterruptedException, ExecutionException; &lt;T&gt; T invokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit) throws InterruptedException, ExecutionException, TimeoutException;&#125; ËÄåExecutorServiceÂèàÊòØÁªßÊâø‰∫ÜExecutorÊé•Âè£ÔºåÊàë‰ª¨Áúã‰∏Ä‰∏ãExecutorÊé•Âè£ÁöÑÂÆûÁé∞Ôºö 123public interface Executor &#123; void execute(Runnable command);&#125; Âà∞ËøôÈáåÔºåÂ§ßÂÆ∂Â∫îËØ•ÊòéÁôΩ‰∫ÜThreadPoolExecutor„ÄÅAbstractExecutorService„ÄÅExecutorServiceÂíåExecutorÂá†‰∏™‰πãÈó¥ÁöÑÂÖ≥Á≥ª‰∫Ü„ÄÇ ExecutorÊòØ‰∏Ä‰∏™È°∂Â±ÇÊé•Âè£ÔºåÂú®ÂÆÉÈáåÈù¢Âè™Â£∞Êòé‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ïexecute(Runnable)ÔºåËøîÂõûÂÄº‰∏∫voidÔºåÂèÇÊï∞‰∏∫RunnableÁ±ªÂûãÔºå‰ªéÂ≠óÈù¢ÊÑèÊÄùÂèØ‰ª•ÁêÜËß£ÔºåÂ∞±ÊòØÁî®Êù•ÊâßË°å‰º†ËøõÂéªÁöÑ‰ªªÂä°ÁöÑÔºõ ÁÑ∂ÂêéExecutorServiceÊé•Âè£ÁªßÊâø‰∫ÜExecutorÊé•Âè£ÔºåÂπ∂Â£∞Êòé‰∫Ü‰∏Ä‰∫õÊñπÊ≥ïÔºösubmit„ÄÅinvokeAll„ÄÅinvokeAny‰ª•ÂèäshutDownÁ≠âÔºõ ÊäΩË±°Á±ªAbstractExecutorServiceÂÆûÁé∞‰∫ÜExecutorServiceÊé•Âè£ÔºåÂü∫Êú¨ÂÆûÁé∞‰∫ÜExecutorService‰∏≠Â£∞ÊòéÁöÑÊâÄÊúâÊñπÊ≥ïÔºõ ÁÑ∂ÂêéThreadPoolExecutorÁªßÊâø‰∫ÜÁ±ªAbstractExecutorService„ÄÇ Âú®ThreadPoolExecutorÁ±ª‰∏≠ÊúâÂá†‰∏™ÈùûÂ∏∏ÈáçË¶ÅÁöÑÊñπÊ≥ïÔºö 1234execute()submit()shutdown()shutdownNow() execute()ÊñπÊ≥ïÂÆûÈôÖ‰∏äÊòØExecutor‰∏≠Â£∞ÊòéÁöÑÊñπÊ≥ïÔºåÂú®ThreadPoolExecutorËøõË°å‰∫ÜÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÔºåËøô‰∏™ÊñπÊ≥ïÊòØThreadPoolExecutorÁöÑÊ†∏ÂøÉÊñπÊ≥ïÔºåÈÄöËøáËøô‰∏™ÊñπÊ≥ïÂèØ‰ª•ÂêëÁ∫øÁ®ãÊ±†Êèê‰∫§‰∏Ä‰∏™‰ªªÂä°Ôºå‰∫§Áî±Á∫øÁ®ãÊ±†ÂéªÊâßË°å„ÄÇ submit()ÊñπÊ≥ïÊòØÂú®ExecutorService‰∏≠Â£∞ÊòéÁöÑÊñπÊ≥ïÔºåÂú®AbstractExecutorServiceÂ∞±Â∑≤ÁªèÊúâ‰∫ÜÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÔºåÂú®ThreadPoolExecutor‰∏≠Âπ∂Ê≤°ÊúâÂØπÂÖ∂ËøõË°åÈáçÂÜôÔºåËøô‰∏™ÊñπÊ≥ï‰πüÊòØÁî®Êù•ÂêëÁ∫øÁ®ãÊ±†Êèê‰∫§‰ªªÂä°ÁöÑÔºå‰ΩÜÊòØÂÆÉÂíåexecute()ÊñπÊ≥ï‰∏çÂêåÔºåÂÆÉËÉΩÂ§üËøîÂõû‰ªªÂä°ÊâßË°åÁöÑÁªìÊûúÔºåÂéªÁúãsubmit()ÊñπÊ≥ïÁöÑÂÆûÁé∞Ôºå‰ºöÂèëÁé∞ÂÆÉÂÆûÈôÖ‰∏äËøòÊòØË∞ÉÁî®ÁöÑexecute()ÊñπÊ≥ïÔºåÂè™‰∏çËøáÂÆÉÂà©Áî®‰∫ÜFutureÊù•Ëé∑Âèñ‰ªªÂä°ÊâßË°åÁªìÊûúÔºàFutureÁõ∏ÂÖ≥ÂÜÖÂÆπÂ∞ÜÂú®‰∏ã‰∏ÄÁØáËÆ≤Ëø∞Ôºâ„ÄÇ shutdown()ÂíåshutdownNow()ÊòØÁî®Êù•ÂÖ≥Èó≠Á∫øÁ®ãÊ±†ÁöÑ„ÄÇ ËøòÊúâÂæàÂ§öÂÖ∂‰ªñÁöÑÊñπÊ≥ïÔºö ÊØîÂ¶ÇÔºögetQueue() „ÄÅgetPoolSize() „ÄÅgetActiveCount()„ÄÅgetCompletedTaskCount()Á≠âËé∑Âèñ‰∏éÁ∫øÁ®ãÊ±†Áõ∏ÂÖ≥Â±ûÊÄßÁöÑÊñπÊ≥ïÔºåÊúâÂÖ¥Ë∂£ÁöÑÊúãÂèãÂèØ‰ª•Ëá™Ë°åÊü•ÈòÖAPI„ÄÇ Ê∑±ÂÖ•ÂâñÊûêÁ∫øÁ®ãÊ±†ÂÆûÁé∞ÂéüÁêÜÂú®‰∏ä‰∏ÄËäÇÊàë‰ª¨‰ªéÂÆèËßÇ‰∏ä‰ªãÁªç‰∫ÜThreadPoolExecutorÔºå‰∏ãÈù¢Êàë‰ª¨Êù•Ê∑±ÂÖ•Ëß£Êûê‰∏Ä‰∏ãÁ∫øÁ®ãÊ±†ÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÂéüÁêÜÔºåÂ∞Ü‰ªé‰∏ãÈù¢Âá†‰∏™ÊñπÈù¢ËÆ≤Ëß£Ôºö 1.Á∫øÁ®ãÊ±†Áä∂ÊÄÅ 2.‰ªªÂä°ÁöÑÊâßË°å 3.Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÂàùÂßãÂåñ 4.‰ªªÂä°ÁºìÂ≠òÈòüÂàóÂèäÊéíÈòüÁ≠ñÁï• 5.‰ªªÂä°ÊãíÁªùÁ≠ñÁï• 6.Á∫øÁ®ãÊ±†ÁöÑÂÖ≥Èó≠ 7.Á∫øÁ®ãÊ±†ÂÆπÈáèÁöÑÂä®ÊÄÅË∞ÉÊï¥ 1.Á∫øÁ®ãÊ±†Áä∂ÊÄÅ Âú®ThreadPoolExecutor‰∏≠ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™volatileÂèòÈáèÔºåÂè¶Â§ñÂÆö‰πâ‰∫ÜÂá†‰∏™static finalÂèòÈáèË°®Á§∫Á∫øÁ®ãÊ±†ÁöÑÂêÑ‰∏™Áä∂ÊÄÅÔºö 12345volatile int runState;static final int RUNNING = 0;static final int SHUTDOWN = 1;static final int STOP = 2;static final int TERMINATED = 3; runStateË°®Á§∫ÂΩìÂâçÁ∫øÁ®ãÊ±†ÁöÑÁä∂ÊÄÅÔºåÂÆÉÊòØ‰∏Ä‰∏™volatileÂèòÈáèÁî®Êù•‰øùËØÅÁ∫øÁ®ã‰πãÈó¥ÁöÑÂèØËßÅÊÄßÔºõ ‰∏ãÈù¢ÁöÑÂá†‰∏™static finalÂèòÈáèË°®Á§∫runStateÂèØËÉΩÁöÑÂá†‰∏™ÂèñÂÄº„ÄÇ ÂΩìÂàõÂª∫Á∫øÁ®ãÊ±†ÂêéÔºåÂàùÂßãÊó∂ÔºåÁ∫øÁ®ãÊ±†Â§Ñ‰∫éRUNNINGÁä∂ÊÄÅÔºõ Â¶ÇÊûúË∞ÉÁî®‰∫Üshutdown()ÊñπÊ≥ïÔºåÂàôÁ∫øÁ®ãÊ±†Â§Ñ‰∫éSHUTDOWNÁä∂ÊÄÅÔºåÊ≠§Êó∂Á∫øÁ®ãÊ±†‰∏çËÉΩÂ§üÊé•ÂèóÊñ∞ÁöÑ‰ªªÂä°ÔºåÂÆÉ‰ºöÁ≠âÂæÖÊâÄÊúâ‰ªªÂä°ÊâßË°åÂÆåÊØïÔºõ Â¶ÇÊûúË∞ÉÁî®‰∫ÜshutdownNow()ÊñπÊ≥ïÔºåÂàôÁ∫øÁ®ãÊ±†Â§Ñ‰∫éSTOPÁä∂ÊÄÅÔºåÊ≠§Êó∂Á∫øÁ®ãÊ±†‰∏çËÉΩÊé•ÂèóÊñ∞ÁöÑ‰ªªÂä°ÔºåÂπ∂‰∏î‰ºöÂéªÂ∞ùËØïÁªàÊ≠¢Ê≠£Âú®ÊâßË°åÁöÑ‰ªªÂä°Ôºõ ÂΩìÁ∫øÁ®ãÊ±†Â§Ñ‰∫éSHUTDOWNÊàñSTOPÁä∂ÊÄÅÔºåÂπ∂‰∏îÊâÄÊúâÂ∑•‰ΩúÁ∫øÁ®ãÂ∑≤ÁªèÈîÄÊØÅÔºå‰ªªÂä°ÁºìÂ≠òÈòüÂàóÂ∑≤ÁªèÊ∏ÖÁ©∫ÊàñÊâßË°åÁªìÊùüÂêéÔºåÁ∫øÁ®ãÊ±†Ë¢´ËÆæÁΩÆ‰∏∫TERMINATEDÁä∂ÊÄÅ„ÄÇ 2.‰ªªÂä°ÁöÑÊâßË°å Âú®‰∫ÜËß£Â∞Ü‰ªªÂä°Êèê‰∫§ÁªôÁ∫øÁ®ãÊ±†Âà∞‰ªªÂä°ÊâßË°åÂÆåÊØïÊï¥‰∏™ËøáÁ®ã‰πãÂâçÔºåÊàë‰ª¨ÂÖàÊù•Áúã‰∏Ä‰∏ãThreadPoolExecutorÁ±ª‰∏≠ÂÖ∂‰ªñÁöÑ‰∏Ä‰∫õÊØîËæÉÈáçË¶ÅÊàêÂëòÂèòÈáèÔºö 12345678910111213141516171819private final BlockingQueue&lt;Runnable&gt; workQueue; //‰ªªÂä°ÁºìÂ≠òÈòüÂàóÔºåÁî®Êù•Â≠òÊîæÁ≠âÂæÖÊâßË°åÁöÑ‰ªªÂä°private final ReentrantLock mainLock = new ReentrantLock(); //Á∫øÁ®ãÊ±†ÁöÑ‰∏ªË¶ÅÁä∂ÊÄÅÈîÅÔºåÂØπÁ∫øÁ®ãÊ±†Áä∂ÊÄÅÔºàÊØîÂ¶ÇÁ∫øÁ®ãÊ±†Â§ßÂ∞è //„ÄÅrunStateÁ≠âÔºâÁöÑÊîπÂèòÈÉΩË¶Å‰ΩøÁî®Ëøô‰∏™ÈîÅprivate final HashSet&lt;Worker&gt; workers = new HashSet&lt;Worker&gt;(); //Áî®Êù•Â≠òÊîæÂ∑•‰ΩúÈõÜ private volatile long keepAliveTime; //Á∫øÁ®ãÂ≠òË¥ßÊó∂Èó¥ private volatile boolean allowCoreThreadTimeOut; //ÊòØÂê¶ÂÖÅËÆ∏‰∏∫Ê†∏ÂøÉÁ∫øÁ®ãËÆæÁΩÆÂ≠òÊ¥ªÊó∂Èó¥private volatile int corePoolSize; //Ê†∏ÂøÉÊ±†ÁöÑÂ§ßÂ∞èÔºàÂç≥Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÁõÆÂ§ß‰∫éËøô‰∏™ÂèÇÊï∞Êó∂ÔºåÊèê‰∫§ÁöÑ‰ªªÂä°‰ºöË¢´ÊîæËøõ‰ªªÂä°ÁºìÂ≠òÈòüÂàóÔºâprivate volatile int maximumPoolSize; //Á∫øÁ®ãÊ±†ÊúÄÂ§ßËÉΩÂÆπÂøçÁöÑÁ∫øÁ®ãÊï∞ private volatile int poolSize; //Á∫øÁ®ãÊ±†‰∏≠ÂΩìÂâçÁöÑÁ∫øÁ®ãÊï∞ private volatile RejectedExecutionHandler handler; //‰ªªÂä°ÊãíÁªùÁ≠ñÁï• private volatile ThreadFactory threadFactory; //Á∫øÁ®ãÂ∑•ÂéÇÔºåÁî®Êù•ÂàõÂª∫Á∫øÁ®ã private int largestPoolSize; //Áî®Êù•ËÆ∞ÂΩïÁ∫øÁ®ãÊ±†‰∏≠ÊõæÁªèÂá∫Áé∞ËøáÁöÑÊúÄÂ§ßÁ∫øÁ®ãÊï∞ private long completedTaskCount; //Áî®Êù•ËÆ∞ÂΩïÂ∑≤ÁªèÊâßË°åÂÆåÊØïÁöÑ‰ªªÂä°‰∏™Êï∞ ÊØè‰∏™ÂèòÈáèÁöÑ‰ΩúÁî®ÈÉΩÂ∑≤ÁªèÊ†áÊòéÂá∫Êù•‰∫ÜÔºåËøôÈáåË¶ÅÈáçÁÇπËß£Èáä‰∏Ä‰∏ãcorePoolSize„ÄÅmaximumPoolSize„ÄÅlargestPoolSize‰∏â‰∏™ÂèòÈáè„ÄÇ corePoolSizeÂú®ÂæàÂ§öÂú∞ÊñπË¢´ÁøªËØëÊàêÊ†∏ÂøÉÊ±†Â§ßÂ∞èÔºåÂÖ∂ÂÆûÊàëÁöÑÁêÜËß£Ëøô‰∏™Â∞±ÊòØÁ∫øÁ®ãÊ±†ÁöÑÂ§ßÂ∞è„ÄÇ‰∏æ‰∏™ÁÆÄÂçïÁöÑ‰æãÂ≠êÔºö ÂÅáÂ¶ÇÊúâ‰∏Ä‰∏™Â∑•ÂéÇÔºåÂ∑•ÂéÇÈáåÈù¢Êúâ10‰∏™Â∑•‰∫∫ÔºåÊØè‰∏™Â∑•‰∫∫ÂêåÊó∂Âè™ËÉΩÂÅö‰∏Ä‰ª∂‰ªªÂä°„ÄÇ Âõ†Ê≠§Âè™Ë¶ÅÂΩì10‰∏™Â∑•‰∫∫‰∏≠ÊúâÂ∑•‰∫∫ÊòØÁ©∫Èó≤ÁöÑÔºåÊù•‰∫Ü‰ªªÂä°Â∞±ÂàÜÈÖçÁªôÁ©∫Èó≤ÁöÑÂ∑•‰∫∫ÂÅöÔºõ ÂΩì10‰∏™Â∑•‰∫∫ÈÉΩÊúâ‰ªªÂä°Âú®ÂÅöÊó∂ÔºåÂ¶ÇÊûúËøòÊù•‰∫Ü‰ªªÂä°ÔºåÂ∞±Êää‰ªªÂä°ËøõË°åÊéíÈòüÁ≠âÂæÖÔºõ Â¶ÇÊûúËØ¥Êñ∞‰ªªÂä°Êï∞ÁõÆÂ¢ûÈïøÁöÑÈÄüÂ∫¶ËøúËøúÂ§ß‰∫éÂ∑•‰∫∫ÂÅö‰ªªÂä°ÁöÑÈÄüÂ∫¶ÔºåÈÇ£‰πàÊ≠§Êó∂Â∑•ÂéÇ‰∏ªÁÆ°ÂèØËÉΩ‰ºöÊÉ≥Ë°•ÊïëÊé™ÊñΩÔºåÊØîÂ¶ÇÈáçÊñ∞Êãõ4‰∏™‰∏¥Êó∂Â∑•‰∫∫ËøõÊù•Ôºõ ÁÑ∂ÂêéÂ∞±Â∞Ü‰ªªÂä°‰πüÂàÜÈÖçÁªôËøô4‰∏™‰∏¥Êó∂Â∑•‰∫∫ÂÅöÔºõ Â¶ÇÊûúËØ¥ÁùÄ14‰∏™Â∑•‰∫∫ÂÅö‰ªªÂä°ÁöÑÈÄüÂ∫¶ËøòÊòØ‰∏çÂ§üÔºåÊ≠§Êó∂Â∑•ÂéÇ‰∏ªÁÆ°ÂèØËÉΩÂ∞±Ë¶ÅËÄÉËôë‰∏çÂÜçÊé•Êî∂Êñ∞ÁöÑ‰ªªÂä°ÊàñËÄÖÊäõÂºÉÂâçÈù¢ÁöÑ‰∏Ä‰∫õ‰ªªÂä°‰∫Ü„ÄÇ ÂΩìËøô14‰∏™Â∑•‰∫∫ÂΩì‰∏≠Êúâ‰∫∫Á©∫Èó≤Êó∂ÔºåËÄåÊñ∞‰ªªÂä°Â¢ûÈïøÁöÑÈÄüÂ∫¶ÂèàÊØîËæÉÁºìÊÖ¢ÔºåÂ∑•ÂéÇ‰∏ªÁÆ°ÂèØËÉΩÂ∞±ËÄÉËôëËæûÊéâ4‰∏™‰∏¥Êó∂Â∑•‰∫ÜÔºåÂè™‰øùÊåÅÂéüÊù•ÁöÑ10‰∏™Â∑•‰∫∫ÔºåÊØïÁ´üËØ∑È¢ùÂ§ñÁöÑÂ∑•‰∫∫ÊòØË¶ÅËä±Èí±ÁöÑ„ÄÇ Ëøô‰∏™‰æãÂ≠ê‰∏≠ÁöÑcorePoolSizeÂ∞±ÊòØ10ÔºåËÄåmaximumPoolSizeÂ∞±ÊòØ14Ôºà10+4Ôºâ„ÄÇ ‰πüÂ∞±ÊòØËØ¥corePoolSizeÂ∞±ÊòØÁ∫øÁ®ãÊ±†Â§ßÂ∞èÔºåmaximumPoolSizeÂú®ÊàëÁúãÊù•ÊòØÁ∫øÁ®ãÊ±†ÁöÑ‰∏ÄÁßçË°•ÊïëÊé™ÊñΩÔºåÂç≥‰ªªÂä°ÈáèÁ™ÅÁÑ∂ËøáÂ§ßÊó∂ÁöÑ‰∏ÄÁßçË°•ÊïëÊé™ÊñΩ„ÄÇ ‰∏çËøá‰∏∫‰∫ÜÊñπ‰æøÁêÜËß£ÔºåÂú®Êú¨ÊñáÂêéÈù¢ËøòÊòØÂ∞ÜcorePoolSizeÁøªËØëÊàêÊ†∏ÂøÉÊ±†Â§ßÂ∞è„ÄÇ largestPoolSizeÂè™ÊòØ‰∏Ä‰∏™Áî®Êù•Ëµ∑ËÆ∞ÂΩï‰ΩúÁî®ÁöÑÂèòÈáèÔºåÁî®Êù•ËÆ∞ÂΩïÁ∫øÁ®ãÊ±†‰∏≠ÊõæÁªèÊúâËøáÁöÑÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÁõÆÔºåË∑üÁ∫øÁ®ãÊ±†ÁöÑÂÆπÈáèÊ≤°Êúâ‰ªª‰ΩïÂÖ≥Á≥ª„ÄÇ ‰∏ãÈù¢Êàë‰ª¨ËøõÂÖ•Ê≠£È¢òÔºåÁúã‰∏Ä‰∏ã‰ªªÂä°‰ªéÊèê‰∫§Âà∞ÊúÄÁªàÊâßË°åÂÆåÊØïÁªèÂéÜ‰∫ÜÂì™‰∫õËøáÁ®ã„ÄÇ Âú®ThreadPoolExecutorÁ±ª‰∏≠ÔºåÊúÄÊ†∏ÂøÉÁöÑ‰ªªÂä°Êèê‰∫§ÊñπÊ≥ïÊòØexecute()ÊñπÊ≥ïÔºåËôΩÁÑ∂ÈÄöËøásubmit‰πüÂèØ‰ª•Êèê‰∫§‰ªªÂä°Ôºå‰ΩÜÊòØÂÆûÈôÖ‰∏äsubmitÊñπÊ≥ïÈáåÈù¢ÊúÄÁªàË∞ÉÁî®ÁöÑËøòÊòØexecute()ÊñπÊ≥ïÔºåÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄË¶ÅÁ†îÁ©∂execute()ÊñπÊ≥ïÁöÑÂÆûÁé∞ÂéüÁêÜÂç≥ÂèØÔºö 123456789101112public void execute(Runnable command) &#123; if (command == null) throw new NullPointerException(); if (poolSize &gt;= corePoolSize || !addIfUnderCorePoolSize(command)) &#123; if (runState == RUNNING &amp;&amp; workQueue.offer(command)) &#123; if (runState != RUNNING || poolSize == 0) ensureQueuedTaskHandled(command); &#125; else if (!addIfUnderMaximumPoolSize(command)) reject(command); // is shutdown or saturated &#125;&#125; ‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂèØËÉΩÁúãËµ∑Êù•‰∏çÊòØÈÇ£‰πàÂÆπÊòìÁêÜËß£Ôºå‰∏ãÈù¢Êàë‰ª¨‰∏ÄÂè•‰∏ÄÂè•Ëß£ÈáäÔºö È¶ñÂÖàÔºåÂà§Êñ≠Êèê‰∫§ÁöÑ‰ªªÂä°commandÊòØÂê¶‰∏∫nullÔºåËã•ÊòØnullÔºåÂàôÊäõÂá∫Á©∫ÊåáÈíàÂºÇÂ∏∏Ôºõ Êé•ÁùÄÊòØËøôÂè•ÔºåËøôÂè•Ë¶ÅÂ•ΩÂ•ΩÁêÜËß£‰∏Ä‰∏ãÔºö 1`if` `(poolSize &gt;= corePoolSize || !addIfUnderCorePoolSize(command))` Áî±‰∫éÊòØÊàñÊù°‰ª∂ËøêÁÆóÁ¨¶ÔºåÊâÄ‰ª•ÂÖàËÆ°ÁÆóÂâçÂçäÈÉ®ÂàÜÁöÑÂÄºÔºåÂ¶ÇÊûúÁ∫øÁ®ãÊ±†‰∏≠ÂΩìÂâçÁ∫øÁ®ãÊï∞‰∏çÂ∞è‰∫éÊ†∏ÂøÉÊ±†Â§ßÂ∞èÔºåÈÇ£‰πàÂ∞±‰ºöÁõ¥Êé•ËøõÂÖ•‰∏ãÈù¢ÁöÑifËØ≠Âè•Âùó‰∫Ü„ÄÇ Â¶ÇÊûúÁ∫øÁ®ãÊ±†‰∏≠ÂΩìÂâçÁ∫øÁ®ãÊï∞Â∞è‰∫éÊ†∏ÂøÉÊ±†Â§ßÂ∞èÔºåÂàôÊé•ÁùÄÊâßË°åÂêéÂçäÈÉ®ÂàÜÔºå‰πüÂ∞±ÊòØÊâßË°å 1`addIfUnderCorePoolSize(command)` Â¶ÇÊûúÊâßË°åÂÆåaddIfUnderCorePoolSizeËøô‰∏™ÊñπÊ≥ïËøîÂõûfalseÔºåÂàôÁªßÁª≠ÊâßË°å‰∏ãÈù¢ÁöÑifËØ≠Âè•ÂùóÔºåÂê¶ÂàôÊï¥‰∏™ÊñπÊ≥ïÂ∞±Áõ¥Êé•ÊâßË°åÂÆåÊØï‰∫Ü„ÄÇ Â¶ÇÊûúÊâßË°åÂÆåaddIfUnderCorePoolSizeËøô‰∏™ÊñπÊ≥ïËøîÂõûtrueÔºåÁÑ∂ÂêéÊé•ÁùÄÂà§Êñ≠Ôºö 1`if` `(runState == RUNNING &amp;&amp; workQueue.offer(command))` Â¶ÇÊûúÂΩìÂâçÁ∫øÁ®ãÊ±†Â§Ñ‰∫éRUNNINGÁä∂ÊÄÅÔºåÂàôÂ∞Ü‰ªªÂä°ÊîæÂÖ•‰ªªÂä°ÁºìÂ≠òÈòüÂàóÔºõÂ¶ÇÊûúÂΩìÂâçÁ∫øÁ®ãÊ±†‰∏çÂ§Ñ‰∫éRUNNINGÁä∂ÊÄÅÊàñËÄÖ‰ªªÂä°ÊîæÂÖ•ÁºìÂ≠òÈòüÂàóÂ§±Ë¥•ÔºåÂàôÊâßË°åÔºö 1`addIfUnderMaximumPoolSize(command)` Â¶ÇÊûúÊâßË°åaddIfUnderMaximumPoolSizeÊñπÊ≥ïÂ§±Ë¥•ÔºåÂàôÊâßË°åreject()ÊñπÊ≥ïËøõË°å‰ªªÂä°ÊãíÁªùÂ§ÑÁêÜ„ÄÇ ÂõûÂà∞ÂâçÈù¢Ôºö 1`if` `(runState == RUNNING &amp;&amp; workQueue.offer(command))` ËøôÂè•ÁöÑÊâßË°åÔºåÂ¶ÇÊûúËØ¥ÂΩìÂâçÁ∫øÁ®ãÊ±†Â§Ñ‰∫éRUNNINGÁä∂ÊÄÅ‰∏îÂ∞Ü‰ªªÂä°ÊîæÂÖ•‰ªªÂä°ÁºìÂ≠òÈòüÂàóÊàêÂäüÔºåÂàôÁªßÁª≠ËøõË°åÂà§Êñ≠Ôºö 1`if` `(runState != RUNNING || poolSize == ``0``)` ËøôÂè•Âà§Êñ≠ÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢Âú®Â∞ÜÊ≠§‰ªªÂä°Ê∑ªÂä†Ëøõ‰ªªÂä°ÁºìÂ≠òÈòüÂàóÁöÑÂêåÊó∂ÂÖ∂‰ªñÁ∫øÁ®ãÁ™ÅÁÑ∂Ë∞ÉÁî®shutdownÊàñËÄÖshutdownNowÊñπÊ≥ïÂÖ≥Èó≠‰∫ÜÁ∫øÁ®ãÊ±†ÁöÑ‰∏ÄÁßçÂ∫îÊÄ•Êé™ÊñΩ„ÄÇÂ¶ÇÊûúÊòØËøôÊ†∑Â∞±ÊâßË°åÔºö 1`ensureQueuedTaskHandled(command)` ËøõË°åÂ∫îÊÄ•Â§ÑÁêÜÔºå‰ªéÂêçÂ≠óÂèØ‰ª•ÁúãÂá∫ÊòØ‰øùËØÅ Ê∑ªÂä†Âà∞‰ªªÂä°ÁºìÂ≠òÈòüÂàó‰∏≠ÁöÑ‰ªªÂä°ÂæóÂà∞Â§ÑÁêÜ„ÄÇ Êàë‰ª¨Êé•ÁùÄÁúã2‰∏™ÂÖ≥ÈîÆÊñπÊ≥ïÁöÑÂÆûÁé∞ÔºöaddIfUnderCorePoolSizeÂíåaddIfUnderMaximumPoolSizeÔºö 1`private` `boolean` `addIfUnderCorePoolSize(Runnable firstTask) &#123;`` ``Thread t = ``null``;`` ``final` `ReentrantLock mainLock = ``this``.mainLock;`` ``mainLock.lock();`` ``try` `&#123;`` ``if` `(poolSize &lt; corePoolSize &amp;&amp; runState == RUNNING)`` ``t = addThread(firstTask); ``//ÂàõÂª∫Á∫øÁ®ãÂéªÊâßË°åfirstTask‰ªªÂä° `` ``&#125; ``finally` `&#123;`` ``mainLock.unlock();`` ``&#125;`` ``if` `(t == ``null``)`` ``return` `false``;`` ``t.start();`` ``return` `true``;``&#125;` Ëøô‰∏™ÊòØaddIfUnderCorePoolSizeÊñπÊ≥ïÁöÑÂÖ∑‰ΩìÂÆûÁé∞Ôºå‰ªéÂêçÂ≠óÂèØ‰ª•ÁúãÂá∫ÂÆÉÁöÑÊÑèÂõæÂ∞±ÊòØÂΩì‰Ωé‰∫éÊ†∏ÂøÉÊ±†Â§ßÂ∞èÊó∂ÊâßË°åÁöÑÊñπÊ≥ï„ÄÇ‰∏ãÈù¢ÁúãÂÖ∂ÂÖ∑‰ΩìÂÆûÁé∞ÔºåÈ¶ñÂÖàËé∑ÂèñÂà∞ÈîÅÔºåÂõ†‰∏∫ËøôÂú∞ÊñπÊ∂âÂèäÂà∞Á∫øÁ®ãÊ±†Áä∂ÊÄÅÁöÑÂèòÂåñÔºåÂÖàÈÄöËøáifËØ≠Âè•Âà§Êñ≠ÂΩìÂâçÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÁõÆÊòØÂê¶Â∞è‰∫éÊ†∏ÂøÉÊ±†Â§ßÂ∞èÔºåÊúâÊúãÂèã‰πüËÆ∏‰ºöÊúâÁñëÈóÆÔºöÂâçÈù¢Âú®execute()ÊñπÊ≥ï‰∏≠‰∏çÊòØÂ∑≤ÁªèÂà§Êñ≠Ëøá‰∫ÜÂêóÔºåÂè™ÊúâÁ∫øÁ®ãÊ±†ÂΩìÂâçÁ∫øÁ®ãÊï∞ÁõÆÂ∞è‰∫éÊ†∏ÂøÉÊ±†Â§ßÂ∞èÊâç‰ºöÊâßË°åaddIfUnderCorePoolSizeÊñπÊ≥ïÁöÑÔºå‰∏∫‰ΩïËøôÂú∞ÊñπËøòË¶ÅÁªßÁª≠Âà§Êñ≠ÔºüÂéüÂõ†ÂæàÁÆÄÂçïÔºåÂâçÈù¢ÁöÑÂà§Êñ≠ËøáÁ®ã‰∏≠Âπ∂Ê≤°ÊúâÂä†ÈîÅÔºåÂõ†Ê≠§ÂèØËÉΩÂú®executeÊñπÊ≥ïÂà§Êñ≠ÁöÑÊó∂ÂÄôpoolSizeÂ∞è‰∫écorePoolSizeÔºåËÄåÂà§Êñ≠ÂÆå‰πãÂêéÔºåÂú®ÂÖ∂‰ªñÁ∫øÁ®ã‰∏≠ÂèàÂêëÁ∫øÁ®ãÊ±†Êèê‰∫§‰∫Ü‰ªªÂä°ÔºåÂ∞±ÂèØËÉΩÂØºËá¥poolSize‰∏çÂ∞è‰∫écorePoolSize‰∫ÜÔºåÊâÄ‰ª•ÈúÄË¶ÅÂú®Ëøô‰∏™Âú∞ÊñπÁªßÁª≠Âà§Êñ≠„ÄÇÁÑ∂ÂêéÊé•ÁùÄÂà§Êñ≠Á∫øÁ®ãÊ±†ÁöÑÁä∂ÊÄÅÊòØÂê¶‰∏∫RUNNINGÔºåÂéüÂõ†‰πüÂæàÁÆÄÂçïÔºåÂõ†‰∏∫ÊúâÂèØËÉΩÂú®ÂÖ∂‰ªñÁ∫øÁ®ã‰∏≠Ë∞ÉÁî®‰∫ÜshutdownÊàñËÄÖshutdownNowÊñπÊ≥ï„ÄÇÁÑ∂ÂêéÂ∞±ÊòØÊâßË°å 1`t = addThread(firstTask);` Ëøô‰∏™ÊñπÊ≥ï‰πüÈùûÂ∏∏ÂÖ≥ÈîÆÔºå‰º†ËøõÂéªÁöÑÂèÇÊï∞‰∏∫Êèê‰∫§ÁöÑ‰ªªÂä°ÔºåËøîÂõûÂÄº‰∏∫ThreadÁ±ªÂûã„ÄÇÁÑ∂ÂêéÊé•ÁùÄÂú®‰∏ãÈù¢Âà§Êñ≠tÊòØÂê¶‰∏∫Á©∫Ôºå‰∏∫Á©∫ÂàôË°®ÊòéÂàõÂª∫Á∫øÁ®ãÂ§±Ë¥•ÔºàÂç≥poolSize&gt;=corePoolSizeÊàñËÄÖrunState‰∏çÁ≠â‰∫éRUNNINGÔºâÔºåÂê¶ÂàôË∞ÉÁî®t.start()ÊñπÊ≥ïÂêØÂä®Á∫øÁ®ã„ÄÇ Êàë‰ª¨Êù•Áúã‰∏Ä‰∏ãaddThreadÊñπÊ≥ïÁöÑÂÆûÁé∞Ôºö 1`private` `Thread addThread(Runnable firstTask) &#123;`` ``Worker w = ``new` `Worker(firstTask);`` ``Thread t = threadFactory.newThread(w); ``//ÂàõÂª∫‰∏Ä‰∏™Á∫øÁ®ãÔºåÊâßË°å‰ªªÂä° `` ``if` `(t != ``null``) &#123;`` ``w.thread = t; ``//Â∞ÜÂàõÂª∫ÁöÑÁ∫øÁ®ãÁöÑÂºïÁî®ËµãÂÄº‰∏∫wÁöÑÊàêÂëòÂèòÈáè `` ``workers.add(w);`` ``int` `nt = ++poolSize; ``//ÂΩìÂâçÁ∫øÁ®ãÊï∞Âä†1 `` ``if` `(nt &gt; largestPoolSize)`` ``largestPoolSize = nt;`` ``&#125;`` ``return` `t;``&#125;` Âú®addThreadÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÁî®Êèê‰∫§ÁöÑ‰ªªÂä°ÂàõÂª∫‰∫Ü‰∏Ä‰∏™WorkerÂØπË±°ÔºåÁÑ∂ÂêéË∞ÉÁî®Á∫øÁ®ãÂ∑•ÂéÇthreadFactoryÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÁ∫øÁ®ãtÔºåÁÑ∂ÂêéÂ∞ÜÁ∫øÁ®ãtÁöÑÂºïÁî®ËµãÂÄºÁªô‰∫ÜWorkerÂØπË±°ÁöÑÊàêÂëòÂèòÈáèthreadÔºåÊé•ÁùÄÈÄöËøáworkers.add(w)Â∞ÜWorkerÂØπË±°Ê∑ªÂä†Âà∞Â∑•‰ΩúÈõÜÂΩì‰∏≠„ÄÇ ‰∏ãÈù¢Êàë‰ª¨Áúã‰∏Ä‰∏ãWorkerÁ±ªÁöÑÂÆûÁé∞Ôºö 1`private` `final` `class` `Worker ``implements` `Runnable &#123;`` ``private` `final` `ReentrantLock runLock = ``new` `ReentrantLock();`` ``private` `Runnable firstTask;`` ``volatile` `long` `completedTasks;`` ``Thread thread;`` ``Worker(Runnable firstTask) &#123;`` ``this``.firstTask = firstTask;`` ``&#125;`` ``boolean` `isActive() &#123;`` ``return` `runLock.isLocked();`` ``&#125;`` ``void` `interruptIfIdle() &#123;`` ``final` `ReentrantLock runLock = ``this``.runLock;`` ``if` `(runLock.tryLock()) &#123;`` ``try` `&#123;`` ``if` `(thread != Thread.currentThread())`` ``thread.interrupt();`` ``&#125; ``finally` `&#123;`` ``runLock.unlock();`` ``&#125;`` ``&#125;`` ``&#125;`` ``void` `interruptNow() &#123;`` ``thread.interrupt();`` ``&#125;` ` ``private` `void` `runTask(Runnable task) &#123;`` ``final` `ReentrantLock runLock = ``this``.runLock;`` ``runLock.lock();`` ``try` `&#123;`` ``if` `(runState &lt; STOP &amp;&amp;`` ``Thread.interrupted() &amp;&amp;`` ``runState &gt;= STOP)`` ``boolean` `ran = ``false``;`` ``beforeExecute(thread, task); ``//beforeExecuteÊñπÊ≥ïÊòØThreadPoolExecutorÁ±ªÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÊ≤°ÊúâÂÖ∑‰ΩìÂÆûÁé∞ÔºåÁî®Êà∑ÂèØ‰ª•Ê†πÊçÆ`` ``//Ëá™Â∑±ÈúÄË¶ÅÈáçËΩΩËøô‰∏™ÊñπÊ≥ïÂíåÂêéÈù¢ÁöÑafterExecuteÊñπÊ≥ïÊù•ËøõË°å‰∏Ä‰∫õÁªüËÆ°‰ø°ÊÅØÔºåÊØîÂ¶ÇÊüê‰∏™‰ªªÂä°ÁöÑÊâßË°åÊó∂Èó¥Á≠â `` ``try` `&#123;`` ``task.run();`` ``ran = ``true``;`` ``afterExecute(task, ``null``);`` ``++completedTasks;`` ``&#125; ``catch` `(RuntimeException ex) &#123;`` ``if` `(!ran)`` ``afterExecute(task, ex);`` ``throw` `ex;`` ``&#125;`` ``&#125; ``finally` `&#123;`` ``runLock.unlock();`` ``&#125;`` ``&#125;` ` ``public` `void` `run() &#123;`` ``try` `&#123;`` ``Runnable task = firstTask;`` ``firstTask = ``null``;`` ``while` `(task != ``null` `|| (task = getTask()) != ``null``) &#123;`` ``runTask(task);`` ``task = ``null``;`` ``&#125;`` ``&#125; ``finally` `&#123;`` ``workerDone(``this``); ``//ÂΩì‰ªªÂä°ÈòüÂàó‰∏≠Ê≤°Êúâ‰ªªÂä°Êó∂ÔºåËøõË°åÊ∏ÖÁêÜÂ∑•‰Ωú `` ``&#125;`` ``&#125;``&#125;` ÂÆÉÂÆûÈôÖ‰∏äÂÆûÁé∞‰∫ÜRunnableÊé•Âè£ÔºåÂõ†Ê≠§‰∏äÈù¢ÁöÑThread t = threadFactory.newThread(w);ÊïàÊûúË∑ü‰∏ãÈù¢ËøôÂè•ÁöÑÊïàÊûúÂü∫Êú¨‰∏ÄÊ†∑Ôºö 1`Thread t = ``new` `Thread(w);` Áõ∏ÂΩì‰∫é‰º†ËøõÂéª‰∫Ü‰∏Ä‰∏™Runnable‰ªªÂä°ÔºåÂú®Á∫øÁ®ãt‰∏≠ÊâßË°åËøô‰∏™Runnable„ÄÇ Êó¢ÁÑ∂WorkerÂÆûÁé∞‰∫ÜRunnableÊé•Âè£ÔºåÈÇ£‰πàËá™ÁÑ∂ÊúÄÊ†∏ÂøÉÁöÑÊñπÊ≥ï‰æøÊòØrun()ÊñπÊ≥ï‰∫ÜÔºö 1`public` `void` `run() &#123;`` ``try` `&#123;`` ``Runnable task = firstTask;`` ``firstTask = ``null``;`` ``while` `(task != ``null` `|| (task = getTask()) != ``null``) &#123;`` ``runTask(task);`` ``task = ``null``;`` ``&#125;`` ``&#125; ``finally` `&#123;`` ``workerDone(``this``);`` ``&#125;``&#125;` ‰ªérunÊñπÊ≥ïÁöÑÂÆûÁé∞ÂèØ‰ª•ÁúãÂá∫ÔºåÂÆÉÈ¶ñÂÖàÊâßË°åÁöÑÊòØÈÄöËøáÊûÑÈÄ†Âô®‰º†ËøõÊù•ÁöÑ‰ªªÂä°firstTaskÔºåÂú®Ë∞ÉÁî®runTask()ÊâßË°åÂÆåfirstTask‰πãÂêéÔºåÂú®whileÂæ™ÁéØÈáåÈù¢‰∏çÊñ≠ÈÄöËøágetTask()ÂéªÂèñÊñ∞ÁöÑ‰ªªÂä°Êù•ÊâßË°åÔºåÈÇ£‰πàÂéªÂì™ÈáåÂèñÂë¢ÔºüËá™ÁÑ∂ÊòØ‰ªé‰ªªÂä°ÁºìÂ≠òÈòüÂàóÈáåÈù¢ÂéªÂèñÔºågetTaskÊòØThreadPoolExecutorÁ±ª‰∏≠ÁöÑÊñπÊ≥ïÔºåÂπ∂‰∏çÊòØWorkerÁ±ª‰∏≠ÁöÑÊñπÊ≥ïÔºå‰∏ãÈù¢ÊòØgetTaskÊñπÊ≥ïÁöÑÂÆûÁé∞Ôºö 1`Runnable getTask() &#123;`` ``for` `(;;) &#123;`` ``try` `&#123;`` ``int` `state = runState;`` ``if` `(state &gt; SHUTDOWN)`` ``return` `null``;`` ``Runnable r;`` ``if` `(state == SHUTDOWN) ``// Help drain queue`` ``r = workQueue.poll();`` ``else` `if` `(poolSize &gt; corePoolSize || allowCoreThreadTimeOut) ``//Â¶ÇÊûúÁ∫øÁ®ãÊï∞Â§ß‰∫éÊ†∏ÂøÉÊ±†Â§ßÂ∞èÊàñËÄÖÂÖÅËÆ∏‰∏∫Ê†∏ÂøÉÊ±†Á∫øÁ®ãËÆæÁΩÆÁ©∫Èó≤Êó∂Èó¥Ôºå`` ``//ÂàôÈÄöËøápollÂèñ‰ªªÂä°ÔºåËã•Á≠âÂæÖ‰∏ÄÂÆöÁöÑÊó∂Èó¥Âèñ‰∏çÂà∞‰ªªÂä°ÔºåÂàôËøîÂõûnull`` ``r = workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS);`` ``else`` ``r = workQueue.take();`` ``if` `(r != ``null``)`` ``return` `r;`` ``if` `(workerCanExit()) &#123; ``//Â¶ÇÊûúÊ≤°ÂèñÂà∞‰ªªÂä°ÔºåÂç≥r‰∏∫nullÔºåÂàôÂà§Êñ≠ÂΩìÂâçÁöÑworkerÊòØÂê¶ÂèØ‰ª•ÈÄÄÂá∫`` ``if` `(runState &gt;= SHUTDOWN) ``// Wake up others`` ``interruptIdleWorkers(); ``//‰∏≠Êñ≠Â§Ñ‰∫éÁ©∫Èó≤Áä∂ÊÄÅÁöÑworker`` ``return` `null``;`` ``&#125;`` ``// Else retry`` ``&#125; ``catch` `(InterruptedException ie) &#123;`` ``// On interruption, re-check runState`` ``&#125;`` ``&#125;``&#125;` Âú®getTask‰∏≠ÔºåÂÖàÂà§Êñ≠ÂΩìÂâçÁ∫øÁ®ãÊ±†Áä∂ÊÄÅÔºåÂ¶ÇÊûúrunStateÂ§ß‰∫éSHUTDOWNÔºàÂç≥‰∏∫STOPÊàñËÄÖTERMINATEDÔºâÔºåÂàôÁõ¥Êé•ËøîÂõûnull„ÄÇ Â¶ÇÊûúrunState‰∏∫SHUTDOWNÊàñËÄÖRUNNINGÔºåÂàô‰ªé‰ªªÂä°ÁºìÂ≠òÈòüÂàóÂèñ‰ªªÂä°„ÄÇ Â¶ÇÊûúÂΩìÂâçÁ∫øÁ®ãÊ±†ÁöÑÁ∫øÁ®ãÊï∞Â§ß‰∫éÊ†∏ÂøÉÊ±†Â§ßÂ∞ècorePoolSizeÊàñËÄÖÂÖÅËÆ∏‰∏∫Ê†∏ÂøÉÊ±†‰∏≠ÁöÑÁ∫øÁ®ãËÆæÁΩÆÁ©∫Èó≤Â≠òÊ¥ªÊó∂Èó¥ÔºåÂàôË∞ÉÁî®poll(time,timeUnit)Êù•Âèñ‰ªªÂä°ÔºåËøô‰∏™ÊñπÊ≥ï‰ºöÁ≠âÂæÖ‰∏ÄÂÆöÁöÑÊó∂Èó¥ÔºåÂ¶ÇÊûúÂèñ‰∏çÂà∞‰ªªÂä°Â∞±ËøîÂõûnull„ÄÇ ÁÑ∂ÂêéÂà§Êñ≠ÂèñÂà∞ÁöÑ‰ªªÂä°rÊòØÂê¶‰∏∫nullÔºå‰∏∫nullÂàôÈÄöËøáË∞ÉÁî®workerCanExit()ÊñπÊ≥ïÊù•Âà§Êñ≠ÂΩìÂâçworkerÊòØÂê¶ÂèØ‰ª•ÈÄÄÂá∫ÔºåÊàë‰ª¨Áúã‰∏Ä‰∏ãworkerCanExit()ÁöÑÂÆûÁé∞Ôºö 1`private` `boolean` `workerCanExit() &#123;`` ``final` `ReentrantLock mainLock = ``this``.mainLock;`` ``mainLock.lock();`` ``boolean` `canExit;`` ``//Â¶ÇÊûúrunStateÂ§ß‰∫éÁ≠â‰∫éSTOPÔºåÊàñËÄÖ‰ªªÂä°ÁºìÂ≠òÈòüÂàó‰∏∫Á©∫‰∫Ü`` ``//ÊàñËÄÖ ÂÖÅËÆ∏‰∏∫Ê†∏ÂøÉÊ±†Á∫øÁ®ãËÆæÁΩÆÁ©∫Èó≤Â≠òÊ¥ªÊó∂Èó¥Âπ∂‰∏îÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÁõÆÂ§ß‰∫é1`` ``try` `&#123;`` ``canExit = runState &gt;= STOP ||`` ``workQueue.isEmpty() ||`` ``(allowCoreThreadTimeOut &amp;&amp;`` ``poolSize &gt; Math.max(``1``, corePoolSize));`` ``&#125; ``finally` `&#123;`` ``mainLock.unlock();`` ``&#125;`` ``return` `canExit;``&#125;` ‰πüÂ∞±ÊòØËØ¥Â¶ÇÊûúÁ∫øÁ®ãÊ±†Â§Ñ‰∫éSTOPÁä∂ÊÄÅ„ÄÅÊàñËÄÖ‰ªªÂä°ÈòüÂàóÂ∑≤‰∏∫Á©∫ÊàñËÄÖÂÖÅËÆ∏‰∏∫Ê†∏ÂøÉÊ±†Á∫øÁ®ãËÆæÁΩÆÁ©∫Èó≤Â≠òÊ¥ªÊó∂Èó¥Âπ∂‰∏îÁ∫øÁ®ãÊï∞Â§ß‰∫é1Êó∂ÔºåÂÖÅËÆ∏workerÈÄÄÂá∫„ÄÇÂ¶ÇÊûúÂÖÅËÆ∏workerÈÄÄÂá∫ÔºåÂàôË∞ÉÁî®interruptIdleWorkers()‰∏≠Êñ≠Â§Ñ‰∫éÁ©∫Èó≤Áä∂ÊÄÅÁöÑworkerÔºåÊàë‰ª¨Áúã‰∏Ä‰∏ãinterruptIdleWorkers()ÁöÑÂÆûÁé∞Ôºö 1`void` `interruptIdleWorkers() &#123;`` ``final` `ReentrantLock mainLock = ``this``.mainLock;`` ``mainLock.lock();`` ``try` `&#123;`` ``for` `(Worker w : workers) ``//ÂÆûÈôÖ‰∏äË∞ÉÁî®ÁöÑÊòØworkerÁöÑinterruptIfIdle()ÊñπÊ≥ï`` ``w.interruptIfIdle();`` ``&#125; ``finally` `&#123;`` ``mainLock.unlock();`` ``&#125;``&#125;` ‰ªéÂÆûÁé∞ÂèØ‰ª•ÁúãÂá∫ÔºåÂÆÉÂÆûÈôÖ‰∏äË∞ÉÁî®ÁöÑÊòØworkerÁöÑinterruptIfIdle()ÊñπÊ≥ïÔºåÂú®workerÁöÑinterruptIfIdle()ÊñπÊ≥ï‰∏≠Ôºö 1`void` `interruptIfIdle() &#123;`` ``final` `ReentrantLock runLock = ``this``.runLock;`` ``if` `(runLock.tryLock()) &#123; ``//Ê≥®ÊÑèËøôÈáåÔºåÊòØË∞ÉÁî®tryLock()Êù•Ëé∑ÂèñÈîÅÁöÑÔºåÂõ†‰∏∫Â¶ÇÊûúÂΩìÂâçworkerÊ≠£Âú®ÊâßË°å‰ªªÂä°ÔºåÈîÅÂ∑≤ÁªèË¢´Ëé∑Âèñ‰∫ÜÔºåÊòØÊó†Ê≥ïËé∑ÂèñÂà∞ÈîÅÁöÑ`` ``//Â¶ÇÊûúÊàêÂäüËé∑Âèñ‰∫ÜÈîÅÔºåËØ¥ÊòéÂΩìÂâçworkerÂ§Ñ‰∫éÁ©∫Èó≤Áä∂ÊÄÅ`` ``try` `&#123;`` ``if` `(thread != Thread.currentThread()) `` ``thread.interrupt();`` ``&#125; ``finally` `&#123;`` ``runLock.unlock();`` ``&#125;`` ``&#125;``&#125;` ËøôÈáåÊúâ‰∏Ä‰∏™ÈùûÂ∏∏Â∑ßÂ¶ôÁöÑËÆæËÆ°ÊñπÂºèÔºåÂÅáÂ¶ÇÊàë‰ª¨Êù•ËÆæËÆ°Á∫øÁ®ãÊ±†ÔºåÂèØËÉΩ‰ºöÊúâ‰∏Ä‰∏™‰ªªÂä°ÂàÜÊ¥æÁ∫øÁ®ãÔºåÂΩìÂèëÁé∞ÊúâÁ∫øÁ®ãÁ©∫Èó≤Êó∂ÔºåÂ∞±‰ªé‰ªªÂä°ÁºìÂ≠òÈòüÂàó‰∏≠Âèñ‰∏Ä‰∏™‰ªªÂä°‰∫§ÁªôÁ©∫Èó≤Á∫øÁ®ãÊâßË°å„ÄÇ‰ΩÜÊòØÂú®ËøôÈáåÔºåÂπ∂Ê≤°ÊúâÈááÁî®ËøôÊ†∑ÁöÑÊñπÂºèÔºåÂõ†‰∏∫ËøôÊ†∑‰ºöË¶ÅÈ¢ùÂ§ñÂú∞ÂØπ‰ªªÂä°ÂàÜÊ¥æÁ∫øÁ®ãËøõË°åÁÆ°ÁêÜÔºåÊó†ÂΩ¢Âú∞‰ºöÂ¢ûÂä†ÈöæÂ∫¶ÂíåÂ§çÊùÇÂ∫¶ÔºåËøôÈáåÁõ¥Êé•ËÆ©ÊâßË°åÂÆå‰ªªÂä°ÁöÑÁ∫øÁ®ãÂéª‰ªªÂä°ÁºìÂ≠òÈòüÂàóÈáåÈù¢Âèñ‰ªªÂä°Êù•ÊâßË°å„ÄÇ Êàë‰ª¨ÂÜçÁúãaddIfUnderMaximumPoolSizeÊñπÊ≥ïÁöÑÂÆûÁé∞ÔºåËøô‰∏™ÊñπÊ≥ïÁöÑÂÆûÁé∞ÊÄùÊÉ≥ÂíåaddIfUnderCorePoolSizeÊñπÊ≥ïÁöÑÂÆûÁé∞ÊÄùÊÉ≥ÈùûÂ∏∏Áõ∏‰ººÔºåÂîØ‰∏ÄÁöÑÂå∫Âà´Âú®‰∫éaddIfUnderMaximumPoolSizeÊñπÊ≥ïÊòØÂú®Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ËææÂà∞‰∫ÜÊ†∏ÂøÉÊ±†Â§ßÂ∞èÂπ∂‰∏îÂæÄ‰ªªÂä°ÈòüÂàó‰∏≠Ê∑ªÂä†‰ªªÂä°Â§±Ë¥•ÁöÑÊÉÖÂÜµ‰∏ãÊâßË°åÁöÑÔºö 1`private` `boolean` `addIfUnderMaximumPoolSize(Runnable firstTask) &#123;`` ``Thread t = ``null``;`` ``final` `ReentrantLock mainLock = ``this``.mainLock;`` ``mainLock.lock();`` ``try` `&#123;`` ``if` `(poolSize &lt; maximumPoolSize &amp;&amp; runState == RUNNING)`` ``t = addThread(firstTask);`` ``&#125; ``finally` `&#123;`` ``mainLock.unlock();`` ``&#125;`` ``if` `(t == ``null``)`` ``return` `false``;`` ``t.start();`` ``return` `true``;``&#125;` ÁúãÂà∞Ê≤°ÊúâÔºåÂÖ∂ÂÆûÂÆÉÂíåaddIfUnderCorePoolSizeÊñπÊ≥ïÁöÑÂÆûÁé∞Âü∫Êú¨‰∏ÄÊ®°‰∏ÄÊ†∑ÔºåÂè™ÊòØifËØ≠Âè•Âà§Êñ≠Êù°‰ª∂‰∏≠ÁöÑpoolSize &lt; maximumPoolSize‰∏çÂêåËÄåÂ∑≤„ÄÇ Âà∞ËøôÈáåÔºåÂ§ßÈÉ®ÂàÜÊúãÂèãÂ∫îËØ•ÂØπ‰ªªÂä°Êèê‰∫§ÁªôÁ∫øÁ®ãÊ±†‰πãÂêéÂà∞Ë¢´ÊâßË°åÁöÑÊï¥‰∏™ËøáÁ®ãÊúâ‰∫Ü‰∏Ä‰∏™Âü∫Êú¨ÁöÑ‰∫ÜËß£Ôºå‰∏ãÈù¢ÊÄªÁªì‰∏Ä‰∏ãÔºö 1ÔºâÈ¶ñÂÖàÔºåË¶ÅÊ∏ÖÊ•öcorePoolSizeÂíåmaximumPoolSizeÁöÑÂê´‰πâÔºõ 2ÔºâÂÖ∂Ê¨°ÔºåË¶ÅÁü•ÈÅìWorkerÊòØÁî®Êù•Ëµ∑Âà∞‰ªÄ‰πà‰ΩúÁî®ÁöÑÔºõ 3ÔºâË¶ÅÁü•ÈÅì‰ªªÂä°Êèê‰∫§ÁªôÁ∫øÁ®ãÊ±†‰πãÂêéÁöÑÂ§ÑÁêÜÁ≠ñÁï•ÔºåËøôÈáåÊÄªÁªì‰∏Ä‰∏ã‰∏ªË¶ÅÊúâ4ÁÇπÔºö Â¶ÇÊûúÂΩìÂâçÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÁõÆÂ∞è‰∫écorePoolSizeÔºåÂàôÊØèÊù•‰∏Ä‰∏™‰ªªÂä°ÔºåÂ∞±‰ºöÂàõÂª∫‰∏Ä‰∏™Á∫øÁ®ãÂéªÊâßË°åËøô‰∏™‰ªªÂä°Ôºõ Â¶ÇÊûúÂΩìÂâçÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÁõÆ&gt;=corePoolSizeÔºåÂàôÊØèÊù•‰∏Ä‰∏™‰ªªÂä°Ôºå‰ºöÂ∞ùËØïÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞‰ªªÂä°ÁºìÂ≠òÈòüÂàóÂΩì‰∏≠ÔºåËã•Ê∑ªÂä†ÊàêÂäüÔºåÂàôËØ•‰ªªÂä°‰ºöÁ≠âÂæÖÁ©∫Èó≤Á∫øÁ®ãÂ∞ÜÂÖ∂ÂèñÂá∫ÂéªÊâßË°åÔºõËã•Ê∑ªÂä†Â§±Ë¥•Ôºà‰∏ÄËà¨Êù•ËØ¥ÊòØ‰ªªÂä°ÁºìÂ≠òÈòüÂàóÂ∑≤Êª°ÔºâÔºåÂàô‰ºöÂ∞ùËØïÂàõÂª∫Êñ∞ÁöÑÁ∫øÁ®ãÂéªÊâßË°åËøô‰∏™‰ªªÂä°Ôºõ Â¶ÇÊûúÂΩìÂâçÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÁõÆËææÂà∞maximumPoolSizeÔºåÂàô‰ºöÈááÂèñ‰ªªÂä°ÊãíÁªùÁ≠ñÁï•ËøõË°åÂ§ÑÁêÜÔºõ Â¶ÇÊûúÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÈáèÂ§ß‰∫é corePoolSizeÊó∂ÔºåÂ¶ÇÊûúÊüêÁ∫øÁ®ãÁ©∫Èó≤Êó∂Èó¥Ë∂ÖËøákeepAliveTimeÔºåÁ∫øÁ®ãÂ∞ÜË¢´ÁªàÊ≠¢ÔºåÁõ¥Ëá≥Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÁõÆ‰∏çÂ§ß‰∫écorePoolSizeÔºõÂ¶ÇÊûúÂÖÅËÆ∏‰∏∫Ê†∏ÂøÉÊ±†‰∏≠ÁöÑÁ∫øÁ®ãËÆæÁΩÆÂ≠òÊ¥ªÊó∂Èó¥ÔºåÈÇ£‰πàÊ†∏ÂøÉÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÁ©∫Èó≤Êó∂Èó¥Ë∂ÖËøákeepAliveTimeÔºåÁ∫øÁ®ã‰πü‰ºöË¢´ÁªàÊ≠¢„ÄÇ 3.Á∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÂàùÂßãÂåñ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂàõÂª∫Á∫øÁ®ãÊ±†‰πãÂêéÔºåÁ∫øÁ®ãÊ±†‰∏≠ÊòØÊ≤°ÊúâÁ∫øÁ®ãÁöÑÔºåÈúÄË¶ÅÊèê‰∫§‰ªªÂä°‰πãÂêéÊâç‰ºöÂàõÂª∫Á∫øÁ®ã„ÄÇ Âú®ÂÆûÈôÖ‰∏≠Â¶ÇÊûúÈúÄË¶ÅÁ∫øÁ®ãÊ±†ÂàõÂª∫‰πãÂêéÁ´ãÂç≥ÂàõÂª∫Á∫øÁ®ãÔºåÂèØ‰ª•ÈÄöËøá‰ª•‰∏ã‰∏§‰∏™ÊñπÊ≥ïÂäûÂà∞Ôºö prestartCoreThread()ÔºöÂàùÂßãÂåñ‰∏Ä‰∏™Ê†∏ÂøÉÁ∫øÁ®ãÔºõ prestartAllCoreThreads()ÔºöÂàùÂßãÂåñÊâÄÊúâÊ†∏ÂøÉÁ∫øÁ®ã ‰∏ãÈù¢ÊòØËøô2‰∏™ÊñπÊ≥ïÁöÑÂÆûÁé∞Ôºö 1`public` `boolean` `prestartCoreThread() &#123;`` ``return` `addIfUnderCorePoolSize(``null``); ``//Ê≥®ÊÑè‰º†ËøõÂéªÁöÑÂèÇÊï∞ÊòØnull``&#125;` `public` `int` `prestartAllCoreThreads() &#123;`` ``int` `n = ``0``;`` ``while` `(addIfUnderCorePoolSize(``null``))``//Ê≥®ÊÑè‰º†ËøõÂéªÁöÑÂèÇÊï∞ÊòØnull`` ``++n;`` ``return` `n;``&#125;` Ê≥®ÊÑè‰∏äÈù¢‰º†ËøõÂéªÁöÑÂèÇÊï∞ÊòØnullÔºåÊ†πÊçÆÁ¨¨2Â∞èËäÇÁöÑÂàÜÊûêÂèØÁü•Â¶ÇÊûú‰º†ËøõÂéªÁöÑÂèÇÊï∞‰∏∫nullÔºåÂàôÊúÄÂêéÊâßË°åÁ∫øÁ®ã‰ºöÈòªÂ°ûÂú®getTaskÊñπÊ≥ï‰∏≠ÁöÑ 1`r = workQueue.take();` Âç≥Á≠âÂæÖ‰ªªÂä°ÈòüÂàó‰∏≠Êúâ‰ªªÂä°„ÄÇ 4.‰ªªÂä°ÁºìÂ≠òÈòüÂàóÂèäÊéíÈòüÁ≠ñÁï• Âú®ÂâçÈù¢Êàë‰ª¨Â§öÊ¨°ÊèêÂà∞‰∫Ü‰ªªÂä°ÁºìÂ≠òÈòüÂàóÔºåÂç≥workQueueÔºåÂÆÉÁî®Êù•Â≠òÊîæÁ≠âÂæÖÊâßË°åÁöÑ‰ªªÂä°„ÄÇ workQueueÁöÑÁ±ªÂûã‰∏∫BlockingQueueÔºåÈÄöÂ∏∏ÂèØ‰ª•Âèñ‰∏ãÈù¢‰∏âÁßçÁ±ªÂûãÔºö 1ÔºâArrayBlockingQueueÔºöÂü∫‰∫éÊï∞ÁªÑÁöÑÂÖàËøõÂÖàÂá∫ÈòüÂàóÔºåÊ≠§ÈòüÂàóÂàõÂª∫Êó∂ÂøÖÈ°ªÊåáÂÆöÂ§ßÂ∞èÔºõ 2ÔºâLinkedBlockingQueueÔºöÂü∫‰∫éÈìæË°®ÁöÑÂÖàËøõÂÖàÂá∫ÈòüÂàóÔºåÂ¶ÇÊûúÂàõÂª∫Êó∂Ê≤°ÊúâÊåáÂÆöÊ≠§ÈòüÂàóÂ§ßÂ∞èÔºåÂàôÈªòËÆ§‰∏∫Integer.MAX_VALUEÔºõ 3ÔºâsynchronousQueueÔºöËøô‰∏™ÈòüÂàóÊØîËæÉÁâπÊÆäÔºåÂÆÉ‰∏ç‰ºö‰øùÂ≠òÊèê‰∫§ÁöÑ‰ªªÂä°ÔºåËÄåÊòØÂ∞ÜÁõ¥Êé•Êñ∞Âª∫‰∏Ä‰∏™Á∫øÁ®ãÊù•ÊâßË°åÊñ∞Êù•ÁöÑ‰ªªÂä°„ÄÇ 5.‰ªªÂä°ÊãíÁªùÁ≠ñÁï• ÂΩìÁ∫øÁ®ãÊ±†ÁöÑ‰ªªÂä°ÁºìÂ≠òÈòüÂàóÂ∑≤Êª°Âπ∂‰∏îÁ∫øÁ®ãÊ±†‰∏≠ÁöÑÁ∫øÁ®ãÊï∞ÁõÆËææÂà∞maximumPoolSizeÔºåÂ¶ÇÊûúËøòÊúâ‰ªªÂä°Âà∞Êù•Â∞±‰ºöÈááÂèñ‰ªªÂä°ÊãíÁªùÁ≠ñÁï•ÔºåÈÄöÂ∏∏Êúâ‰ª•‰∏ãÂõõÁßçÁ≠ñÁï•Ôºö 1`ThreadPoolExecutor.AbortPolicy:‰∏¢ÂºÉ‰ªªÂä°Âπ∂ÊäõÂá∫RejectedExecutionExceptionÂºÇÂ∏∏„ÄÇ``ThreadPoolExecutor.DiscardPolicyÔºö‰πüÊòØ‰∏¢ÂºÉ‰ªªÂä°Ôºå‰ΩÜÊòØ‰∏çÊäõÂá∫ÂºÇÂ∏∏„ÄÇ``ThreadPoolExecutor.DiscardOldestPolicyÔºö‰∏¢ÂºÉÈòüÂàóÊúÄÂâçÈù¢ÁöÑ‰ªªÂä°ÔºåÁÑ∂ÂêéÈáçÊñ∞Â∞ùËØïÊâßË°å‰ªªÂä°ÔºàÈáçÂ§çÊ≠§ËøáÁ®ãÔºâ``ThreadPoolExecutor.CallerRunsPolicyÔºöÁî±Ë∞ÉÁî®Á∫øÁ®ãÂ§ÑÁêÜËØ•‰ªªÂä°` 6.Á∫øÁ®ãÊ±†ÁöÑÂÖ≥Èó≠ ThreadPoolExecutorÊèê‰æõ‰∫Ü‰∏§‰∏™ÊñπÊ≥ïÔºåÁî®‰∫éÁ∫øÁ®ãÊ±†ÁöÑÂÖ≥Èó≠ÔºåÂàÜÂà´ÊòØshutdown()ÂíåshutdownNow()ÔºåÂÖ∂‰∏≠Ôºö shutdown()Ôºö‰∏ç‰ºöÁ´ãÂç≥ÁªàÊ≠¢Á∫øÁ®ãÊ±†ÔºåËÄåÊòØË¶ÅÁ≠âÊâÄÊúâ‰ªªÂä°ÁºìÂ≠òÈòüÂàó‰∏≠ÁöÑ‰ªªÂä°ÈÉΩÊâßË°åÂÆåÂêéÊâçÁªàÊ≠¢Ôºå‰ΩÜÂÜç‰πü‰∏ç‰ºöÊé•ÂèóÊñ∞ÁöÑ‰ªªÂä° shutdownNow()ÔºöÁ´ãÂç≥ÁªàÊ≠¢Á∫øÁ®ãÊ±†ÔºåÂπ∂Â∞ùËØïÊâìÊñ≠Ê≠£Âú®ÊâßË°åÁöÑ‰ªªÂä°ÔºåÂπ∂‰∏îÊ∏ÖÁ©∫‰ªªÂä°ÁºìÂ≠òÈòüÂàóÔºåËøîÂõûÂ∞öÊú™ÊâßË°åÁöÑ‰ªªÂä° 7.Á∫øÁ®ãÊ±†ÂÆπÈáèÁöÑÂä®ÊÄÅË∞ÉÊï¥ ThreadPoolExecutorÊèê‰æõ‰∫ÜÂä®ÊÄÅË∞ÉÊï¥Á∫øÁ®ãÊ±†ÂÆπÈáèÂ§ßÂ∞èÁöÑÊñπÊ≥ïÔºösetCorePoolSize()ÂíåsetMaximumPoolSize()Ôºå setCorePoolSizeÔºöËÆæÁΩÆÊ†∏ÂøÉÊ±†Â§ßÂ∞è setMaximumPoolSizeÔºöËÆæÁΩÆÁ∫øÁ®ãÊ±†ÊúÄÂ§ßËÉΩÂàõÂª∫ÁöÑÁ∫øÁ®ãÊï∞ÁõÆÂ§ßÂ∞è ÂΩì‰∏äËø∞ÂèÇÊï∞‰ªéÂ∞èÂèòÂ§ßÊó∂ÔºåThreadPoolExecutorËøõË°åÁ∫øÁ®ãËµãÂÄºÔºåËøòÂèØËÉΩÁ´ãÂç≥ÂàõÂª∫Êñ∞ÁöÑÁ∫øÁ®ãÊù•ÊâßË°å‰ªªÂä°„ÄÇ ‰ΩøÁî®Á§∫‰æãÂâçÈù¢Êàë‰ª¨ËÆ®ËÆ∫‰∫ÜÂÖ≥‰∫éÁ∫øÁ®ãÊ±†ÁöÑÂÆûÁé∞ÂéüÁêÜÔºåËøô‰∏ÄËäÇÊàë‰ª¨Êù•Áúã‰∏Ä‰∏ãÂÆÉÁöÑÂÖ∑‰Ωì‰ΩøÁî®Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546package com.ohaotian.feifz.style.study.thread;import java.util.concurrent.ArrayBlockingQueue;import java.util.concurrent.ThreadPoolExecutor;import java.util.concurrent.TimeUnit;/** * @author feifz * @version 1.0.0 * @Description Á∫øÁ®ãÊ±†Á§∫‰æã * @createTime 2019Âπ¥05Êúà28Êó• 16:31:00 */public class ThreadDemoTest &#123; public static void main(String[] args) &#123; ThreadPoolExecutor executor = new ThreadPoolExecutor(5, 10, 200, TimeUnit.MILLISECONDS, new ArrayBlockingQueue&lt;Runnable&gt;(5)); for (int i = 0; i &lt; 15; i++) &#123; MyTask myTask = new MyTask(i); executor.execute(myTask); System.out.println("Á∫øÁ®ãÊ±†‰∏≠Á∫øÁ®ãÊï∞ÁõÆÔºö" + executor.getPoolSize() + "ÔºåÈòüÂàó‰∏≠Á≠âÂæÖÊâßË°åÁöÑ‰ªªÂä°Êï∞ÁõÆÔºö" + executor.getQueue().size() + "ÔºåÂ∑≤ÊâßË°åÁé©Âà´ÁöÑ‰ªªÂä°Êï∞ÁõÆÔºö" + executor.getCompletedTaskCount()); &#125; executor.shutdown(); &#125;&#125;class MyTask implements Runnable &#123; private int taskNum; public MyTask(int num) &#123; this.taskNum = num; &#125; @Override public void run() &#123; System.out.println("Ê≠£Âú®ÊâßË°åtask " + taskNum); try &#123; Thread.currentThread().sleep(4000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("task " + taskNum + "ÊâßË°åÂÆåÊØï"); &#125;&#125; ‰ªéÊâßË°åÁªìÊûúÂèØ‰ª•ÁúãÂá∫ÔºåÂΩìÁ∫øÁ®ãÊ±†‰∏≠Á∫øÁ®ãÁöÑÊï∞ÁõÆÂ§ß‰∫é5Êó∂Ôºå‰æøÂ∞Ü‰ªªÂä°ÊîæÂÖ•‰ªªÂä°ÁºìÂ≠òÈòüÂàóÈáåÈù¢ÔºåÂΩì‰ªªÂä°ÁºìÂ≠òÈòüÂàóÊª°‰∫Ü‰πãÂêéÔºå‰æøÂàõÂª∫Êñ∞ÁöÑÁ∫øÁ®ã„ÄÇÂ¶ÇÊûú‰∏äÈù¢Á®ãÂ∫è‰∏≠ÔºåÂ∞ÜforÂæ™ÁéØ‰∏≠ÊîπÊàêÊâßË°å20‰∏™‰ªªÂä°ÔºåÂ∞±‰ºöÊäõÂá∫‰ªªÂä°ÊãíÁªùÂºÇÂ∏∏‰∫Ü„ÄÇ ‰∏çËøáÂú®java doc‰∏≠ÔºåÂπ∂‰∏çÊèêÂÄ°Êàë‰ª¨Áõ¥Êé•‰ΩøÁî®ThreadPoolExecutorÔºåËÄåÊòØ‰ΩøÁî®ExecutorsÁ±ª‰∏≠Êèê‰æõÁöÑÂá†‰∏™ÈùôÊÄÅÊñπÊ≥ïÊù•ÂàõÂª∫Á∫øÁ®ãÊ±†Ôºö 123Executors.newCachedThreadPool(); //ÂàõÂª∫‰∏Ä‰∏™ÁºìÂÜ≤Ê±†ÔºåÁºìÂÜ≤Ê±†ÂÆπÈáèÂ§ßÂ∞è‰∏∫Integer.MAX_VALUEExecutors.newSingleThreadExecutor(); //ÂàõÂª∫ÂÆπÈáè‰∏∫1ÁöÑÁºìÂÜ≤Ê±†Executors.newFixedThreadPool(int); //ÂàõÂª∫Âõ∫ÂÆöÂÆπÈáèÂ§ßÂ∞èÁöÑÁºìÂÜ≤Ê±† ‰∏ãÈù¢ÊòØËøô‰∏â‰∏™ÈùôÊÄÅÊñπÊ≥ïÁöÑÂÖ∑‰ΩìÂÆûÁé∞; 12345678910111213141516public static ExecutorService newFixedThreadPool(int nThreads) &#123; return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());&#125;public static ExecutorService newSingleThreadExecutor() &#123; return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()));&#125;public static ExecutorService newCachedThreadPool() &#123; return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;());&#125; ‰ªéÂÆÉ‰ª¨ÁöÑÂÖ∑‰ΩìÂÆûÁé∞Êù•ÁúãÔºåÂÆÉ‰ª¨ÂÆûÈôÖ‰∏ä‰πüÊòØË∞ÉÁî®‰∫ÜThreadPoolExecutorÔºåÂè™‰∏çËøáÂèÇÊï∞ÈÉΩÂ∑≤ÈÖçÁΩÆÂ•Ω‰∫Ü„ÄÇ newFixedThreadPoolÂàõÂª∫ÁöÑÁ∫øÁ®ãÊ±†corePoolSizeÂíåmaximumPoolSizeÂÄºÊòØÁõ∏Á≠âÁöÑÔºåÂÆÉ‰ΩøÁî®ÁöÑLinkedBlockingQueueÔºõ newSingleThreadExecutorÂ∞ÜcorePoolSizeÂíåmaximumPoolSizeÈÉΩËÆæÁΩÆ‰∏∫1Ôºå‰πü‰ΩøÁî®ÁöÑLinkedBlockingQueueÔºõ newCachedThreadPoolÂ∞ÜcorePoolSizeËÆæÁΩÆ‰∏∫0ÔºåÂ∞ÜmaximumPoolSizeËÆæÁΩÆ‰∏∫Integer.MAX_VALUEÔºå‰ΩøÁî®ÁöÑSynchronousQueueÔºå‰πüÂ∞±ÊòØËØ¥Êù•‰∫Ü‰ªªÂä°Â∞±ÂàõÂª∫Á∫øÁ®ãËøêË°åÔºåÂΩìÁ∫øÁ®ãÁ©∫Èó≤Ë∂ÖËøá60ÁßíÔºåÂ∞±ÈîÄÊØÅÁ∫øÁ®ã„ÄÇ ÂÆûÈôÖ‰∏≠ÔºåÂ¶ÇÊûúExecutorsÊèê‰æõÁöÑ‰∏â‰∏™ÈùôÊÄÅÊñπÊ≥ïËÉΩÊª°Ë∂≥Ë¶ÅÊ±ÇÔºåÂ∞±Â∞ΩÈáè‰ΩøÁî®ÂÆÉÊèê‰æõÁöÑ‰∏â‰∏™ÊñπÊ≥ïÔºåÂõ†‰∏∫Ëá™Â∑±ÂéªÊâãÂä®ÈÖçÁΩÆThreadPoolExecutorÁöÑÂèÇÊï∞ÊúâÁÇπÈ∫ªÁÉ¶ÔºåË¶ÅÊ†πÊçÆÂÆûÈôÖ‰ªªÂä°ÁöÑÁ±ªÂûãÂíåÊï∞ÈáèÊù•ËøõË°åÈÖçÁΩÆ„ÄÇ Âè¶Â§ñÔºåÂ¶ÇÊûúThreadPoolExecutorËææ‰∏çÂà∞Ë¶ÅÊ±ÇÔºåÂèØ‰ª•Ëá™Â∑±ÁªßÊâøThreadPoolExecutorÁ±ªËøõË°åÈáçÂÜô„ÄÇ Â¶Ç‰ΩïÂêàÁêÜÈÖçÁΩÆÁ∫øÁ®ãÊ±†ÁöÑÂ§ßÂ∞èÊú¨ËäÇÊù•ËÆ®ËÆ∫‰∏Ä‰∏™ÊØîËæÉÈáçË¶ÅÁöÑËØùÈ¢òÔºöÂ¶Ç‰ΩïÂêàÁêÜÈÖçÁΩÆÁ∫øÁ®ãÊ±†Â§ßÂ∞èÔºå‰ªÖ‰æõÂèÇËÄÉ„ÄÇ ‰∏ÄËà¨ÈúÄË¶ÅÊ†πÊçÆ‰ªªÂä°ÁöÑÁ±ªÂûãÊù•ÈÖçÁΩÆÁ∫øÁ®ãÊ±†Â§ßÂ∞èÔºö Â¶ÇÊûúÊòØCPUÂØÜÈõÜÂûã‰ªªÂä°ÔºåÂ∞±ÈúÄË¶ÅÂ∞ΩÈáèÂéãÊ¶®CPUÔºåÂèÇËÄÉÂÄºÂèØ‰ª•ËÆæ‰∏∫ NCPU+1 Â¶ÇÊûúÊòØIOÂØÜÈõÜÂûã‰ªªÂä°ÔºåÂèÇËÄÉÂÄºÂèØ‰ª•ËÆæÁΩÆ‰∏∫2*NCPU ÂΩìÁÑ∂ÔºåËøôÂè™ÊòØ‰∏Ä‰∏™ÂèÇËÄÉÂÄºÔºåÂÖ∑‰ΩìÁöÑËÆæÁΩÆËøòÈúÄË¶ÅÊ†πÊçÆÂÆûÈôÖÊÉÖÂÜµËøõË°åË∞ÉÊï¥ÔºåÊØîÂ¶ÇÂèØ‰ª•ÂÖàÂ∞ÜÁ∫øÁ®ãÊ±†Â§ßÂ∞èËÆæÁΩÆ‰∏∫ÂèÇËÄÉÂÄºÔºåÂÜçËßÇÂØü‰ªªÂä°ËøêË°åÊÉÖÂÜµÂíåÁ≥ªÁªüË¥üËΩΩ„ÄÅËµÑÊ∫êÂà©Áî®ÁéáÊù•ËøõË°åÈÄÇÂΩìË∞ÉÊï¥„ÄÇ]]></content>
      <tags>
        <tag>JavaÂπ∂Âèë</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MarkdownÂÖ•Èó®ÊåáÂçó]]></title>
    <url>%2F2019%2F05%2F12%2FUntitled%2F</url>
    <content type="text"><![CDATA[ÂèÇËÄÉÔºöhttps://www.jianshu.com/p/q81RER Ê†áÈ¢òËÄåÂú® Markdown ‰∏≠Ôºå‰Ω†Âè™ÈúÄË¶ÅÂú®ÊñáÊú¨ÂâçÈù¢Âä†‰∏ä # Âç≥ÂèØÔºåÂêåÁêÜ„ÄÅ‰Ω†ËøòÂèØ‰ª•Â¢ûÂä†‰∫åÁ∫ßÊ†áÈ¢ò„ÄÅ‰∏âÁ∫ßÊ†áÈ¢ò„ÄÅÂõõÁ∫ßÊ†áÈ¢ò„ÄÅ‰∫îÁ∫ßÊ†áÈ¢òÂíåÂÖ≠Á∫ßÊ†áÈ¢òÔºåÊÄªÂÖ±ÂÖ≠Á∫ßÔºåÂè™ÈúÄË¶ÅÂ¢ûÂä† # Âç≥ÂèØÔºåÊ†áÈ¢òÂ≠óÂè∑Áõ∏Â∫îÈôç‰Ωé„ÄÇ‰æãÂ¶ÇÔºö123456# ‰∏ÄÁ∫ßÊ†áÈ¢ò## ‰∫åÁ∫ßÊ†áÈ¢ò### ‰∏âÁ∫ßÊ†áÈ¢ò#### ÂõõÁ∫ßÊ†áÈ¢ò##### ‰∫îÁ∫ßÊ†áÈ¢ò###### ÂÖ≠Á∫ßÊ†áÈ¢ò Ê≥®Ôºö# Âíå„Äå‰∏ÄÁ∫ßÊ†áÈ¢ò„Äç‰πãÈó¥Âª∫ËÆÆ‰øùÁïô‰∏Ä‰∏™Â≠óÁ¨¶ÁöÑÁ©∫Ê†ºÔºåËøôÊòØÊúÄÊ†áÂáÜÁöÑ Markdown ÂÜôÊ≥ï„ÄÇ ÂàóË°®ÂàóË°®Ê†ºÂºè‰πüÂæàÂ∏∏Áî®ÔºåÂú® Markdown ‰∏≠Ôºå‰Ω†Âè™ÈúÄË¶ÅÂú®ÊñáÂ≠óÂâçÈù¢Âä†‰∏ä - Â∞±ÂèØ‰ª•‰∫ÜÔºå‰æãÂ¶ÇÔºö ‰ª£Á†ÅÔºö 123- ÊñáÊú¨1- ÊñáÊú¨2- ÊñáÊú¨3 ÊïàÊûúÔºö ÊñáÊú¨1 ÊñáÊú¨2 ÊñáÊú¨3 Â¶ÇÊûú‰Ω†Â∏åÊúõÊúâÂ∫èÂàóË°®Ôºå‰πüÂèØ‰ª•Âú®ÊñáÂ≠óÂâçÈù¢Âä†‰∏ä 1. 2. 3. Â∞±ÂèØ‰ª•‰∫ÜÔºå‰æãÂ¶ÇÔºö‰ª£Á†ÅÔºö 1231. ÊñáÊú¨12. ÊñáÊú¨23. ÊñáÊú¨3 ÊïàÊûúÔºö ÊñáÊú¨1 ÊñáÊú¨2 ÊñáÊú¨3 Ê≥®Ôºö-„ÄÅ1.ÂíåÊñáÊú¨‰πãÈó¥Ë¶Å‰øùÁïô‰∏Ä‰∏™Â≠óÁ¨¶ÁöÑÁ©∫Ê†º„ÄÇ ÊèíÂÖ•ÈìæÊé•ÂíåÂõæÁâáÂú® Markdown ‰∏≠ÔºåÊèíÂÖ•ÈìæÊé•‰∏çÈúÄË¶ÅÂÖ∂‰ªñÊåâÈíÆÔºå‰Ω†Âè™ÈúÄË¶Å‰ΩøÁî® ÊòæÁ§∫ÊñáÊú¨ ËøôÊ†∑ÁöÑËØ≠Ê≥ïÂç≥ÂèØÔºå‰æãÂ¶ÇÔºö‰ª£Á†ÅÔºö 1[ÁÆÄ‰π¶](http://www.jianshu.com) ÊïàÊûúÔºö ÁÆÄ‰π¶ Âú® Markdown ‰∏≠ÔºåÊèíÂÖ•ÂõæÁâá‰∏çÈúÄË¶ÅÂÖ∂‰ªñÊåâÈíÆÔºå‰Ω†Âè™ÈúÄË¶Å‰ΩøÁî® ËøôÊ†∑ÁöÑËØ≠Ê≥ïÂç≥ÂèØÔºå‰æãÂ¶ÇÔºö‰ª£Á†ÅÔºö 1![](http://upload-images.jianshu.io/upload_images/259-0ad0d0bfc1c608b6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240) ÊïàÊûúÔºö Ê≥®ÔºöÊèíÂÖ•ÂõæÁâáÁöÑËØ≠Ê≥ïÂíåÈìæÊé•ÁöÑËØ≠Ê≥ïÂæàÂÉèÔºåÂè™ÊòØÂâçÈù¢Â§ö‰∫Ü‰∏Ä‰∏™ ÔºÅ„ÄÇ ÂºïÁî®Âú®Êàë‰ª¨ÂÜô‰ΩúÁöÑÊó∂ÂÄôÁªèÂ∏∏ÈúÄË¶ÅÂºïÁî®‰ªñ‰∫∫ÁöÑÊñáÂ≠óÔºåËøô‰∏™Êó∂ÂÄôÂºïÁî®Ëøô‰∏™Ê†ºÂºèÂ∞±ÂæàÊúâÂøÖË¶Å‰∫ÜÔºåÂú® Markdown ‰∏≠Ôºå‰Ω†Âè™ÈúÄË¶ÅÂú®‰Ω†Â∏åÊúõÂºïÁî®ÁöÑÊñáÂ≠óÂâçÈù¢Âä†‰∏ä &gt; Â∞±Â•Ω‰∫ÜÔºå‰æãÂ¶ÇÔºö ‰ª£Á†ÅÔºö 1&gt; ‰∏ÄÁõèÁÅØÔºå ‰∏ÄÁâáÊòèÈªÑÔºõ ‰∏ÄÁÆÄ‰π¶Ôºå ‰∏ÄÊùØÊ∑°Ëå∂„ÄÇ ÂÆàÁùÄÈÇ£‰∏Ä‰ªΩÊ∑°ÂÆöÔºå ÂìÅËØªÂ±û‰∫éËá™Â∑±ÁöÑÂØÇÂØû„ÄÇ ‰øùÊåÅÊ∑°ÂÆöÔºå ÊâçËÉΩÊ¨£ËµèÂà∞ÊúÄÁæé‰∏ΩÁöÑÈ£éÊôØÔºÅ ‰øùÊåÅÊ∑°ÂÆöÔºå ‰∫∫Áîü‰ªéÊ≠§‰∏çÂÜçÂØÇÂØû„ÄÇ ÊïàÊûúÔºö ‰∏ÄÁõèÁÅØÔºå ‰∏ÄÁâáÊòèÈªÑÔºõ ‰∏ÄÁÆÄ‰π¶Ôºå ‰∏ÄÊùØÊ∑°Ëå∂„ÄÇ ÂÆàÁùÄÈÇ£‰∏Ä‰ªΩÊ∑°ÂÆöÔºå ÂìÅËØªÂ±û‰∫éËá™Â∑±ÁöÑÂØÇÂØû„ÄÇ ‰øùÊåÅÊ∑°ÂÆöÔºå ÊâçËÉΩÊ¨£ËµèÂà∞ÊúÄÁæé‰∏ΩÁöÑÈ£éÊôØÔºÅ ‰øùÊåÅÊ∑°ÂÆöÔºå ‰∫∫Áîü‰ªéÊ≠§‰∏çÂÜçÂØÇÂØû„ÄÇ Ê≥®Ôºö&gt; ÂíåÊñáÊú¨‰πãÈó¥Ë¶Å‰øùÁïô‰∏Ä‰∏™Â≠óÁ¨¶ÁöÑÁ©∫Ê†º„ÄÇ Á≤ó‰ΩìÂíåÊñú‰ΩìMarkdown ÁöÑÁ≤ó‰ΩìÂíåÊñú‰Ωì‰πüÈùûÂ∏∏ÁÆÄÂçïÔºåÁî®‰∏§‰∏™ ÂåÖÂê´‰∏ÄÊÆµÊñáÊú¨Â∞±ÊòØÁ≤ó‰ΩìÁöÑËØ≠Ê≥ïÔºåÁî®‰∏Ä‰∏™ ÂåÖÂê´‰∏ÄÊÆµÊñáÊú¨Â∞±ÊòØÊñú‰ΩìÁöÑËØ≠Ê≥ï„ÄÇ‰æãÂ¶ÇÔºö ‰ª£Á†ÅÔºö 1*‰∏ÄÁõèÁÅØ*Ôºå ‰∏ÄÁâáÊòèÈªÑÔºõ**‰∏ÄÁÆÄ‰π¶**Ôºå ‰∏ÄÊùØÊ∑°Ëå∂„ÄÇ ÂÆàÁùÄÈÇ£‰∏Ä‰ªΩÊ∑°ÂÆöÔºå ÂìÅËØªÂ±û‰∫éËá™Â∑±ÁöÑÂØÇÂØû„ÄÇ ‰øùÊåÅÊ∑°ÂÆöÔºå ÊâçËÉΩÊ¨£ËµèÂà∞ÊúÄÁæé‰∏ΩÁöÑÈ£éÊôØÔºÅ ‰øùÊåÅÊ∑°ÂÆöÔºå ‰∫∫Áîü‰ªéÊ≠§‰∏çÂÜçÂØÇÂØû„ÄÇ ÊïàÊûúÔºö ‰∏ÄÁõèÁÅØÔºå ‰∏ÄÁâáÊòèÈªÑÔºõ‰∏ÄÁÆÄ‰π¶Ôºå ‰∏ÄÊùØÊ∑°Ëå∂„ÄÇ ÂÆàÁùÄÈÇ£‰∏Ä‰ªΩÊ∑°ÂÆöÔºå ÂìÅËØªÂ±û‰∫éËá™Â∑±ÁöÑÂØÇÂØû„ÄÇ ‰øùÊåÅÊ∑°ÂÆöÔºå ÊâçËÉΩÊ¨£ËµèÂà∞ÊúÄÁæé‰∏ΩÁöÑÈ£éÊôØÔºÅ ‰øùÊåÅÊ∑°ÂÆöÔºå ‰∫∫Áîü‰ªéÊ≠§‰∏çÂÜçÂØÇÂØû„ÄÇ ÊúÄÁªàÊòæÁ§∫ÁöÑÂ∞±ÊòØ‰∏ãÊñáÔºåÂÖ∂‰∏≠„Äå‰∏ÄÁõèÁÅØ„ÄçÊòØÊñú‰ΩìÔºå„Äå‰∏ÄÁÆÄ‰π¶„ÄçÊòØÁ≤ó‰ΩìÔºö ‰ª£Á†ÅÂºïÁî®12ÈúÄË¶ÅÂºïÁî®‰ª£Á†ÅÊó∂ÔºåÂ¶ÇÊûúÂºïÁî®ÁöÑËØ≠Âè•Âè™Êúâ‰∏ÄÊÆµÔºå‰∏çÂàÜË°åÔºåÂèØ‰ª•Áî® ` Â∞ÜËØ≠Âè•ÂåÖËµ∑Êù•„ÄÇÂ¶ÇÊûúÂºïÁî®ÁöÑËØ≠Âè•‰∏∫Â§öË°åÔºåÂèØ‰ª•Â∞Ü```ÁΩÆ‰∫éËøôÊÆµ‰ª£Á†ÅÁöÑÈ¶ñË°åÂíåÊú´Ë°å„ÄÇ Ë°®Ê†ºÁõ∏ÂÖ≥‰ª£Á†ÅÔºö 12345| Tables | Are | Cool || ------------- |:-------------:| -----:|| col 3 is | right-aligned | $1600 || col 2 is | centered | $12 || zebra stripes | are neat | $1 | ÊòæÁ§∫ÊïàÊûúÔºö| Tables | Are | Cool || ‚Äî‚Äî‚Äî‚Äî- |:‚Äî‚Äî‚Äî‚Äî-:| ‚Äî‚Äì:|| col 3 is | right-aligned | $1600 || col 2 is | centered | $12 || zebra stripes | are neat | $1 | ÊòæÁ§∫ÈìæÊé•‰∏≠Â∏¶Êã¨Âè∑ÁöÑÂõæÁâá‰ª£Á†ÅÂ¶Ç‰∏ã:12![][1][1]: http://latex.codecogs.com/gif.latex?\prod%20\(n_&#123;i&#125;\)+1 ÊïàÊûúÂ¶Ç‰∏ãÔºö![][1][1]: http://latex.codecogs.com/gif.latex?\prod%20\(n_{i}\)+1]]></content>
      <categories>
        <category>Â∑•ÂÖ∑</category>
      </categories>
      <tags>
        <tag>makedown</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HexoÂÖ•Èó®Âà∞ËøõÈò∂]]></title>
    <url>%2F2019%2F05%2F12%2FHexo%20%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[‰ªÄ‰πàÊòØ HexoÔºüHexo ÊòØ‰∏Ä‰∏™Âø´ÈÄü„ÄÅÁÆÄÊ¥Å‰∏îÈ´òÊïàÁöÑÂçöÂÆ¢Ê°ÜÊû∂„ÄÇHexo ‰ΩøÁî® MarkdownÔºàÊàñÂÖ∂‰ªñÊ∏≤ÊüìÂºïÊìéÔºâËß£ÊûêÊñáÁ´†ÔºåÂú®Âá†ÁßíÂÜÖÔºåÂç≥ÂèØÂà©Áî®Èùì‰∏ΩÁöÑ‰∏ªÈ¢òÁîüÊàêÈùôÊÄÅÁΩëÈ°µ„ÄÇ ÂÆòÊñπÊñáÊ°£(ËøôÈáå‰∏ªË¶ÅËÆ∞ÂΩïÊú¨‰∫∫Âú®‰ΩøÁî®HexoËøáÁ®ã‰∏≠ÈÅáÂà∞ÁöÑÈóÆÈ¢òÂíåËß£ÂÜ≥ÊñπÊ°à) Âü∫Êú¨‰ΩøÁî®init1$ hexo init [folder] Êñ∞Âª∫‰∏Ä‰∏™ÁΩëÁ´ô„ÄÇÂ¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆ folder ÔºåHexo ÈªòËÆ§Âú®ÁõÆÂâçÁöÑÊñá‰ª∂Â§πÂª∫Á´ãÁΩëÁ´ô„ÄÇ new1$ hexo new [layout] &lt;title&gt; Êñ∞Âª∫‰∏ÄÁØáÊñáÁ´†„ÄÇÂ¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆ layout ÁöÑËØùÔºåÈªòËÆ§‰ΩøÁî® _config.yml ‰∏≠ÁöÑ default_layout ÂèÇÊï∞‰ª£Êõø„ÄÇÂ¶ÇÊûúÊ†áÈ¢òÂåÖÂê´Á©∫Ê†ºÁöÑËØùÔºåËØ∑‰ΩøÁî®ÂºïÂè∑Êã¨Ëµ∑Êù•„ÄÇ 1$ hexo new "post title with whitespace" generate1$ hexo generate ÁîüÊàêÈùôÊÄÅÊñá‰ª∂„ÄÇ ÈÄâÈ°π ÊèèËø∞ -d, --deploy Êñá‰ª∂ÁîüÊàêÂêéÁ´ãÂç≥ÈÉ®ÁΩ≤ÁΩëÁ´ô -w, --watch ÁõëËßÜÊñá‰ª∂ÂèòÂä® ËØ•ÂëΩ‰ª§ÂèØ‰ª•ÁÆÄÂÜô‰∏∫1$ hexo g publish1$ hexo publish [layout] &lt;filename&gt; ÂèëË°®ËçâÁ®ø„ÄÇ server1$ hexo server ÂêØÂä®ÊúçÂä°Âô®„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËÆøÈóÆÁΩëÂùÄ‰∏∫Ôºö http://localhost:4000/„ÄÇ ÈÄâÈ°π ÊèèËø∞ -p, --port ÈáçËÆæÁ´ØÂè£ -s, --static Âè™‰ΩøÁî®ÈùôÊÄÅÊñá‰ª∂ -l, --log ÂêØÂä®Êó•ËÆ∞ËÆ∞ÂΩïÔºå‰ΩøÁî®Ë¶ÜÁõñËÆ∞ÂΩïÊ†ºÂºè ËØ•ÂëΩ‰ª§ÂèØ‰ª•ÁÆÄÂÜô‰∏∫1234567$ hexo s`## deploy``` bash$ hexo deploy ÈÉ®ÁΩ≤ÁΩëÁ´ô„ÄÇ ÂèÇÊï∞ ÊèèËø∞ -g, --generate ÈÉ®ÁΩ≤‰πãÂâçÈ¢ÑÂÖàÁîüÊàêÈùôÊÄÅÊñá‰ª∂ ËØ•ÂëΩ‰ª§ÂèØ‰ª•ÁÆÄÂÜô‰∏∫Ôºö1$ hexo d render1$ hexo render &lt;file1&gt; [file2] ... Ê∏≤ÊüìÊñá‰ª∂„ÄÇ ÂèÇÊï∞ ÊèèËø∞ -o, --output ËÆæÁΩÆËæìÂá∫Ë∑ØÂæÑ migrate1$ hexo migrate &lt;type&gt; ‰ªéÂÖ∂‰ªñÂçöÂÆ¢Á≥ªÁªü ËøÅÁßªÂÜÖÂÆπ„ÄÇ clean1$ hexo clean Ê∏ÖÈô§ÁºìÂ≠òÊñá‰ª∂ (db.json) ÂíåÂ∑≤ÁîüÊàêÁöÑÈùôÊÄÅÊñá‰ª∂ (public)„ÄÇ Âú®Êüê‰∫õÊÉÖÂÜµÔºàÂ∞§ÂÖ∂ÊòØÊõ¥Êç¢‰∏ªÈ¢òÂêéÔºâÔºåÂ¶ÇÊûúÂèëÁé∞ÊÇ®ÂØπÁ´ôÁÇπÁöÑÊõ¥ÊîπÊó†ËÆ∫Â¶Ç‰Ωï‰πü‰∏çÁîüÊïàÔºåÊÇ®ÂèØËÉΩÈúÄË¶ÅËøêË°åËØ•ÂëΩ‰ª§„ÄÇ list1$ hexo list &lt;type&gt; ÂàóÂá∫ÁΩëÁ´ôËµÑÊñô„ÄÇ version1$ hexo version Êèí‰ª∂Hexo-adminÊèí‰ª∂‰ªãÁªçhexo-admin ÊòØ‰∏Ä‰∏™HexoÂçöÂÆ¢ÂºïÊìéÁöÑÁÆ°ÁêÜÁî®Êà∑ÁïåÈù¢Êèí‰ª∂„ÄÇËøô‰∏™Êèí‰ª∂ÊúÄÂàùÊòØ‰Ωú‰∏∫Êú¨Âú∞ÁºñËæëÂô®ËÆæËÆ°ÁöÑÔºåÂú®Êú¨Âú∞ËøêË°åhexo‰ΩøÁî®hexo-adminÁºñÂÜôÊñáÁ´†ÔºåÁÑ∂ÂêéÈÄöËøáhexo gÊàñhexo dÔºàhexo gÊòØÊú¨Âú∞Ê∏≤ÊüìÔºåhexo dÊòØÂ∞ÜÊ∏≤ÊüìÁöÑÈùôÊÄÅÈ°µÈù¢ÂèëÂ∏ÉÂà∞GitHubÔºâÂ∞ÜÁîüÊàêÁöÑÈùôÊÄÅÈ°µÈù¢ÂèëÂ∏ÉÂà∞GitHubÁ≠âÈùôÊÄÅÊúçÂä°Âô®„ÄÇÂ¶ÇÊûú‰Ω†‰ΩøÁî®ÁöÑÊòØÈùûÈùôÊÄÅÊâòÁÆ°ÊúçÂä°Âô®ÔºåÊØîÂ¶ÇËá™Â∑±‰π∞ÁöÑ‰∏ªÊú∫Êê≠Âª∫ÁöÑhexoÔºåÈÇ£‰πà‰∏ÄÂÆöË¶ÅËÆæÁΩÆhexo-admin ÁöÑÂØÜÁ†ÅÔºåÂê¶ÂàôË∞ÅÈÉΩÂèØ‰ª•ÁºñËæë‰Ω†ÁöÑÊñáÁ´†„ÄÇ Êèí‰ª∂ÂÆâË£ÖÈ¶ñÂÖàËøõÂÖ•hexoÂàõÂª∫ÁöÑÂçöÂÆ¢È°πÁõÆÁöÑÊ†πÁõÆÂΩï‰∏ãÔºåÊâßË°å1234567 npm install --save hexo-admin``` macÂèØËÉΩÈúÄË¶ÅrootÊùÉÈôêÔºåÂâçÈù¢Âä†‰∏™sudo Â∞±ÂèØ‰ª•‰∫Ü„ÄÇÂ¶ÇÊûúÊä•ÈîôÁº∫Â∞ëÁªÑ‰ª∂ÔºåÂàôÁº∫Â∞ë‰ªÄ‰πàÂÆâË£Ö‰ªÄ‰πàÔºånpm install Âä†Áº∫Â∞ëÁöÑÁªÑ‰ª∂„ÄÇËøêË°å‰∏ãÂàóÂëΩ‰ª§ÂêØÂä®hexo-admin Ôºö``` bash hexo server -d ÊâìÂºÄ http://localhost:4000/admin/ Â∞±ÂèØ‰ª•ËÆøÈóÆÂà∞hexo-adminÁÆ°ÁêÜÈ°µÈù¢‰∫Ü„ÄÇ ÂØÜÁ†Å‰øùÊä§ÊâìÂºÄsettingÔºåÁÇπÂáªSetup authentification hereËæìÂÖ•Áî®Êà∑ÂêçÔºåÂØÜÁ†ÅÔºåÂØÜÈí•Ôºå‰∏ãÈù¢‰ºöËá™Âä®ÁîüÊàêÈÖçÁΩÆÊñá‰ª∂ÔºåÂ§çÂà∂Âä†Âú®hexoÊ†πÁõÆÂΩï‰∏ãÁöÑ_config.yml‰∏≠Ôºö1234admin: username: username password_hash: be121740bf988b2225a313fa1f107ca1 secret: secret ÈáçÂêØhexoÔºåÂ∞±ÂèØ‰ª•ÁúãÂà∞ÁôªÂΩïÈ°µÈù¢‰∫Ü ÂèëÂ∏ÉÊñáÁ´†ËøõÂÖ•ÂêéÂè∞‰πãÂêéÁÇπÂáªDeployÔºåÈáåÈù¢ÁöÑDeployÊåâÈíÆÊòØÁî®Êù•ÊâßË°åÂèëÂ∏ÉËÑöÊú¨ÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ÂÖàÂú®ÂçöÂÆ¢Ê†πÁõÆÂΩï‰∏ãÊñ∞Âª∫‰∏™ÁõÆÂΩïadmin_scriptÔºåÁÑ∂ÂêéÂú®ÁõÆÂΩï‰∏≠Êñ∞Âª∫‰∏Ä‰∏™ËÑöÊú¨hexo-g.shÔºåÈáåÈù¢ÂÜô‰∏ã‰∏ãÈù¢‰ª£Á†ÅÁÑ∂Âêé‰øùÂ≠òÔºå hexo g &amp;&amp; hexo d ÁÑ∂ÂêéÂú®_config.yml‰∏≠ÁöÑadmin‰∏ãÊ∑ªÂä† admin: username: username password_hash: be121740bf988b2225a313fa1f107ca1 secret: secret deployCommand: ./admin_script/hexo-g.sh ËÆæÁΩÆÂèëÂ∏ÉÊâßË°åÁöÑËÑöÊú¨ÔºåÁÇπÂáªDeployÂ∞±‰ºöÊâßË°åËøô‰∏™ÂëΩ‰ª§Âπ∂Êèê‰∫§Âà∞GitHub‰∏ä„ÄÇ]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
</search>
